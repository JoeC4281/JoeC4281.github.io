<!DOCTYPE html>
<!--saved from url=(0024)http://www.bauerapps.com--><html id=htmlTag xmlns="http://www.w3.org/1999/xhtml" xml:lang=en lang=en dir=ltr>
<head>
	
	
	<base/>
	
		<link rel="Shortcut Icon" href="resources/favicon_2021.ico" type="image/x-icon"/>
	

	
	
	
		
		
	

	

	
	<link rel=stylesheet type="text/css" href="resources/css1.css"/>
<link rel=stylesheet type="text/css" href="resources/css6.css"/>



	
	
		<meta property=og:site_name content="PowerBASIC Peer Support Community"/>
		<meta property=og:description content="Source code related to Jose's work.  Posts and uploads may be made by any forum member."/>
		<meta property=og:url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
		
		<meta property=og:type content=website />
	
	

	
	
	

	
	<meta name=viewport content="width=device-width, initial-scale=1, viewport-fit=cover"/>

	
	
	
		
		
		
			
			
		
	

	
	
	
		

	<title>Assorted COM examples - PowerBASIC Peer Support Community</title>

	<meta name=description content="Source code related to Jose's work.  Posts and uploads may be made by any forum member."/>
	<meta name=generator content="vBulletin 5.6.6"/>

	
	

	<link rel=stylesheet type="text/css" href="resources/css3.css"/>
<link rel=stylesheet type="text/css" href="resources/css5.css"/>
<link rel=stylesheet type="text/css" href="resources/css2.css"/>
<link rel=stylesheet type="text/css" href="resources/css4.css"/>
<link class=js-additional-css rel=stylesheet type="text/css" href="resources/css.css"/>


	
	



<meta http-equiv=Content-Type content="text/html; charset=utf-8">
</head>

	







	

<body id=vb-page-body class="l-desktop page129 vb-page view-mode logged-out" itemscope itemtype="http://schema.org/ItemPage" data-usergroupid=1 data-styleid=53>





	


<div class="b-top-menu__background b-top-menu__background--sitebuilder js-top-menu-sitebuilder h-hide-on-small h-hide">
	<div class=b-top-menu__container>
		<ul class="b-top-menu b-top-menu--sitebuilder js-top-menu-sitebuilder--list js-shrink-event-parent">
			
		</ul>
	</div>
</div>

<nav class="b-top-menu__background js-top-menu-user">
	<div class=b-top-menu__container>
		<ul class="b-top-menu b-top-menu--user js-top-menu-user--list js-shrink-event-parent">
			




	



	<li class="b-top-menu__item b-top-menu__item--no-left-divider b-top-menu__item--no-right-divider username-container js-shrink-event-child">

		<div class="b-comp-menu-dropdown b-comp-menu-dropdown--headerbar js-comp-menu-dropdown b-comp-menu-dropdown--open-on-hover js-login-menu">
			<div id=lnkLoginSignupMenu class="b-comp-menu-dropdown__trigger js-comp-menu-dropdown__trigger b-comp-menu-dropdown__trigger--arrow b-comp-menu-dropdown__trigger--headerbar js-button" tabindex=0>
				Login or Sign Up
			</div>

			<ul class="b-comp-menu-dropdown__content js-comp-menu-dropdown__content b-comp-menu-dropdown__content--right">

				<li class="b-comp-menu-dropdown__content-item js-comp-menu-dropdown__content-maintain-menu b-comp-menu-dropdown__content-item--no-hover">
					

<div class="js-login-form-main-container login-form-main-container">

<div class="js-error-box error h-margin-bottom-l h-hide"></div>

<div class="js-login-message-box login-message-box h-hide">
	<div class=h-center-container><div class=h-center>Logging in...</div></div>
</div>

<form action method=post class="h-clearfix js-login-form-main ">
	<div class="login-fieldset table">
		<div class=tr>
			
				
					
				
			
			<span class=td>
				<input type=text name=username value class="js-login-username b-form-input__input b-form-input__input--full" placeholder="User/Email"/>
			</span>
		</div>
		<div class=tr>
			<span class=td>
				<input type=password autocomplete=off name=password class="js-login-password b-form-input__input b-form-input__input--full" placeholder=Password />
			</span>
		</div>
	</div>

	
	
		<div class="h-warning h-text-size--11">By logging into your account, you agree to our <a href="https://www.powerbasic.com/privacy-notice" target=_blank>Privacy Policy</a>, personal data processing and storage practices as described therein.</div>
		<input type=hidden name=privacyconsent value=1 />
	

	<div class="secondary-controls h-left h-clear-left h-margin-top-s">
		<label><input type=checkbox name=rememberme />Remember me</label>
	</div>

	<div class="primary-controls h-right h-clear-right h-margin-top-s">
		<button type=button class="js-login-button b-button b-button--primary">Log in</button>
	</div>

	<div class="secondary-controls h-left h-clear-left">
		<a href="https://forum.powerbasic.com/lostpw" class="b-link lost-password-link">Forgot password or user name?</a>
	</div>

	<div class="primary-controls h-right h-clear-right">
		
			
			
			
		
		or <a id=idLoginSignup href="https://forum.powerbasic.com/register?urlpath=aHR0cHM6Ly9mb3J1bS5wb3dlcmJhc2ljLmNvbS9mb3J1bS9qb3NlLXMtY29ybmVyL3NvdXJjZS1jb2RlLWFiLzUxMzIxLWFzc29ydGVkLWNvbS1leGFtcGxlcw%3D%3D" target=_top>Sign Up</a>
	</div>

</form>
</div>
				</li>

				
				

				<li id=externalLoginProviders class="b-comp-menu-dropdown__content-item js-comp-menu-dropdown__content-maintain-menu b-comp-menu-dropdown__content-item--no-hover js-external-login-providers h-clearfix h-hide-imp">
					<span class="h-left h-margin-left-s h-margin-top-s">Log in with</span>
					
					
					
			

			

				</li>

			</ul>

		</div>

	</li>

	

		</ul>
	</div>
</nav>

<div id=sitebuilder-wrapper class="noselect h-clearfix h-hide-on-small">
	
</div>

<div class=main-navbar-bottom-line></div>

<div id=outer-wrapper>
<div id=wrapper>

	
	<div id=header-axd class="header-edit-box axdnum_1 h-clearfix">
		
		<div class="axd-container axd-container_header">
			<div class=admin-only>
				
			</div>
			<div class="axd axd_header">
				
			</div>
		</div>
		<div class="axd-container axd-container_header2">
			<div class=admin-only>
				
			</div>
			<div class="axd axd_header2">
				
			</div>
		</div>
	</div>
	
	
	
	<header class=b-top-background__header-mainnav-subnav>

		
		<div class=b-top-background__header-mainnav>

			
			<div id=header class=noselect>
				<div class=header-cell>
					
					<div class="site-logo header-edit-box">
						<a href="https://forum.powerbasic.com/"><img src="resources/forum.hdr.pb2016.jose.912x96.png" data-orig-src="https://forum.powerbasic.com/core/css/0/0/3/1/8/7/images/forum.hdr.pb2016.jose.912x96.png" alt=Logo title="Powered by vBulletin"/></a>
					</div>
				</div>
				<div class=toolbar>
					<ul class=h-right>
						
						
						
						<li class=search-container>
							<form id=searchForm action="https://forum.powerbasic.com/search" class=h-left method=GET>
								<div class=h-left>

									
									<div class="search-box h-clearfix">

										<div class=search-term-container>

											<input type=text name=q id=q placeholder=Search class="search-term b-form-input__input b-form-input__input--shadow" autocomplete=off />

											<div class="search-menu-container h-clearfix">
												<div class=vertical-divider-left></div>
												<div class="b-comp-menu-dropdown js-comp-menu-dropdown b-comp-menu-dropdown--open-on-hover b-comp-menu-dropdown--header-search">
													<div class="b-comp-menu-dropdown__trigger js-comp-menu-dropdown__trigger b-comp-menu-dropdown__trigger--arrow js-button" tabindex=0></div>
													<ul class="b-comp-menu-dropdown__content js-comp-menu-dropdown__content">

	<li class="b-comp-menu-dropdown__content-item b-comp-menu-dropdown__content-item--first b-comp-menu-dropdown__content-item--no-hover js-comp-menu-dropdown__content-maintain-menu">

		<div class=searchPopupBody>

			<label><input type=checkbox name="searchFields[title_only]" class=searchFields_title_only value=1 />Search in titles only</label>

			

			
				
				
					<label><input type=checkbox name="searchFields[channel][]" class=searchFields_channel value=56 />Search in Jos√©'s Corner - Source Code only</label>
				
			

			<div class="b-button-group h-margin-top-xs">
				<button type=submit id=btnSearch-popup class="b-button b-button--primary">Search</button>
			</div>

		</div>

		<input type=hidden name=searchJSON value />
	</li>

	<li class="b-comp-menu-dropdown__content-item js-comp-menu-dropdown__content-maintain-menu">
		<a href="https://forum.powerbasic.com/#" id=btnAdvSearch class=adv-search-btn>Advanced Search</a>
	</li>

</ul>
												</div>
											</div>

										</div>

										<button type=submit id=btnSearch class=search-btn title=Search><span class="b-icon b-icon__search"></span></button>

									</div>

								</div>
							</form>
						</li>
						
					</ul>
				</div>
				
			</div>

			
			<nav id=channel-tabbar class="h-clearfix noselect">
				<ul class="channel-tabbar-list h-left b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-comp-menu-dropdown--inactive js-comp-menu-dropdown__content--main-menu h-hide-on-small js-shrink-event-parent">

					
						
					

					
					
					
						
						
						
						<li class="current section-item js-shrink-event-child">
							<a href class="h-left navbar_home">Community</a>
							
								<span class=channel-tabbar-divider></span>
							
							<span class="mobile dropdown-icon"><span class="icon h-right"></span></span>
						</li>
					
						
						
						
						<li class=" section-item js-shrink-event-child">
							<a href="https://forum.powerbasic.com/PowerBASICLinks" class="h-left navbar_powerbasic_home_page">PowerBASIC Links</a>
							
								<span class=channel-tabbar-divider></span>
							
							<span class="mobile dropdown-icon"><span class="icon h-right"></span></span>
						</li>
					
						
						
						
						<li class=" section-item js-shrink-event-child">
							<a href="https://forum.powerbasic.com/RulesAndGuidelines" class="h-left navbar_forum_rules_ampamp_guidelines">Forum Rules & Guidelines</a>
							
							<span class="mobile dropdown-icon"><span class="icon h-right"></span></span>
						</li>
					
					
				</ul>
			</nav>


		</div>


		
		<nav id=channel-subtabbar class="h-clearfix  h-hide-on-small h-block js-channel-subtabbar">
			<ul class="h-left channel-subtabbar-list js-channel-subtabbar-list js-shrink-event-parent">
				
					
					
					<li class=" js-shrink-event-child">
						<a href="https://forum.powerbasic.com/search?searchJSON={%22view%22:%22topic%22,%22unread_only%22:1,%22sort%22:{%22lastcontent%22:%22desc%22},%22exclude%22:%2245%22,%22exclude_type%22:[%22vBForum_PrivateMessage%22],%22date%22:%22lastVisit%22}" class=navbar__>NEW POSTS</a>
					</li>
				
					
					
					<li class=" js-shrink-event-child">
						<a href="http://forum.powerbasic.com/search?searchJSON={%22date%22:{%22from%22:%222%22},%22sort%22:{%22created%22:%22desc%22},%22view%22:%22%22,%22exclude%22:%2245%22,%22exclude_type%22:[%22vBForum_PrivateMessage%22]}" class=navbar_.>Activity Stream</a>
					</li>
				
					
					
					<li class=" js-shrink-event-child">
						<a href="https://forum.powerbasic.com/search?searchJSON={%22view%22:%22topic%22,%22unread_only%22:1,%22sort%22:{%22lastcontent%22:%22desc%22},%22exclude%22:%2245%22,%22exclude_type%22:[%22vBForum_PrivateMessage%22]}" class=navbar_todays_posts>Today's Posts</a>
					</li>
				
					
					
					<li class=" js-shrink-event-child">
						<a href='https://forum.powerbasic.com/search?searchJSON={"view":"topic","unread_only":1,"sort":{"lastcontent":"desc"},"exclude":"45","exclude_type":["vBForum_PrivateMessage"],"date":"lastVisit"}' class=navbar_newtopics>New Topics</a>
					</li>
				
					
					
					<li class=" js-shrink-event-child">
						<a href="https://forum.powerbasic.com/search" class=navbar_advanced_search>ADVANCED SEARCH</a>
					</li>
				
			</ul>
		</nav>


	</header>


	
		
	

	
	
		
		<nav class=breadcrumbs-wrapper>
		<ul id=breadcrumbs class=h-clearfix itemprop=breadcrumb>
			<li class=crumb>
				<a class="crumb-link h-flex-valign-center" href>
					<span class="b-icon b-icon__home" title="Community Home"></span>
				</a>
			</li>
			
				
					
					
				
				<li class=crumb>
					<span class="b-icon b-icon__chevron-right--gray separator"></span>
					
						<a class=crumb-link href="https://forum.powerbasic.com/forum">Community</a>
					
				</li>
			
				
					
					
				
				<li class=crumb>
					<span class="b-icon b-icon__chevron-right--gray separator"></span>
					
						<a class=crumb-link href="https://forum.powerbasic.com/forum/third-party-forums">Friends of PowerBASIC</a>
					
				</li>
			
				
					
					
				
				<li class=crumb>
					<span class="b-icon b-icon__chevron-right--gray separator"></span>
					
						<a class=crumb-link href="https://forum.powerbasic.com/forum/jose-s-corner">Jos√©'s Corner</a>
					
				</li>
			
				
					
					
				
				<li class=crumb>
					<span class="b-icon b-icon__chevron-right--gray separator"></span>
					
						<a class=crumb-link href="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab">Jos√©'s Corner - Source Code</a>
					
				</li>
			
		</ul>
		</nav>
	

	

	
	
		
			
			
				
				
				
			
		
			
			
				
				
				
			
		
	

	

	

<ul id=notices class=notices>
	
	
		
		<li class="notice restore" data-notice-id=5 data-notice-persistent=1><b>You are not logged in.</b>  You can browse in the PowerBASIC Community, but you must click Login <i>(top right)</i> before you can post.  If this is your first visit, check out the <a href="https://forum.powerbasic.com/help" target=_blank><b>FAQ</b></a> or <a href="https://forum.powerbasic.com/register" target=_blank><b>Sign Up</b></a>.</li>
	
</ul>


	


	
	<main id=content>
		<div class="canvas-layout-container js-canvas-layout-container">

<div id=canvas-layout-full class=canvas-layout data-layout-id=1>

	

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	







<!-- section 200 -->



<div class="canvas-widget-list section-200 js-sectiontype-global_after_breadcrumb h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	

	

</div>

	

</div>

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	







<!-- section 2 -->



<div class="canvas-widget-list section-2 js-sectiontype-notice h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	
	<!-- *** START WIDGET widgetid:28, widgetinstanceid:18, template:widget_announcement *** -->
	
	


	
	





<div class="b-module canvas-widget default-widget announcement-widget empty" id=widget_18 data-widget-id=28 data-widget-instance-id=18>
	
	<div class="widget-header h-clearfix">
		
		
			
		

		<div class="module-title h-left">
			
				<h1 class="main-title js-main-title hide-on-editmode">Announcement</h1>
				
				
				
			
		</div>
		
			<div class=module-buttons>
				
					<span class="toggle-button module-button-item collapse" title=Collapse data-toggle-title=Expand><span class="b-icon b-icon__toggle-collapse">Collapse</span></span>
				
			</div>
		
	</div>
	

	<div class=widget-content>
		
			
				No announcement yet.
				
			
				
	</div>
</div>
	<!-- *** END WIDGET widgetid:28, widgetinstanceid:18, template:widget_announcement *** -->

	<!-- *** START WIDGET widgetid:51, widgetinstanceid:19, template:widget_pagetitle *** -->
	
	


	
	





	
	
	
		
		
	







	




	



<div class="b-module canvas-widget default-widget page-title-widget widget-no-header-buttons widget-no-border" id=widget_19 data-widget-id=51 data-widget-instance-id=19>
	
	<div class="widget-header h-clearfix">
		
		

		<div class="module-title h-left">
			
				<h1 class="main-title js-main-title hide-on-editmode">Assorted COM examples</h1>
				
				
				
			
		</div>
		
			<div class=module-buttons>
				
					<span class="toggle-button module-button-item collapse" title=Collapse data-toggle-title=Expand><span class="b-icon b-icon__toggle-collapse">Collapse</span></span>
				
			</div>
		
	</div>
	


	
	

</div>
	<!-- *** END WIDGET widgetid:51, widgetinstanceid:19, template:widget_pagetitle *** -->


	

</div>

	

</div>

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	

	
	







<!-- section 0 -->



<div class="canvas-widget-list section-0 js-sectiontype-primary js-sectiontype-secondary h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	
	<!-- *** START WIDGET widgetid:6, widgetinstanceid:20, template:widget_conversationdisplay *** -->
	



	
		
	
	
		
			
		
	

	
	
	
	
		
		
		
		
		

		
			
			
			

			
			
			
			
				
			
			
			

			
				
			
			

			

			

			
				
					
				
				
				
				
				
				
			

			

			

			

			
			
			

			
			

			
				
			

			
				
				
				
			

			
			

			
				
			


			
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			

			
			
			

			
				
				
					
				

				
			

			
			
			
			
			
			

		
	

	
	
	
		
		
		 
	

	
	
	
		
		
	

	<div class="b-module canvas-widget default-widget conversation-content-widget  forum-conversation-content-widget widget-tabs widget-no-border widget-no-header-buttons  axd-container" id=widget_20 data-widget-id=6 data-widget-instance-id=20 data-widget-default-tab="#thread-view-tab">
		
			<div class=conversation-status-messages>
				
				
				
				
				<div class="conversation-status-message notice h-hide"><span></span><div class=close>X</div></div>
			</div>

			<div class="widget-header h-clearfix">
				<div class="module-title h-left main-header-title">
					
				</div>
				<div class=module-buttons>
					<span class="toggle-button module-button-item collapse" title=Collapse data-toggle-title=Expand><span class="b-icon b-icon__toggle-collapse">Collapse</span></span>
				</div>
				
				
				<div class="conversation-controls h-right h-clear hide-on-editmode b-button-group h-margin-bottom-l js-movable-toolbar-button-container">
					
				</div>
				
					<div class="widget-tabs-nav h-clear">
						<a id=topic-module-top class="anchor js-module-top-anchor"></a>
						
						<ul class="ui-tabs-nav hide-on-editmode h-left b-comp-menu-horizontal js-module-tab-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive">
							
							
							<li><a href="https://forum.powerbasic.com/#thread-view-tab" data-href="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?view=thread">Posts</a></li>
							
							<li><a href="https://forum.powerbasic.com/#stream-view-tab" data-href="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?view=stream">Latest Activity</a></li>
							
							<li><a href="https://forum.powerbasic.com/#media-view-tab" data-href="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?view=media">Photos</a></li>
						</ul>
					</div>
				
			</div>
			<div class="widget-content tab widget-tabs-panel">
				<input type=hidden name=canmoderate id=canmoderate value=0 />
				
					
					
					
					
				
				<div id=thread-view-tab class="conversation-view conversation-thread-view">
					
						
					
					
						
							
						
					

					


	
		
	



	











<div class="conversation-toolbar-wrapper  top h-clear hide-on-editmode
	
		scrolltofixed-floating
		scrolltofixed-top
	
" data-allow-history=1>
	<div class=conversation-toolbar>


		

		
			
			<div class=toolset-left>

				
				<div class="conversation-toolbar-height-shim js-shrink-event-child">
					<div class=b-button>¬†</div>
				</div>

			</div>
		
		

		

		<ul class="toolset-right js-shrink-event-parent">

			
				<li class="toolbar-search h-hide-on-small js-shrink-event-child">
					<form name=toolbar-search-form action="activity/get" method=post class=toolbar-search-form>
						<input type=hidden name=nodeid value=51321 />
						<input type=hidden name=view value=thread />
						
							<input type=hidden name=per-page value=20 />
							<input type=hidden name=pagenum value=1 />
						

						<div class="js-toolbar-search-inner b-form-input__input-with-button-container b-form-input__input-with-button-container--full">

							<input type=text name=q value class="b-form-input__input b-form-input__input--with-button b-form-input__input--shadow js-filter-search" placeholder=Search data-filter-name=Search />

							<button type=submit name=btnSearch id=btnSearch-top class=b-form-input__inside-button><span class="b-form-input__inside-button-icon b-icon b-icon__search-gray-s">Search</span></button>

						</div>

					</form>
				</li>
				<li class="h-hide-on-small js-shrink-event-child">
					<div class=toolbar-divider>
						<span class=toolbar-divider-inner></span>
					</div>
				</li>
			

			
			
				
			

			
			
				<li class="toolbar-pagenav js-toolbar-pagenav h-hide-on-xsmall js-shrink-event-child">
					<div class=toolbar-pagenav-wrapper>
						<!-- Page Nav controls -->











<div class="pagenav-controls ">
	<form class="pagenav-form h-clearfix" action="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples">
		<input type=hidden class=defaultpage value=1 />
		
		<div class="pagenav h-left">
			Page <input type=text name=page class="js-pagenum textbox h-padding-horiz-none b-form-input__input--shadow" value=1 /> of <span class=pagetotal>1</span>
		</div>

		<div class="horizontal-arrows h-left">
			<a class="arrow left-arrow h-disabled" title="Previous Page" rel=prev><span class="vb-icon vb-icon-arrow-left"></span></a>
			<a class="arrow right-arrow h-disabled" title="Next Page" rel=next><span class="vb-icon vb-icon-arrow-right"></span></a>
		</div>
	</form>	
</div>
					</div>
				</li>
				
					<li class="h-hide-on-xsmall js-shrink-event-child">
						<div class=toolbar-divider>
							<span class=toolbar-divider-inner></span>
						</div>
					</li>
				
			

			
				<li class="toolbar-filter toolbar-filter-top js-shrink-event-child">
					<div class="filter-wrapper h-clearfix js-button" tabindex=0>
						<div class="label h-left">Filter</div>
						<div class="arrow vb-icon-wrapper h-left"><span class="vb-icon vb-icon-triangle-down-wide"></span></div>
					</div>
				</li>
			

			

			
		</ul>
	</div>


	

	
		
			
		
		
		<form action="activity/get" method=post class="toolbar-filter-overlay h-clearfix">
			<input type=hidden name=nodeid value=51321 />
			<input type=hidden name=view value=thread />
			
			
			
			
				<input type=hidden name=nolimit value=1 />
			
			
				<input type=hidden name=per-page value=20 />
				<input type=hidden name=pagenum value=1 />
			
			
			
			
				<input type=hidden name=userid value=0 />
			
			
			
			<input type=hidden name=showChannelInfo value=1 />
			<ul class=filter-options-list>
				
				
				<li>
					<div class=filter-header>Time</div>
					<div class=filter-options>
						
						
						
						
						
						
						
						
						
							
						
						
						
						

						
							<label><input type=radio name=filter_time value=time_all checked=checked class=js-default-checked /><span>All Time</span></label>
						
						<label><input type=radio name=filter_time value=time_today /><span>Today</span></label>
						<label><input type=radio name=filter_time value=time_lastweek /><span>Last Week</span></label>
						<label><input type=radio name=filter_time value=time_lastmonth /><span>Last Month</span></label>
					</div>
				</li>
				

				

				
				<li>
					<div class=filter-header>Show</div>
					<div class=filter-options>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
							
						
						
						
						

						<label><input type=radio name=filter_show value=show_all checked=checked class=js-default-checked /><span>All</span></label>
						<label><input type=radio name=filter_show value=vBForum_Text /><span>Discussions only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Gallery /><span>Photos only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Video /><span>Videos only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Link /><span>Links only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Poll /><span>Polls only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Event /><span>Events only</span></label>
					</div>
				</li>
				
				
				
				
				
				

				

				
				<!-- end if prefixsets -->
			</ul>
		</form>

		

		<div class="filtered-by h-clearfix h-hide">
			<label>Filtered by:</label>
			<div class="filter-text-wrapper h-left">
				
				
				
			</div>
			<a href="https://forum.powerbasic.com/#" class="clear-all h-hide">Clear All</a>
		</div>
		<div class=new-conversations-strip><span></span> new posts</div>
	
</div>



	<div class="h-show-on-xsmall h-right h-margin-top-l js-under-toolbar-pagenav h-margin-bottom-m">
		


	



	


<div class="pagenav-container h-clearfix noselect h-hide pagenav-container--no-margin">
	<div class="js-pagenav pagenav h-right js-shrink-event-parent" data-baseurl="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples">

		

		
		
			<a class="js-pagenav-button js-pagenav-prev-button b-button b-button--secondary h-hide-imp js-shrink-event-child" data-page=0 href tabindex=0>Previous</a>
		

		
		
		
		
		
		<a class="js-pagenav-button b-button b-button--narrow js-shrink-event-child b-button--secondary js-pagenav-button--template h-hide-imp" data-page=0 href=index.html tabindex=0>template</a>

		
		
			<a class="js-pagenav-button js-pagenav-next-button b-button b-button--secondary h-hide-imp js-shrink-event-child" data-page=0 href tabindex=0>Next</a>
		

	</div>
</div>
	</div>

					<div class=conversation-content>
						<ul class="conversation-list list-container h-clearfix   thread-view">
							
								
								
								

								
								
								
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								

								

								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
							
							
							
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							

							

							
							
							
								
									
									
								
								
									
									<!-- Starter Conversation -->
									
									



	
	


















	
		
	





<li data-node-id=51321 data-node-publishdate=1333727751 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text b-post--first js-conversation-starter h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/CreativeWork">

	
	
	
		<a id=post51321 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%23post51321" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples#post51321" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=Assorted+COM+examples&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%23post51321" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							
								<a class="b-post__count js-show-post-link" href="#post51321">#1
								</a>
							

							

							


						</div>
						<div class=b-media__body>
							
								<h2 class="b-post__title js-post-title b-post__hide-when-deleted">
									
									
									Assorted COM examples
								</h2>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T08:55:51>6 Apr 2012, 11:55 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						
							<div class="axd axd_first-post">
								
								
								
							</div>
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								Microsoft COM (Component Object Model) technology in the Microsoft Windows-family of Operating Systems enables software components to communicate. COM is used by developers to create re-usable software components, link components together to build applications, and take advantage of Windows services. COM objects can be created with a variety of programming languages. Object-oriented languages, such as C++, provide programming mechanisms that simplify the implementation of COM objects. The family of COM technologies includes COM+, Distributed COM (DCOM) and ActiveX¬Æ Controls.<br/>
<br/>
Microsoft provides COM interfaces for many Windows application programming interfaces such as Direct Show, Media Foundation, Packaging API, Windows Animation Manager, Windows Portable Devices, and Microsoft Active Directory (AD).<br/>
<br/>
COM is used in applications such as the Microsoft Office Family of products. For example COM OLE technology allows Word documents to dynamically link to data in Excel spreadsheets and COM Automation allows users to build scripts in their applications to perform repetitive tasks or control one application from another.
							
						</div>
					</div>


	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 







		
			
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		
			<div class="h-margin-bottom-xl h-margin-top-none h-text-size--11" id=content-tags-51321>

	
	
	
	
	
	
		
	

	
		<strong>Tags:</strong>
	

	
		<span class=js-content-tag-none>None</span>
	
</div>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=51321 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class=edit-conversation-container></div>
		



      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
									
									
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608603 data-node-publishdate=1333727804 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608603 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608603%23post608603" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608603#post608603" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=How+to+enumerate+the+Running+Object+Table+%28ROT%29&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608603%23post608603" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608603">#2</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T08:56:44>6 Apr 2012, 11:56 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								How to enumerate the Running Object Table (ROT)<br/>
<br/>
The <b>IRunningObjectTable</b> interface manages access to the Running Object Table (ROT), a globally accessible look-up table on each workstation. A workstation's ROT keeps track of those objects that can be identified by a moniker and that are currently running on the workstation. When a client tries to bind a moniker to an object, the moniker checks the ROT to see if the object is already running; this allows the moniker to bind to the current instance instead of loading a new one.<br/>
<br/>
The ROT contains entries of the form:<br/>
<br/>
<span style="font-family:Courier New">(pmkObjectName, pUnkObject)</span><br/>
<br/>
The <i>pmkObjectName</i> element is a pointer to the moniker that identifies the running object. The <i>pUnkObject</i> element is a pointer to the running object itself. During the binding process, monikers consult the <i>pmkObjectName</i> entries in the Running Object Table to see if an object is already running.<br/>
<br/>
Objects that can be named by monikers must be registered with the ROT when they are loaded and their registration must be revoked when they are no longer running.<br/>
<br/>
The following example shows the display names of all the objects currently registered in the Running Object Table (ROT).<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' The following example shows the display names of all the objects currently registered in
' the Running Object Table (ROT).
' ########################################################################################

#COMPILE EXE
#DIM ALL
#INCLUDE "windows.inc"
#INCLUDE "objidl.inc"

' ========================================================================================
' Main
' ========================================================================================
FUNCTION PBMAIN () AS LONG

   LOCAL hr AS LONG
   LOCAL pbc AS IBindCtx
   LOCAL pRot AS IRunningObjectTable
   LOCAL pEnumMoniker AS IEnumMoniker
   LOCAL pMoniker AS IMoniker
   LOCAL pceltFetched AS DWORD
   LOCAL pwszDisplayName AS WSTRINGZ PTR

   ' // Get a pointer to a bind context
   hr = CreateBindCtx(0, pbc)
   IF hr &lt;&gt; %S_OK THEN EXIT FUNCTION

   ' // Get a reference to the Running Object Table (ROT)
   hr = pbc.GetRunningObjectTable(pRot)
   IF hr &lt;&gt; %S_OK THEN EXIT FUNCTION

   ' // Get a pointer to the moniker enumerator
   hr = pRot.EnumRunning(pEnumMoniker)
   IF hr &lt;&gt; %S_OK THEN EXIT FUNCTION

   ' // Enumerate the monikers and retrieve the display name
   DO
      ' // Fetch the next moniker
      hr = pEnumMoniker.Next(1, pMoniker, pceltFetched)
      IF hr &lt;&gt; %S_OK THEN EXIT DO
      ' // Get the display name
      hr = pMoniker.GetDisplayName(pbc, NOTHING, pwszDisplayName)
      IF hr &lt;&gt; %S_OK THEN EXIT DO
      IF pwszDisplayName THEN
         ' // Display the name
         ? @pwszDisplayName
         ' // Free the server allocated string
         CoTaskMemFree pwszDisplayName
      END IF
      ' // Release the moniker reference
      pMoniker = NOTHING
   LOOP

   #IF %DEF(%PB_CC32)
      WAITKEY$
   #ENDIF

END FUNCTION
' ========================================================================================</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608603 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608603 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608603 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608604 data-node-publishdate=1333727917 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608604 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608604%23post608604" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608604#post608604" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=IFileOpenDialog+Interface&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608604%23post608604" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608604">#3</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T08:58:37>6 Apr 2012, 11:58 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								IFileOpenDialog Interface<br/>
<br/>
The following example demonstrates the use of the <b>IFileOpenDialog</b> interface, introduced in Windows Vista.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">#COMPILE EXE
#DIM ALL
#INCLUDE "ShObjIdl.inc"

FUNCTION PBMAIN () AS LONG

   LOCAL hr AS LONG

   ' // Create an instance of the IFileOpenDialog interface
   LOCAL pofd AS IFileOpenDialog
   pofd = NEWCOM CLSID $CLSID_FileOpenDialog
   IF ISNOTHING(pofd) THEN EXIT FUNCTION

   DIM rgFileTypes(2) AS COMDLG_FILTERSPEC
   DIM pszNames(2) AS WSTRINGZ * %MAX_PATH
   DIM pszSpecs(2) AS WSTRINGZ * %MAX_PATH
   pszNames(0) = "PB code files"
   pszNames(1) = "Executable files"
   pszNames(2) = "All files"
   pszSpecs(0) = "*.bas;*.inc"
   pszSpecs(1) = "*.exe;*.dll"
   pszSpecs(2) = "*.*"
   rgFileTypes(0).pszName = VARPTR(pszNames(0)) : rgFileTypes(0).pszSpec = VARPTR(pszSpecs(0))
   rgFileTypes(1).pszName = VARPTR(pszNames(1)) : rgFileTypes(1).pszSpec = VARPTR(pszSpecs(1))
   rgFileTypes(2).pszName = VARPTR(pszNames(2)) : rgFileTypes(2).pszSpec = VARPTR(pszSpecs(2))
   hr = pofd.SetFileTypes(3, rgFileTypes(0))

   ' // Set the title of the dialog
   hr = pofd.SetTitle("A Single-Selection Dialog")

   ' // Display the dialog
   hr = pofd.Show(0)

   ' // Get the result
   LOCAL pItem AS IShellItem
   LOCAL pwszName AS WSTRINGZ PTR
   IF SUCCEEDED(hr) THEN
      hr = pofd.GetResult(pItem)
      IF SUCCEEDED(hr) THEN
         hr = pItem.GetDisplayName(%SIGDN_FILESYSPATH, pwszName)
         MSGBOX @pwszName
         CoTaskMemFree(pwszName)
      END IF
   END IF

END FUNCTION</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608604 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608604 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608604 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608605 data-node-publishdate=1333729498 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608605 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608605%23post608605" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608605#post608605" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=How+to+implement+the+IDropTarget+interface&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608605%23post608605" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608605">#4</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T09:24:58>6 Apr 2012, 12:24 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								How to implement the IDropTarget interface<br/>
<br/>
The action of using the mouse to transfer data from one place to another is called drag-and-drop.<br/>
<br/>
To made an application the target of a drag-and-drop operation we need to implement the <b>IDropTarget</b> interface and register the application window as drop target with a call to the function <b>RegisterDragDrop</b>.<br/>
<br/>
A drop-target application is responsible for:<br/>
<ul><li>Determining the effect of the drop on the target application.</li>
<li>Incorporating any valid dropped data when the drop occurs.</li>
<li>Communicating target feedback to the source so the source application can provide appropriate visual feedback such as setting the cursor.</li>
<li>Implementing drag scrolling.</li>
<li>Registering and revoking its application windows as drop targets.</li>
</ul><br/>
<br/>
Applications that use drag-and-drop functionality must call the API function <b>OleInitialize</b> before calling any other function of the COM library. Because OLE operations aren't thread safe, <b>OleInitialize</b> specifies the concurrency model as single-thread apartment (STA).<br/>
<br/>
When your application ends, you must call the API function <b>OleUninitialize</b> as the last COM call to close the COM library.<br/>
<br/>
Here is the <b>WinMain</b> function of the attached example, showing the call to <b>OleInitialize</b> at the beginning of the function and the call to <b>OleUninitialize</b> at the end:<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ========================================================================================
' Main
' ========================================================================================
FUNCTION WinMain (BYVAL hInstance AS DWORD, BYVAL hPrevInstance AS DWORD, BYVAL lpszCmdLine AS WSTRINGZ PTR, BYVAL nCmdShow AS LONG) AS LONG

   ' // Set process DPI aware
'   SetProcessDPIAware

   ' Initialize the COM library
   OleInitialize %NULL

   ' // Create an instance of the class
   LOCAL pWindow AS IWindow
   pWindow = CLASS "CWindow"
   IF ISNOTHING(pWindow) THEN EXIT FUNCTION

   ' // Create the main window
   ' // Note: CW_USEDEFAULT is used as the default value When passing 0's as the width and height
   pWindow.CreateWindow(%NULL, "IDropTarget Demo", 0, 0, 0, 0, 0, %WS_EX_TOPMOST, CODEPTR(WindowProc))
   ' // Set the client size
   pWindow.SetClientSize 400, 80
   ' // Center the window
   pWindow.CenterWindow

   ' // Default message pump (you can replace it with your own)
   pWindow.DoEvents(nCmdShow)

   ' Uninitialize the COM library
   OleUninitialize

END FUNCTION
' ========================================================================================</pre>
</div>The API function <b>RegisterDragDrop</b> registers the specified window as one that can be the target of an OLE drag-and-drop operation and specifies the <b>IDropTarget</b> instance to use for drop operations.<br/>
<br/>
In the example, during the processing of the <b>WM_CREATE</b> message in the main window callback function we add a label control, create an instance of our implemented <b>IDropTarget</b> interface and register the label control as a candidate target of an OLE drag-and-drop operation with a call to <b>RegisterDragDrop</b>.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">      CASE %WM_CREATE
         ' // Get a reference to the IWindow interface from the CREATESTRUCT structure
         pWindow = CWindow_GetObjectFromCreateStruct(lParam)
         ' // Add a label
         hLabel = pWindow.AddLabel(hwnd, %IDC_LABEL, "Drop a link here...", 20, 30, 360, 20, %WS_VISIBLE OR %WS_CHILD OR %WS_BORDER)
         IF hLabel THEN
            ' Create a new instance of our implemented IDropTarget interface
            pDropTarget = CLASS "CDropTarget"
            IF ISOBJECT(pDropTarget) THEN
               ' Sets the handle of the label
               pDropTarget.SetHwnd hLabel
               ' Locks the object to ensure that it stays in memory
               hr = CoLockObjectExternal(pDropTarget, %TRUE, %FALSE)
               ' Registers the specified window as one that can be the target
               ' of an OLE drag-and-drop operation and specifies the IDropTarget
               ' instance to use for drop operations.
               hr = RegisterDragDrop(hLabel, pDropTarget)
            END IF
         END IF
         EXIT FUNCTION</pre>
</div><b>RevokeDragDrop</b> revokes the registration of the specified application window as a potential target for OLE drag-and-drop operations.<br/>
<br/>
In the example, during the processing of the <b>WM_DESTROY</b> message we revoke the registration of the label with a call to <b>RevokeDragDrop</b> and release the instance of our implemented <b>IDropTarget</b> interface.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">      CASE %WM_DESTROY
         ' // Revokes the registration of the specified application window as a
         ' // potential target for OLE drag-and-drop operations.
         IF hLabel THEN RevokeDragDrop hLabel
         IF ISOBJECT(pDropTarget) THEN
            ' // Unlocks our IDropTarget interface
            hr = CoLockObjectExternal(pDropTarget, %FALSE, %FALSE)
            ' // Frees the memory used by our IDropTarget interface
            pDropTarget = NOTHING
         END IF
         ' // End the application
         PostQuitMessage 0
         EXIT FUNCTION</pre>
</div>The <b>DragEnter</b> method of the <b>IDropTarget</b> interface determines whether a drop can be accepted and its effect if it is accepted. To determine it, we will call the <b>QueryDataObject</b> and <b>DropEffect</b> methods. <b>QueryDataObject</b> checks if the data object contains the kind of data wanted, and <b>DropEffect</b> determines the allowed effect based on the state of the keyboard.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">      ' ----------------------------------------------------------------------------------
      ' Determines whether a drop can be accepted and its effect if it is accepted
      ' ----------------------------------------------------------------------------------
      METHOD DragEnter ( _                      ' VTable offset = 12
        BYVAL pDataObject AS IDataObject _      ' // Pointer to the interface of the source data object
      , BYVAL grfKeyState AS DWORD _            ' // Current state of keyboard modifier keys
      , BYVAL pt AS POINTL _                    ' // Current cursor coordinates (Must be BYVAL)
      , BYREF pdwEffect AS DWORD _              ' // Pointer to the effect of the drag-and-drop operation
      ) AS LONG                                 ' HRESULT

         pdwEffect = %DROPEFFECT_NONE
         IF ISFALSE ISOBJECT(pDataObject) THEN
            METHOD = %E_FAIL
            EXIT METHOD
         END IF

         ' Check if the data object contains the data we want
         bAllowDrop = ME.QueryDataObject(pDataObject)
         IF bAllowDrop THEN
            ' Get the dropeffect based on keyboard state
            pdwEffect = ME.DropEffect(grfKeyState, pt, pdwEffect)
            ' Bring the window to the foregroung
            IF hwnd THEN SetForegroundWindow hwnd
         END IF

         ' Return success
         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------</pre>
</div>This is our implementation of the <b>QueryDataObject</b> method:<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">      ' ----------------------------------------------------------------------------------
      ' Checks if the data object contains the data we want.
      ' In this example, asks for some CF_TEXT data, stored as a HGLOBAL in the clipboard
      ' ----------------------------------------------------------------------------------
      METHOD QueryDataObject (BYVAL pDataObject AS IDataObject) AS LONG

         LOCAL hr AS LONG
         LOCAL fmtc AS FORMATETC
         LOCAL stgmed AS STGMEDIUM

         fmtc.cfFormat = %CF_TEXT
         fmtc.ptd = %NULL
         fmtc.dwAspect = %DVASPECT_CONTENT
         fmtc.lindex = -1
         fmtc.tymed = %TYMED_HGLOBAL
         hr = pDataObject.GetData(fmtc, stgmed)
         IF hr = %S_OK THEN
            IF stgmed.hGlobal THEN METHOD = %TRUE
            ReleaseStgMedium stgmed
         END IF

      END METHOD
      ' ----------------------------------------------------------------------------------</pre>
</div>And this is our implementation of the <b>DropEffect</b> method:<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">      ' ----------------------------------------------------------------------------------
      ' Retrieves the allowed drop effect
      ' ----------------------------------------------------------------------------------
      METHOD DropEffect (BYVAL grfKeyState AS DWORD, BYVAL pt AS POINTL, BYVAL dwAllowed AS DWORD) AS DWORD

         LOCAL dwEffect  AS DWORD

         ' 1. Check "pt" -&gt; Is a  drop allowed at the specified coordinates?
         ' 2. Work out that the drop-effect should be based on grfKeyState
         IF (grfKeyState AND %MK_CONTROL) THEN
            dwEffect = dwAllowed AND %DROPEFFECT_COPY
         ELSEIF (grfKeyState AND %MK_SHIFT) THEN
            dwEffect = dwAllowed AND %DROPEFFECT_MOVE
         END IF

         ' 3. No key-modifiers were specified (or drop effect not allowed), so
         '    base the effect on those allowed by the dropsource
         IF dwEffect = 0 THEN
            IF (dwAllowed AND %DROPEFFECT_COPY) THEN dwEffect = %DROPEFFECT_COPY
            IF (dwAllowed AND %DROPEFFECT_MOVE) THEN dwEffect = %DROPEFFECT_MOVE
            IF (dwAllowed AND %DROPEFFECT_LINK) THEN dwEffect = %DROPEFFECT_LINK
         END IF
         METHOD = dwEffect

      END METHOD
      ' ----------------------------------------------------------------------------------</pre>
</div>The <b>DragOver</b> method is called whenever the state of the keyboard modifiers change or when the mouse moves. In our example, we call the <b>DropEffect</b> function to determine which drop effect is allowed and communicate it to the caller though the <i>pdwEffect</i> parameter.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">      ' ----------------------------------------------------------------------------------
      ' Provides target feedback to the user through the DoDragDrop function
      ' ----------------------------------------------------------------------------------
      METHOD DragOver ( _                       ' VTable offset = 16
        BYVAL grfKeyState AS DWORD _            ' // Current state of keyboard modifier keys
      , BYVAL pt AS POINTL _                    ' // Current cursor coordinates (Must be BYVAL)
      , BYREF pdwEffect AS DWORD _              ' // Pointer to the effect of the drag-and-drop operation
      ) AS LONG                                 ' HRESULT

         IF bAllowDrop THEN
            ' Get the dropeffect based on keyboard state
            pdwEffect = ME.DropEffect(grfKeyState, pt, pdwEffect)
         ELSE
            pdwEffect = %DROPEFFECT_NONE
         END IF
         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------</pre>
</div>The <b>DragLeave</b> function is called whenever the mouse cursor is moved outside of our drop-target window, or the <i>Escape</i> key is pressed which cancels the drag-drop operation. In our example, we will simply return %S_OK.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">      ' ----------------------------------------------------------------------------------
      ' Causes the drop target to suspend its feedback actions
      ' ----------------------------------------------------------------------------------
      METHOD DragLeave ( _                      ' VTable offset = 20
      ) AS LONG                                 ' HRESULT

         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------</pre>
</div>Finally, in the <b>Drop</b> method we call the <b>GetData</b> method of the caller implementation of the <b>IDataObject</b> interface through the passed <i>pDataObject</i> pointer to retrieve data from the clipboard. In our example, we get the text and show it in the label. The way it has been implemented allows both to drop selected text or an hyperlink.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">      ' ----------------------------------------------------------------------------------
      ' Drops the data into the target window
      ' ----------------------------------------------------------------------------------
      METHOD Drop ( _                           ' VTable offset = 24
        BYVAL pDataObject AS IDataObject _      ' // Pointer to the interface of the source data object
      , BYVAL grfKeyState AS DWORD _            ' // Current state of keyboard modifier keys
      , BYVAL pt AS POINTL _                    ' // Current cursor coordinates (Must be BYVAL)
      , BYREF pdwEffect AS DWORD _              ' // Pointer to the effect of the drag-and-drop operation
      ) AS LONG                                 ' HRESULT

         pdwEffect = %DROPEFFECT_NONE
         IF ISFALSE ISOBJECT(pDataObject) THEN
            METHOD = %E_FAIL
            EXIT METHOD
         END IF

         ' Get the dropeffect based on keyboard state
         pdwEffect = ME.DropEffect(grfKeyState, pt, pdwEffect)
         '  Ask IDataObject for some CF_TEXT data, stored as a HGLOBAL in the clipboard
         IF bAllowDrop THEN
            fmtc.cfFormat = %CF_TEXT
            fmtc.ptd = %NULL
            fmtc.dwAspect = %DVASPECT_CONTENT
            fmtc.lindex = -1
            fmtc.tymed = %TYMED_HGLOBAL
            hr = pDataObject.GetData(fmtc, stgmed)
            IF hr = %S_OK THEN
               IF stgmed.hGlobal THEN
                  ' Lock the hGlobal handle just in case isn't fixed memory
                  pData = GlobalLock(stgmed.hGlobal)
                  ' Store the data in a string variable
                  strData = @pData
                  ' Show the data in the window
                  IF hwnd THEN SetWindowText hwnd, @pData
                  ' Unlock the global data
                  GlobalUnlock stgmed.hGlobal
               END IF
               ' Free the memory used by the STGMEDIUM structure
               ReleaseStgMedium stgmed
            END IF
         END IF

         ' Return success
         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------</pre>
</div><b>Full example code (CWindow version)</b><br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' This example demostrates how to implement the IDropTarget interface with PowerBASIC
' and make a label the target of a drag and drop operation.
' Note: Instead of a label you can use any other kind of window.
' ########################################################################################

#COMPILE EXE
#DIM ALL

' // Include files for external files
#INCLUDE ONCE "CWindow.inc"   ' // CWindow class
#INCLUDE ONCE "oleidl.inc"

' ########################################################################################
' *** Custom implementation of the IDropTarget interface.
' The IDropTarget interface is one of the interfaces you implement to provide
' drag-and-drop operations in your application. It contains methods used in any
' application that can be a target for data during a drag-and-drop operation. A
' drop-target application is responsible for:

'  * Determining the effect of the drop on the target application.
'  * Incorporating any valid dropped data when the drop occurs.
'  * Communicating target feedback to the source so the source application can provide
'    appropriate visual feedback such as setting the cursor.
'  * Implementing drag scrolling.
'  * Registering and revoking its application windows as drop targets.

' The IDropTarget interface contains methods that handle all these responsibilities except
' registering and revoking the application window as a drop target, for which you must
' call the RegisterDragDrop and the RevokeDragDrop functions.
' You do not call the methods of IDropTarget directly. The DoDragDrop function calls the
' IDropTarget methods during the drag-and-drop operation.
' ########################################################################################

$CLSID_CDropTarget = GUID$("{F9E4BF70-EFA8-411E-A142-F4B02D89D619}")
$IID_IDropTarget = GUID$("{00000122-0000-0000-C000-000000000046}")

' // Need to declare it as common to avoid removal of methods
CLASS CDropTarget $CLSID_CDropTarget AS COMMON

   INSTANCE hr AS LONG
   INSTANCE hwnd AS DWORD
   INSTANCE bAllowDrop AS LONG
   INSTANCE fmtc AS FORMATETC
   INSTANCE stgmed AS STGMEDIUM
   INSTANCE pData AS ASCIIZ PTR
   INSTANCE strData AS STRING

   INTERFACE IDropTargetImpl $IID_IDropTarget

      INHERIT IUnknown

      ' ----------------------------------------------------------------------------------
      ' Determines whether a drop can be accepted and its effect if it is accepted
      ' ----------------------------------------------------------------------------------
      METHOD DragEnter ( _                      ' VTable offset = 12
        BYVAL pDataObject AS IDataObject _      ' // Pointer to the interface of the source data object
      , BYVAL grfKeyState AS DWORD _            ' // Current state of keyboard modifier keys
      , BYVAL pt AS POINTL _                    ' // Current cursor coordinates (Must be BYVAL)
      , BYREF pdwEffect AS DWORD _              ' // Pointer to the effect of the drag-and-drop operation
      ) AS LONG                                 ' HRESULT

         pdwEffect = %DROPEFFECT_NONE
         IF ISFALSE ISOBJECT(pDataObject) THEN
            METHOD = %E_FAIL
            EXIT METHOD
         END IF

         ' Check if the data object contains the data we want
         bAllowDrop = ME.QueryDataObject(pDataObject)
         IF bAllowDrop THEN
            ' Get the dropeffect based on keyboard state
            pdwEffect = ME.DropEffect(grfKeyState, pt, pdwEffect)
            ' Bring the window to the foregroung
            IF hwnd THEN SetForegroundWindow hwnd
         END IF

         ' Return success
         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Provides target feedback to the user through the DoDragDrop function
      ' ----------------------------------------------------------------------------------
      METHOD DragOver ( _                       ' VTable offset = 16
        BYVAL grfKeyState AS DWORD _            ' // Current state of keyboard modifier keys
      , BYVAL pt AS POINTL _                    ' // Current cursor coordinates (Must be BYVAL)
      , BYREF pdwEffect AS DWORD _              ' // Pointer to the effect of the drag-and-drop operation
      ) AS LONG                                 ' HRESULT

         IF bAllowDrop THEN
            ' Get the dropeffect based on keyboard state
            pdwEffect = ME.DropEffect(grfKeyState, pt, pdwEffect)
         ELSE
            pdwEffect = %DROPEFFECT_NONE
         END IF
         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Causes the drop target to suspend its feedback actions
      ' ----------------------------------------------------------------------------------
      METHOD DragLeave ( _                      ' VTable offset = 20
      ) AS LONG                                 ' HRESULT

         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Drops the data into the target window
      ' ----------------------------------------------------------------------------------
      METHOD Drop ( _                           ' VTable offset = 24
        BYVAL pDataObject AS IDataObject _      ' // Pointer to the interface of the source data object
      , BYVAL grfKeyState AS DWORD _            ' // Current state of keyboard modifier keys
      , BYVAL pt AS POINTL _                    ' // Current cursor coordinates (Must be BYVAL)
      , BYREF pdwEffect AS DWORD _              ' // Pointer to the effect of the drag-and-drop operation
      ) AS LONG                                 ' HRESULT

         pdwEffect = %DROPEFFECT_NONE
         IF ISFALSE ISOBJECT(pDataObject) THEN
            METHOD = %E_FAIL
            EXIT METHOD
         END IF

         ' Get the dropeffect based on keyboard state
         pdwEffect = ME.DropEffect(grfKeyState, pt, pdwEffect)
         '  Ask IDataObject for some CF_TEXT data, stored as a HGLOBAL in the clipboard
         IF bAllowDrop THEN
            fmtc.cfFormat = %CF_TEXT
            fmtc.ptd = %NULL
            fmtc.dwAspect = %DVASPECT_CONTENT
            fmtc.lindex = -1
            fmtc.tymed = %TYMED_HGLOBAL
            hr = pDataObject.GetData(fmtc, stgmed)
            IF hr = %S_OK THEN
               IF stgmed.hGlobal THEN
                  ' Lock the hGlobal handle just in case isn't fixed memory
                  pData = GlobalLock(stgmed.hGlobal)
                  ' Store the data in a string variable
                  strData = @pData
                  ' Show the data in the window
                  IF hwnd THEN SetWindowText hwnd, @pData
                  ' Unlock the global data
                  GlobalUnlock stgmed.hGlobal
               END IF
               ' Free the memory used by the STGMEDIUM structure
               ReleaseStgMedium stgmed
            END IF
         END IF

         ' Return success
         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ==================================================================================
      ' *** We can add custom methods and properties here ***
      ' ==================================================================================

      ' ----------------------------------------------------------------------------------
      ' Window handle of the control that has been registered for drag and drop operations
      ' ----------------------------------------------------------------------------------
      METHOD SetHwnd (BYVAL hndl AS DWORD) AS LONG
         hwnd = hndl
         METHOD = %S_OK
      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Returns an string containing the text of the dropped link or text
      ' ----------------------------------------------------------------------------------
      METHOD GetData (BYREF pstrData AS STRING) AS LONG
         pstrData = strData
         METHOD = %S_OK
      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Retrieves the allowed drop effect
      ' ----------------------------------------------------------------------------------
      METHOD DropEffect (BYVAL grfKeyState AS DWORD, BYVAL pt AS POINTL, BYVAL dwAllowed AS DWORD) AS DWORD

         LOCAL dwEffect  AS DWORD

         ' 1. Check "pt" -&gt; Is a  drop allowed at the specified coordinates?
         ' 2. Work out that the drop-effect should be based on grfKeyState
         IF (grfKeyState AND %MK_CONTROL) THEN
            dwEffect = dwAllowed AND %DROPEFFECT_COPY
         ELSEIF (grfKeyState AND %MK_SHIFT) THEN
            dwEffect = dwAllowed AND %DROPEFFECT_MOVE
         END IF

         ' 3. No key-modifiers were specified (or drop effect not allowed), so
         '    base the effect on those allowed by the dropsource
         IF dwEffect = 0 THEN
            IF (dwAllowed AND %DROPEFFECT_COPY) THEN dwEffect = %DROPEFFECT_COPY
            IF (dwAllowed AND %DROPEFFECT_MOVE) THEN dwEffect = %DROPEFFECT_MOVE
            IF (dwAllowed AND %DROPEFFECT_LINK) THEN dwEffect = %DROPEFFECT_LINK
         END IF
         METHOD = dwEffect

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Checks if the data object contains the data we want.
      ' In this example, asks for some CF_TEXT data, stored as a HGLOBAL in the clipboard
      ' ----------------------------------------------------------------------------------
      METHOD QueryDataObject (BYVAL pDataObject AS IDataObject) AS LONG

         LOCAL hr AS LONG
         LOCAL fmtc AS FORMATETC
         LOCAL stgmed AS STGMEDIUM

         fmtc.cfFormat = %CF_TEXT
         fmtc.ptd = %NULL
         fmtc.dwAspect = %DVASPECT_CONTENT
         fmtc.lindex = -1
         fmtc.tymed = %TYMED_HGLOBAL
         hr = pDataObject.GetData(fmtc, stgmed)
         IF hr = %S_OK THEN
            IF stgmed.hGlobal THEN METHOD = %TRUE
            ReleaseStgMedium stgmed
         END IF

      END METHOD
      ' ----------------------------------------------------------------------------------

   END INTERFACE

END CLASS
' ########################################################################################


' ########################################################################################
' Testing code
' ########################################################################################

%IDC_LABEL = 1001

' ========================================================================================
' Main
' ========================================================================================
FUNCTION WinMain (BYVAL hInstance AS DWORD, BYVAL hPrevInstance AS DWORD, BYVAL lpszCmdLine AS WSTRINGZ PTR, BYVAL nCmdShow AS LONG) AS LONG

   ' // Set process DPI aware
'   SetProcessDPIAware

   ' Initialize the COM library
   OleInitialize %NULL

   ' // Create an instance of the class
   LOCAL pWindow AS IWindow
   pWindow = CLASS "CWindow"
   IF ISNOTHING(pWindow) THEN EXIT FUNCTION

   ' // Create the main window
   ' // Note: CW_USEDEFAULT is used as the default value When passing 0's as the width and height
   pWindow.CreateWindow(%NULL, "IDropTarget Demo", 0, 0, 0, 0, 0, %WS_EX_TOPMOST, CODEPTR(WindowProc))
   ' // Set the client size
   pWindow.SetClientSize 400, 80
   ' // Center the window
   pWindow.CenterWindow

   ' // Default message pump (you can replace it with your own)
   pWindow.DoEvents(nCmdShow)

   ' Uninitialize the COM library
   OleUninitialize

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main callback function.
' ========================================================================================
FUNCTION WindowProc (BYVAL hwnd AS DWORD, BYVAL uMsg AS DWORD, BYVAL wParam AS DWORD, BYVAL lParam AS LONG) AS LONG

   LOCAL hr AS LONG
   STATIC hLabel AS DWORD
   STATIC pDropTarget AS IDropTargetImpl
   STATIC pWindow AS IWindow

   SELECT CASE uMsg

      CASE %WM_CREATE
         ' // Get a reference to the IWindow interface from the CREATESTRUCT structure
         pWindow = CWindow_GetObjectFromCreateStruct(lParam)
         ' // Add a label
         hLabel = pWindow.AddLabel(hwnd, %IDC_LABEL, "Drop a link here...", 20, 30, 360, 20, %WS_VISIBLE OR %WS_CHILD OR %WS_BORDER)
         IF hLabel THEN
            ' Create a new instance of our implemented IDropTarget interface
            pDropTarget = CLASS "CDropTarget"
            IF ISOBJECT(pDropTarget) THEN
               ' Sets the handle of the label
               pDropTarget.SetHwnd hLabel
               ' Locks the object to ensure that it stays in memory
               hr = CoLockObjectExternal(pDropTarget, %TRUE, %FALSE)
               ' Registers the specified window as one that can be the target
               ' of an OLE drag-and-drop operation and specifies the IDropTarget
               ' instance to use for drop operations.
               hr = RegisterDragDrop(hLabel, pDropTarget)
            END IF
         END IF
         EXIT FUNCTION

      CASE %WM_COMMAND
         SELECT CASE LO(WORD, wParam)
            CASE %IDCANCEL
               ' // If the Escape key has been pressed...
               IF HI(WORD, wParam) = %BN_CLICKED THEN
                  ' // ... close the application by sending a WM_CLOSE message
                  SendMessage hwnd, %WM_CLOSE, 0, 0
                  EXIT FUNCTION
               END IF
         END SELECT

      CASE %WM_DESTROY
         ' // Revokes the registration of the specified application window as a
         ' // potential target for OLE drag-and-drop operations.
         IF hLabel THEN RevokeDragDrop hLabel
         IF ISOBJECT(pDropTarget) THEN
            ' // Unlocks our IDropTarget interface
            hr = CoLockObjectExternal(pDropTarget, %FALSE, %FALSE)
            ' // Frees the memory used by our IDropTarget interface
            pDropTarget = NOTHING
         END IF
         ' // End the application
         PostQuitMessage 0
         EXIT FUNCTION

   END SELECT

   ' // Pass unprocessed messages to Windows
   FUNCTION = DefWindowProc(hwnd, uMsg, wParam, lParam)

END FUNCTION
' ========================================================================================</pre>
</div><b>Full example code (DDT version)</b><br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' This example demostrates how to implement the IDropTarget interface with PowerBASIC
' and make a label the target of a drag and drop operation.
' Note: Instead of a label you can use any other kind of window.
' ########################################################################################

#COMPILE EXE
#DIM ALL

' // Include files for external files
#INCLUDE ONCE "CWindow.inc"   ' // CWindow class
#INCLUDE ONCE "oleidl.inc"

' ########################################################################################
' *** Custom implementation of the IDropTarget interface.
' The IDropTarget interface is one of the interfaces you implement to provide
' drag-and-drop operations in your application. It contains methods used in any
' application that can be a target for data during a drag-and-drop operation. A
' drop-target application is responsible for:

'  * Determining the effect of the drop on the target application.
'  * Incorporating any valid dropped data when the drop occurs.
'  * Communicating target feedback to the source so the source application can provide
'    appropriate visual feedback such as setting the cursor.
'  * Implementing drag scrolling.
'  * Registering and revoking its application windows as drop targets.

' The IDropTarget interface contains methods that handle all these responsibilities except
' registering and revoking the application window as a drop target, for which you must
' call the RegisterDragDrop and the RevokeDragDrop functions.
' You do not call the methods of IDropTarget directly. The DoDragDrop function calls the
' IDropTarget methods during the drag-and-drop operation.
' ########################################################################################

$CLSID_CDropTarget = GUID$("{F9E4BF70-EFA8-411E-A142-F4B02D89D619}")
$IID_IDropTarget = GUID$("{00000122-0000-0000-C000-000000000046}")

' // Need to declare it as common to avoid removal of methods
CLASS CDropTarget $CLSID_CDropTarget AS COMMON

   INSTANCE hr AS LONG
   INSTANCE hwnd AS DWORD
   INSTANCE bAllowDrop AS LONG
   INSTANCE fmtc AS FORMATETC
   INSTANCE stgmed AS STGMEDIUM
   INSTANCE pData AS ASCIIZ PTR
   INSTANCE strData AS STRING

   INTERFACE IDropTargetImpl $IID_IDropTarget

      INHERIT IUnknown

      ' ----------------------------------------------------------------------------------
      ' Determines whether a drop can be accepted and its effect if it is accepted
      ' ----------------------------------------------------------------------------------
      METHOD DragEnter ( _                      ' VTable offset = 12
        BYVAL pDataObject AS IDataObject _      ' // Pointer to the interface of the source data object
      , BYVAL grfKeyState AS DWORD _            ' // Current state of keyboard modifier keys
      , BYVAL pt AS POINTL _                    ' // Current cursor coordinates (Must be BYVAL)
      , BYREF pdwEffect AS DWORD _              ' // Pointer to the effect of the drag-and-drop operation
      ) AS LONG                                 ' HRESULT

         pdwEffect = %DROPEFFECT_NONE
         IF ISFALSE ISOBJECT(pDataObject) THEN
            METHOD = %E_FAIL
            EXIT METHOD
         END IF

         ' Check if the data object contains the data we want
         bAllowDrop = ME.QueryDataObject(pDataObject)
         IF bAllowDrop THEN
            ' Get the dropeffect based on keyboard state
            pdwEffect = ME.DropEffect(grfKeyState, pt, pdwEffect)
            ' Bring the window to the foregroung
            IF hwnd THEN SetForegroundWindow hwnd
         END IF

         ' Return success
         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Provides target feedback to the user through the DoDragDrop function
      ' ----------------------------------------------------------------------------------
      METHOD DragOver ( _                       ' VTable offset = 16
        BYVAL grfKeyState AS DWORD _            ' // Current state of keyboard modifier keys
      , BYVAL pt AS POINTL _                    ' // Current cursor coordinates (Must be BYVAL)
      , BYREF pdwEffect AS DWORD _              ' // Pointer to the effect of the drag-and-drop operation
      ) AS LONG                                 ' HRESULT

         IF bAllowDrop THEN
            ' Get the dropeffect based on keyboard state
            pdwEffect = ME.DropEffect(grfKeyState, pt, pdwEffect)
         ELSE
            pdwEffect = %DROPEFFECT_NONE
         END IF
         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Causes the drop target to suspend its feedback actions
      ' ----------------------------------------------------------------------------------
      METHOD DragLeave ( _                      ' VTable offset = 20
      ) AS LONG                                 ' HRESULT

         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Drops the data into the target window
      ' ----------------------------------------------------------------------------------
      METHOD Drop ( _                           ' VTable offset = 24
        BYVAL pDataObject AS IDataObject _      ' // Pointer to the interface of the source data object
      , BYVAL grfKeyState AS DWORD _            ' // Current state of keyboard modifier keys
      , BYVAL pt AS POINTL _                    ' // Current cursor coordinates (Must be BYVAL)
      , BYREF pdwEffect AS DWORD _              ' // Pointer to the effect of the drag-and-drop operation
      ) AS LONG                                 ' HRESULT

         pdwEffect = %DROPEFFECT_NONE
         IF ISFALSE ISOBJECT(pDataObject) THEN
            METHOD = %E_FAIL
            EXIT METHOD
         END IF

         ' Get the dropeffect based on keyboard state
         pdwEffect = ME.DropEffect(grfKeyState, pt, pdwEffect)
         '  Ask IDataObject for some CF_TEXT data, stored as a HGLOBAL in the clipboard
         IF bAllowDrop THEN
            fmtc.cfFormat = %CF_TEXT
            fmtc.ptd = %NULL
            fmtc.dwAspect = %DVASPECT_CONTENT
            fmtc.lindex = -1
            fmtc.tymed = %TYMED_HGLOBAL
            hr = pDataObject.GetData(fmtc, stgmed)
            IF hr = %S_OK THEN
               IF stgmed.hGlobal THEN
                  ' Lock the hGlobal handle just in case isn't fixed memory
                  pData = GlobalLock(stgmed.hGlobal)
                  ' Store the data in a string variable
                  strData = @pData
                  ' Show the data in the window
                  IF hwnd THEN SetWindowText hwnd, @pData
                  ' Unlock the global data
                  GlobalUnlock stgmed.hGlobal
               END IF
               ' Free the memory used by the STGMEDIUM structure
               ReleaseStgMedium stgmed
            END IF
         END IF

         ' Return success
         METHOD = %S_OK

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ==================================================================================
      ' *** We can add custom methods and properties here ***
      ' ==================================================================================

      ' ----------------------------------------------------------------------------------
      ' Window handle of the control that has been registered for drag and drop operations
      ' ----------------------------------------------------------------------------------
      METHOD SetHwnd (BYVAL hndl AS DWORD) AS LONG
         hwnd = hndl
         METHOD = %S_OK
      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Returns an string containing the text of the dropped link or text
      ' ----------------------------------------------------------------------------------
      METHOD GetData (BYREF pstrData AS STRING) AS LONG
         pstrData = strData
         METHOD = %S_OK
      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Retrieves the allowed drop effect
      ' ----------------------------------------------------------------------------------
      METHOD DropEffect (BYVAL grfKeyState AS DWORD, BYVAL pt AS POINTL, BYVAL dwAllowed AS DWORD) AS DWORD

         LOCAL dwEffect  AS DWORD

         ' 1. Check "pt" -&gt; Is a  drop allowed at the specified coordinates?
         ' 2. Work out that the drop-effect should be based on grfKeyState
         IF (grfKeyState AND %MK_CONTROL) THEN
            dwEffect = dwAllowed AND %DROPEFFECT_COPY
         ELSEIF (grfKeyState AND %MK_SHIFT) THEN
            dwEffect = dwAllowed AND %DROPEFFECT_MOVE
         END IF

         ' 3. No key-modifiers were specified (or drop effect not allowed), so
         '    base the effect on those allowed by the dropsource
         IF dwEffect = 0 THEN
            IF (dwAllowed AND %DROPEFFECT_COPY) THEN dwEffect = %DROPEFFECT_COPY
            IF (dwAllowed AND %DROPEFFECT_MOVE) THEN dwEffect = %DROPEFFECT_MOVE
            IF (dwAllowed AND %DROPEFFECT_LINK) THEN dwEffect = %DROPEFFECT_LINK
         END IF
         METHOD = dwEffect

      END METHOD
      ' ----------------------------------------------------------------------------------

      ' ----------------------------------------------------------------------------------
      ' Checks if the data object contains the data we want.
      ' In this example, asks for some CF_TEXT data, stored as a HGLOBAL in the clipboard
      ' ----------------------------------------------------------------------------------
      METHOD QueryDataObject (BYVAL pDataObject AS IDataObject) AS LONG

         LOCAL hr AS LONG
         LOCAL fmtc AS FORMATETC
         LOCAL stgmed AS STGMEDIUM

         fmtc.cfFormat = %CF_TEXT
         fmtc.ptd = %NULL
         fmtc.dwAspect = %DVASPECT_CONTENT
         fmtc.lindex = -1
         fmtc.tymed = %TYMED_HGLOBAL
         hr = pDataObject.GetData(fmtc, stgmed)
         IF hr = %S_OK THEN
            IF stgmed.hGlobal THEN METHOD = %TRUE
            ReleaseStgMedium stgmed
         END IF

      END METHOD
      ' ----------------------------------------------------------------------------------

   END INTERFACE

END CLASS
' ########################################################################################


' ########################################################################################
' Testing code
' ########################################################################################

%IDC_LABEL = 1001

' ========================================================================================
' Main
' ========================================================================================
FUNCTION WINMAIN (BYVAL hInstance AS DWORD, BYVAL hPrevInstance AS DWORD, BYVAL lpszCmdLine AS ASCIIZ PTR, BYVAL nCmdShow AS LONG) AS LONG

   LOCAL hDlg AS LONG

   ' Initialize the COM library
   OleInitialize %NULL

   DIALOG NEW PIXELS, 0, "IDropTarget Demo", , , 400, 80, %WS_OVERLAPPED OR %WS_THICKFRAME OR %WS_SYSMENU OR _
   %WS_MINIMIZEBOX OR %WS_MAXIMIZEBOX OR %WS_VISIBLE OR %DS_CENTER, %WS_EX_TOPMOST TO hDlg
   DIALOG SHOW MODAL hDlg, CALL DlgProc

   ' Uninitialize the COM library
   OleUninitialize

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main Dialog procedure
' ========================================================================================
CALLBACK FUNCTION DlgProc() AS LONG

   LOCAL hr AS LONG
   STATIC hLabel AS DWORD
   STATIC pDropTarget AS IDropTargetImpl

   SELECT CASE CBMSG

      CASE %WM_INITDIALOG
         '  Creates a label control
         CONTROL ADD LABEL, CBHNDL, %IDC_LABEL, "Drop a link here...", 20, 30, 360, 20, %WS_VISIBLE OR %WS_CHILD OR %WS_BORDER
         ' Gets the handle of the label
         CONTROL HANDLE CBHNDL, %IDC_LABEL to hLabel
         IF hLabel THEN
            ' Create a new instance of our implemented IDropTarget interface
            pDropTarget = CLASS "CDropTarget"
            IF ISOBJECT(pDropTarget) THEN
               ' Sets the handle of the label
               pDropTarget.SetHwnd hLabel
               ' Locks the object to ensure that it stays in memory
               hr = CoLockObjectExternal(pDropTarget, %TRUE, %FALSE)
               ' Registers the specified window as one that can be the target
               ' of an OLE drag-and-drop operation and specifies the IDropTarget
               ' instance to use for drop operations.
               hr = RegisterDragDrop(hLabel, pDropTarget)
            END IF
         END IF

      CASE %WM_COMMAND
         SELECT CASE CBCTL
            CASE %IDCANCEL
               IF CBCTLMSG = %BN_CLICKED THEN DIALOG END CBHNDL, 0
         END SELECT

      CASE %WM_DESTROY
         ' // Revokes the registration of the specified application window as a
         ' // potential target for OLE drag-and-drop operations.
         IF hLabel THEN RevokeDragDrop hLabel
         IF ISOBJECT(pDropTarget) THEN
            ' // Unlocks our IDropTarget interface
            hr = CoLockObjectExternal(pDropTarget, %FALSE, %FALSE)
            ' // Frees the memory used by our IDropTarget interface
            pDropTarget = NOTHING
         END IF

   END SELECT

END FUNCTION
' ========================================================================================</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608605 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608605 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608605 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608606 data-node-publishdate=1333729817 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608606 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608606%23post608606" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608606#post608606" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=How+to+create+a+type+library+programatically&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608606%23post608606" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608606">#5</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T09:30:17>6 Apr 2012, 12:30 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								How to create a type library programatically<br/>
<br/>
Demonstrates how to create an OLE Automation type library using the <b>ICreateTypeLib</b> and <b>ICreateTypeInfo</b> interfaces. The type library that is created is called hello.tlb and corresponds to one that would have been built by mktyplib.exe if it had compiled the following .odl file. <br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">[
  uuid(2F6CA420-C641-101A-B826-00DD01103DE1),            // LIBID_Hello
  helpstring("Hello 1.0 Type Library"),
  lcid(0x0409),
  version(1.0)
] 
library Hello
{
#ifdef WIN32
    importlib("stdole32.tlb");
#else
    importlib("stdole.tlb");
#endif
    
    [
      uuid(2F6CA422-C641-101A-B826-00DD01103DE1),        // IID_IHello
      helpstring("Hello Interface")
    ]
    interface IHello : IUnknown
    {
        [propput] void HelloMessage([in] BSTR Message);
        [propget] BSTR HelloMessage(void);
        void SayHello(void);        
    }
    [
      uuid(2F6CA423-C641-101A-B826-00DD01103DE1),        // IID_DHello
      helpstring("Hello Dispinterface")
    ]  
    dispinterface DHello
    {
      interface IHello;
    }                                         
    
    [
       uuid(2F6CA421-C641-101A-B826-00DD01103DE1),       // CLSID_Hello
       helpstring("Hello Class")
    ]                                             
    coclass Hello
    {   
        dispinterface DHello;
        interface IHello;
    }
}</pre>
</div>The following PowerBASIC example is based in the C program TYPEBLD, written by Microsoft Product Support Services, Windows Developer Support (c) Copyright Microsoft Corp. 1995.<br/>
<br/>
<a href="http://support.microsoft.com/kb/131105/EN-US/" target=_blank rel=nofollow>http://support.microsoft.com/kb/131105/EN-US/</a><br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ========================================================================================
' Demonstrates how to build a type library programatically.
' Based on the C program TypeBld, written by Microsoft Product Support Services, Windows
' Developer Support (c) Copyright Microsoft Corp. 1995.
' ========================================================================================

#COMPILE EXE
#DIM ALL
#INCLUDE ONCE "OleAuto.inc"

$LIBID_Hello = GUID$("{2F6CA420-C641-101A-B826-00DD01103DE1}")
$CLSID_Hello = GUID$("{2F6CA421-C641-101A-B826-00DD01103DE1}")
$IID_IHello = GUID$("{2F6CA422-C641-101A-B826-00DD01103DE1}")
$IID_DHello = GUID$("{2F6CA423-C641-101A-B826-00DD01103DE1}")

' ========================================================================================
' Create the type infos
' ========================================================================================
FUNCTION CreateTypeInfos (BYVAL pctlib AS ICreateTypeLib) AS LONG

   LOCAL hr AS LONG

   LOCAL wszText AS WSTRINGZ * 260            ' // General purpose variable
   LOCAL ptlibStdOle AS ITypeLib              ' // ITypeLib reference pointer
   LOCAL ptinfoIUnknown AS ITypeInfo          ' // ITypeInfo reference pointer
   LOCAL ptinfoIDispatch AS ITypeInfo         ' // ITypeInfo reference pointer
   LOCAL pctinfo AS ICreateTypeInfo           ' // ICreateTypeInfo reference pointer
   LOCAL hreftype AS DWORD                    ' // Reference type

   wszText = "stdole32.tlb"
   hr = LoadTypeLib(wszText, ptlibStdOle)
   hr = ptlibStdOle.GetTypeInfoOfGuid($IID_IUNKNOWN, ptinfoIUnknown)
   hr = ptlibStdOle.GetTypeInfoOfGuid($IID_IDISPATCH, ptinfoIDispatch)
   ptlibStdOle = NOTHING

   wszText = "IHello"
   hr = pctlib.CreateTypeInfo(wszText, %TKIND_INTERFACE, pctinfo)
   hr = pctinfo.SetGuid($IID_IHello)
   wszText = "Hello interface"
   hr = pctinfo.SetDocString(wszText)

   ' Save typeinfo of IHello for others who may refer to it.
   LOCAL ptinfoIHello AS ITypeInfo
   ptinfoIHello = pctinfo

   ' Output base interface of IHello (IUnknown)
   hr = pctinfo.AddRefTypeInfo(ptinfoIUnknown, hreftype)
   hr = pctinfo.AddImplType(0, hreftype)

   LOCAL tfuncdesc AS FUNCDESC

   ' Output [propget, id(0)] BSTR HelloMessage(void)
   DIM rgszFuncArgNamesHM(0) AS WSTRING
   rgszFuncArgNamesHM(0) = "HelloMessage"

   tfuncdesc.memid = 0
   tfuncdesc.lprgscode = %NULL
   tfuncdesc.lprgelemdescParam = %NULL
   tfuncdesc.funckind = %FUNC_PUREVIRTUAL
   tfuncdesc.invkind = %INVOKE_PROPERTYGET
   tfuncdesc.callconv = %CC_STDCALL
   tfuncdesc.cParams = 0
   tfuncdesc.cParamsOpt = 0
   tfuncdesc.oVft = 0         ' This will be assigned by ICreateTypeInfo.LayOut
   tfuncdesc.cScodes = 0
   tfuncdesc.elemdescFunc.tdesc.vt = %VT_BSTR
   tfuncdesc.elemdescFunc.idldesc.dwReserved = %NULL
   tfuncdesc.elemdescFunc.idldesc.wIDLFlags  = %IDLFLAG_NONE
   tfuncdesc.wFuncFlags = 0

   hr = pctinfo.AddFuncDesc(0, tfuncdesc)
   hr = pctinfo.SetFuncAndParamNames(0, rgszFuncArgNamesHM(0), 1)

   ' Output [propput, id(0)] void HelloMessage([in] BSTR Message)
   LOCAL telemdesc AS ELEMDESC

   telemdesc.tdesc.vt = %VT_BSTR
   telemdesc.idldesc.dwReserved = %NULL
   telemdesc.idldesc.wIDLFlags  = %IDLFLAG_FIN

   tfuncdesc.memid = 0
   tfuncdesc.lprgscode = %NULL
   tfuncdesc.lprgelemdescParam = VARPTR(telemdesc)
   tfuncdesc.funckind = %FUNC_PUREVIRTUAL
   tfuncdesc.invkind = %INVOKE_PROPERTYPUT
   tfuncdesc.callconv = %CC_STDCALL
   tfuncdesc.cParams = 1
   tfuncdesc.cParamsOpt = 0
   tfuncdesc.oVft = 0
   tfuncdesc.cScodes = 0
   tfuncdesc.elemdescFunc.tdesc.vt = %VT_VOID
   tfuncdesc.elemdescFunc.idldesc.dwReserved = %NULL
   tfuncdesc.elemdescFunc.idldesc.wIDLFlags = %IDLFLAG_NONE

   hr = pctinfo.AddFuncDesc(1, tfuncdesc)
   hr = pctinfo.SetFuncAndParamNames(1, rgszFuncArgNamesHM(0), 1)

   ' // pctinfo-&gt;SetFuncAndParamNames is supposed to be called
   ' // only once per property. However unless it is called for both
   ' // the propput and propget, an exception will occur in 32 bit when
   ' // ICreateTypeInfo::LayOut is called.
   ' // This problem doesn't exist in 16 bit.

   ' // [id(1)] void SayHello(void)
   DIM rgszFuncArgNamesSH(0) AS WSTRING
   rgszFuncArgNamesSH(0) = "SayHello"

   tfuncdesc.memid = 1
   tfuncdesc.lprgscode = %NULL
   tfuncdesc.lprgelemdescParam = %NULL
   tfuncdesc.funckind = %FUNC_PUREVIRTUAL
   tfuncdesc.invkind = %INVOKE_FUNC
   tfuncdesc.callconv = %CC_STDCALL
   tfuncdesc.cParams = 0
   tfuncdesc.cParamsOpt = 0
   tfuncdesc.oVft = 0
   tfuncdesc.cScodes = 0
   tfuncdesc.elemdescFunc.tdesc.vt = %VT_VOID
   tfuncdesc.elemdescFunc.idldesc.dwReserved = %NULL
   tfuncdesc.elemdescFunc.idldesc.wIDLFlags  = %IDLFLAG_NONE
   tfuncdesc.wFuncFlags = 0

   hr = pctinfo.AddFuncDesc(2, tfuncdesc)
   hr = pctinfo.SetFuncAndParamNames(2, rgszFuncArgNamesSH(0), 1)

   hr = pctinfo.LayOut
   pctinfo = NOTHING

'    /*
'    Generate the typeinfo for the following dispinterface

'    [
'      uuid(2F6CA423-C641-101A-B826-00DD01103DE1),        // IID_DHello
'      helpstring("Hello Dispinterface")
'    ]
'    dispinterface DHello
'    {
'      interface IHello;
'    }
'    */

   wszText = "DHello"
   hr = pctlib.CreateTypeInfo(wszText, %TKIND_DISPATCH, pctinfo)
   hr = pctinfo.SetGuid($IID_DHello)
   wszText = "Hello Dispinterface"
   hr = pctinfo.SetDocString(wszText)

   ' Save typeinfo of IHello for others who may refer to it.
   LOCAL ptinfoDHello AS ITypeInfo
   ptinfoDHello = pctinfo

   ' Output base interface of DHello (IDispatch)
   hr = pctinfo.AddRefTypeInfo(ptinfoIDispatch, hreftype)
   hr = pctinfo.AddImplType(0, hreftype)

   ' Specify interface IHello that is wrapped by DHello
   hr = pctinfo.AddRefTypeInfo(ptinfoIHello, hreftype)
   hr = pctinfo.AddImplType(1, hreftype)

   hr = pctinfo.LayOut
   pctinfo = NOTHING


'    /*
'    Generate the typeinfo for the following coclass

'    [
'       uuid(2F6CA421-C641-101A-B826-00DD01103DE1),       // CLSID_Hello
'       helpstring("Hello Class")
'    ]
'    coclass Hello
'    {
'        dispinterface DHello;
'        interface IHello;
'    }
'   */

   wszText = "Hello"
   hr = pctlib.CreateTypeInfo(wszText, %TKIND_COCLASS, pctinfo)

   hr = pctinfo.SetGuid($CLSID_Hello)
   wszText = "Hello Class"
   hr = pctinfo.SetDocString(wszText)

   ' List DHello & IHello in the coclass
   hr = pctinfo.AddRefTypeInfo(ptinfoDHello, hreftype)
   hr = pctinfo.AddImplType(0, hreftype)
   hr = pctinfo.AddRefTypeInfo(ptinfoIHello, hreftype)
   hr = pctinfo.AddImplType(1, hreftype)

   hr = pctinfo.LayOut
   pctinfo = NOTHING

   ptinfoIUnknown = NOTHING
   ptinfoIDispatch = NOTHING
   ptinfoIHello = NOTHING
   ptinfoDHello = NOTHING

   FUNCTION = %NOERROR

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main
' ========================================================================================
FUNCTION PBMAIN () AS LONG


   LOCAL hr AS LONG
   LOCAL wszText AS WSTRINGZ * 260
   LOCAL pctlib AS ICreateTypeLib

   wszText = "hello.tlb"
   hr = CreateTypeLib(%SYS_WIN32, wszText, pctlib)
   IF hr &lt;&gt; %S_OK THEN EXIT FUNCTION
   hr = pctlib.SetLcid(&H409)
   hr = pctlib.SetVersion(1, 0)
   wszText = "Hello"
   hr = pctlib.SetName(wszText)
   hr = pctlib.SetGUID($LIBID_Hello)
   wszText = "Hello 1.0 Type Library"
   hr = pctlib.SetDocString(wszText)
   hr = CreateTypeInfos(pctlib)
   IF hr = %NOERROR THEN hr = pctlib.SaveAllChanges
   pctlib = NOTHING

   IF hr = %S_OK THEN MSGBOX "Done" ELSE MSGBOX "Error"

END FUNCTION
' ========================================================================================</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608606 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608606 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608606 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608608 data-node-publishdate=1333730476 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608608 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608608%23post608608" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608608#post608608" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=How+to+implement+the+IRichEditOleCallback+interface&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608608%23post608608" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608608">#6</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T09:41:16>6 Apr 2012, 12:41 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								How to implement the IRichEditOleCallback interface<br/>
<br/>
Implementing the <b>IRichEditOleCallback</b> interface allows to perform insertion, deletion, cut, copy and paste, and drag operations with objects, such images, in a rich edit control.<br/>
<br/>
The following example demonstrates how to implement the <b>IRichEditOleCallback</b> interface.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' RichOle demo
' ########################################################################################

#DIM ALL
#COMPILE EXE
%UNICODE = 1
%USERICHEDIT = 1

' // Include files for external files
#INCLUDE ONCE "CWindow.inc"   ' // CWindow class
#INCLUDE ONCE "RichOle.inc"

' Control identifier
%IDC_RICHEDIT = 1001

' ========================================================================================
' Main
' ========================================================================================
FUNCTION WinMain (BYVAL hInstance AS DWORD, BYVAL hPrevInstance AS DWORD, BYVAL lpszCmdLine AS WSTRINGZ PTR, BYVAL nCmdShow AS LONG) AS LONG

   ' // Set process DPI aware
'   SetProcessDPIAware

   ' // Create an instance of the class
   LOCAL pWindow AS IWindow
   pWindow = CLASS "CWindow"
   IF ISNOTHING(pWindow) THEN EXIT FUNCTION

   ' // Create the main window
   ' // Note: CW_USEDEFAULT is used as the default value When passing 0's as the width and height
   pWindow.CreateWindow(%NULL, "Rich Ole Demo", 0, 0, 0, 0, 0, 0, CODEPTR(WindowProc))
   ' // Set the client size
   pWindow.SetClientSize 500, 320
   ' // Center the window
   pWindow.CenterWindow

   ' // Add a subclassed rich edit control without coordinates (it will be resized in WM_SIZE, below)
   LOCAL hRichEdit AS DWORD
   hRichEdit = pWindow.AddRichEdit(pWindow.hwnd, %IDC_RICHEDIT, "RichEdit box", 0, 0, 0, 0, 0, 0, CODEPTR(RichEditSubclassProc))
   ' // Specify which notifications the control sends to its parent window
   RichEdit_SetEventMask hRichEdit, %ENM_CHANGE

   ' // Set the IRichEditOleCallback object.
   ' // The control calls the AddRef function for the object before returning.
   LOCAL pRichEditOleCallback AS IRichEditOleCallbackImpl
   pRichEditOleCallback = CLASS "CRichEditOleCallback"
   RichEdit_SetOleCallback hRichEdit, OBJPTR(pRichEditOleCallback)

   ' // Load the file
   RichEdit_LoadRtfFromFile hRichEdit, EXE.Path$ & "Test.rtf"

   ' // Default message pump (you can replace it with your own)
   pWindow.DoEvents(nCmdShow)

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main window callback
' ========================================================================================
FUNCTION WindowProc (BYVAL hwnd AS DWORD, BYVAL uMsg AS DWORD, BYVAL wParam AS DWORD, BYVAL lParam AS LONG) AS LONG

   LOCAL tlf             AS LOGFONT                  ' font attributes
   LOCAL tcf             AS CHARFORMAT               ' rich edit character formatting information
   LOCAL ptnmhdr         AS NMHDR PTR                ' information about a notification message
   LOCAL ptmmi           AS MINMAXINFO PTR           ' pointer to the maximized and tracking info
   LOCAL hwndChild       AS DWORD                    ' handle of child window
   LOCAL hFont           AS DWORD                    ' handle of font used by form
   LOCAL dwMask          AS DWORD                    ' specifies the attributes of an item to retrieve or set
   LOCAL hDC             AS DWORD                    ' handle of memory device context
   STATIC pWindow        AS IWindow                  ' // Reference to the IWindow interface

   SELECT CASE uMsg

      CASE %WM_CREATE
         ' // Get a reference to the IWindow interface from the CREATESTRUCT structure
         pWindow = CWindow_GetObjectFromCreateStruct(lParam)
         EXIT FUNCTION

      CASE %WM_COMMAND
         SELECT CASE LO(WORD, wParam)
            CASE %IDCANCEL
               ' // If the Escape key has been pressed...
               IF HI(WORD, wParam) = %BN_CLICKED THEN
                  ' // ... close the application by sending a WM_CLOSE message
                  SendMessage hwnd, %WM_CLOSE, 0, 0
                  EXIT FUNCTION
               END IF
            CASE %IDC_RICHEDIT
               IF HI(WORD, wParam) = %EN_CHANGE THEN
               END IF
         END SELECT

      CASE %WM_NOTIFY
         ptnmhdr = lParam
         SELECT CASE @ptnmhdr.idFrom
         END SELECT

      CASE %WM_SETFOCUS
         ' Set the keyboard focus to the first control that is
         ' visible, not disabled, and has the WS_TABSTOP style
         SetFocus GetNextDlgTabItem(hwnd, %NULL, %FALSE)

      CASE %WM_DESTROY
         PostQuitMessage 0
         EXIT FUNCTION

      CASE %WM_SIZE
         IF wParam &lt;&gt; %SIZE_MINIMIZED THEN
            pWindow.MoveWindow GetDlgItem(hwnd, %IDC_RICHEDIT), 10, 10, pWindow.ClientWidth - 20, pWindow.ClientHeight - 20, %TRUE
         END IF

   END SELECT

   FUNCTION = DefWindowProc(hwnd, uMsg, wParam, lParam)

END FUNCTION
' ========================================================================================

' ========================================================================================
' RichEdit control subclassed procedure
' ========================================================================================
FUNCTION RichEditSubclassProc ( _
   BYVAL hwnd    AS DWORD, _ ' control handle
   BYVAL uMsg    AS DWORD, _ ' type of message
   BYVAL wParam  AS DWORD, _ ' first message parameter
   BYVAL lParam  AS LONG _   ' second message parameter
   ) AS LONG

   LOCAL lpOldWndProc AS DWORD    ' address of original window procedure

   lpOldWndProc = GetProp(hwnd, "OLDWNDPROC")

   SELECT CASE uMsg
      CASE %WM_DESTROY
         ' // Remove control subclassing
         SetWindowLong hwnd, %GWL_WNDPROC, RemoveProp(hwnd, "OLDWNDPROC")
   END SELECT

   FUNCTION = CallWindowProc(lpOldWndProc, hwnd, uMsg, wParam, lParam)

END FUNCTION
' ========================================================================================


' ########################################################################################
' IRichEditOleCallback interface
' IID = 00020D03-0000-0000-C000-000000000046
' Inherited interface = IUnknown
' Custom implementation of the IRichEditOleCallback interface.
' Used by the RichEdit to get OLE-related stuff from the application using RichEdit.
' Note: Callback interfaces must be declared AS COMMON to avoid code removal.
' ########################################################################################

CLASS CRichEditOleCallback AS COMMON

INTERFACE IRichEditOleCallbackImpl $IID_IRichEditOleCallback

   INHERIT IUnknown

   ' =====================================================================================
   METHOD GetNewStorage ( _                             ' VTable offset = 12
     BYREF lplpstg AS IStorage _                        ' LPSTORAGE FAR * lplpstg
   ) AS LONG                                            ' HRESULT

     LOCAL hr AS LONG
     LOCAL pILockBytes AS ILockBytes
     hr = CreateILockBytesOnHGlobal(%NULL, %TRUE, pILockBytes)
     IF FAILED(hr) THEN METHOD = hr : EXIT METHOD
     hr = StgCreateDocfileOnILockBytes(pILockBytes, _
          %STGM_SHARE_EXCLUSIVE OR %STGM_READWRITE OR %STGM_CREATE, _
          0, lplpstg)
     METHOD = hr

   END METHOD
   ' =====================================================================================
   METHOD GetInPlaceContext ( _                         ' VTable offset = 16
     BYREF lplpFrame AS IOleInPlaceFrame _              ' LPOLEINPLACEFRAME FAR * lplpFrame
   , BYREF lplpDoc AS IOleInPlaceUIWindow _             ' LPOLEINPLACEUIWINDOW FAR * lplpDoc
   , BYREF lpFrameInfo AS OLEINPLACEFRAMEINFO _         ' LPOLEINPLACEFRAMEINFO lpFrameInfo
   ) AS LONG                                            ' HRESULT

     METHOD = %E_NOTIMPL

   END METHOD
   ' =====================================================================================
   METHOD ShowContainerUI ( _                           ' VTable offset = 20
     BYVAL fShow AS LONG _                              ' BOOL fShow
   ) AS LONG                                            ' HRESULT

     METHOD = %E_NOTIMPL

   END METHOD
   ' =====================================================================================
   METHOD QueryInsertObject ( _                         ' VTable offset = 24
     BYREF lpclsid As GUID _                            ' LPCLSID lpclsid
   , BYVAL lpstg AS IStorage _                          ' LPSTORAGE lpstg
   , BYVAL cp AS LONG _                                 ' LONG cp
   ) AS LONG                                            ' HRESULT

     METHOD = %S_OK

   END METHOD
   ' =====================================================================================
   METHOD DeleteObject ( _                              ' VTable offset = 28
     BYVAL lpoleobj AS IOleObject _                     ' LPOLEOBJECT lpoleobj
   ) AS LONG                                            ' HRESULT

     METHOD = %S_OK

   END METHOD
   ' =====================================================================================
   METHOD QueryAcceptData ( _                           ' VTable offset = 32
     BYVAL lpdataobj AS IOleObject _                    ' LPDATAOBJECT lpdataobj
   , BYREF lpcfFormat AS DWORD _                        ' CLIPFORMAT FAR * lpcfFormat
   , BYVAL reco AS DWORD _                              ' DWORD reco
   , BYVAL fReally AS LONG _                            ' BOOL fReally
   , BYVAL hMetaPict AS DWORD _                         ' HGLOBAL hMetaPict
   ) AS LONG                                            ' HRESULT

     METHOD = %E_NOTIMPL

   END METHOD
   ' =====================================================================================
   METHOD ContextSensitiveHelp ( _                      ' VTable offset = 36
     BYVAL fEnterMode AS LONG _                         ' BOOL fEnterMode
   ) AS LONG                                            ' HRESULT

     METHOD = %E_NOTIMPL

   END METHOD
   ' =====================================================================================
   METHOD GetClipboardData ( _                          ' VTable offset = 40
     BYREF lpchrg AS CHARRANGE _                        ' CHARRANGE FAR * lpchrg
   , BYVAL reco AS DWORD _                              ' DWORD reco
   , BYREF lplpdataobj AS IOleObject _                  ' LPDATAOBJECT FAR * lplpdataobj
   ) AS LONG                                            ' HRESULT

     METHOD = %E_NOTIMPL

   END METHOD
   ' =====================================================================================
   METHOD GetDragDropEffect ( _                         ' VTable offset = 44
     BYVAL fDrag AS LONG _                              ' BOOL fDrag
   , BYVAL grfKeyState AS DWORD _                       ' DWORD grfKeyState
   , BYREF pdwEffect AS DWORD _                         ' LPDWORD pdwEffect
   ) AS LONG                                            ' HRESULT

     METHOD = %E_NOTIMPL

   END METHOD
   ' =====================================================================================
   METHOD GetContextMenu ( _                            ' VTable offset = 48
     BYVAL seltype AS WORD _                            ' WORD seltype
   , BYVAL lpoleobj AS IOleObject _                     ' LPOLEOBJECT lpoleobj
   , BYREF lpchrg AS CHARRANGE _                        ' CHARRANGE FAR * lpchrg
   , BYREF lphmenu AS DWORD _                           ' HMENU FAR * lphmenu
   ) AS LONG                                            ' HRESULT

     METHOD = %E_NOTIMPL

   END METHOD
   ' =====================================================================================

END INTERFACE

END CLASS
' ========================================================================================</pre>
</div>
		<div class="js-post-attachments b-post-attachments h-clearfix">
			Attached Files
			<ul>
				
					
						
					

					
					
						
						
						
						
							
						
					


					<li class="b-post-attachments__item h-left">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727833">
							
								
									
								
								<img src="resources/fetch2.png" title="Click image for larger version

Name:	RichOleDemo.png
Views:	433
Size:	14.4 KB
ID:	727833" alt="Click image for larger version

Name:	RichOleDemo.png
Views:	433
Size:	14.4 KB
ID:	727833" class=js-lightbox data-fullsize-url="filedata/fetch?id=727833&amp;type=thumb" data-thumb-url="filedata/fetch?id=727833&amp;type=thumb" data-title="Click on the image to see the original version"/>
							
						</a>
					</li>
				
					
						
					

					
					


					<li class="b-post-attachments__item h-left h-clear">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727832">
							
								<span class="b-icon b-icon__doc--gray"></span>
								<span class=h-wordwrap>RichOleDemo.zip</span>
								
									
								
								<span>(12.7 KB, 54 views)</span>
							
						</a>
					</li>
				
			</ul>
		</div>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608608 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608608 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608608 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608609 data-node-publishdate=1333730698 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608609 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608609%23post608609" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608609#post608609" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=CCLRHost+Class%3A+Hosting+the+Common+Language+Runtime&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608609%23post608609" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608609">#7</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T09:44:58>6 Apr 2012, 12:44 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								CCLRHost Class: Hosting the Common Language Runtime<br/>
<br/>
<b>CCLRHost</b> is a class designed to host the .NET Common Language Runtime (CLR) in a PowerBASIC application and create and unwrap an instance of a COM visible .NET class whose methods and properties can be called using the PowerBASIC COM Automation statements.<br/>
<br/>
The folliwing example hosts the .NET 4 runtime in a PowerBASIC application, creates an instance of the System.Collections.Stack collection and calls its Push and Pop methods.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">#COMPILE EXE
#DIM ALL
#INCLUDE ONCE "windows.inc"
#INCLUDE ONCE "CCLRHost.inc"

FUNCTION PBMAIN () AS LONG

   LOCAL pCLRHost AS ICLRHost
   LOCAL oStack AS DISPATCH
   LOCAL vRes AS VARIANT
   LOCAL vPrm AS VARIANT
   LOCAL bstrOutput AS WSTRING

   ' // Create an instance of the CCLRHost class
   pCLRHost = NewCLR4Host("v4.0.30319")   ' --&gt; change version number if needed
   IF ISNOTHING(pCLRHost) THEN EXIT FUNCTION

   ' // Create an instance of the Stack collection
   oStack = pCLRHost.CreateInstance("mscorlib", "System.Collections.Stack")
   IF ISOBJECT(oStack) THEN
      ' Push and Pop some strings
      vPrm = "rocks!"
      OBJECT CALL oStack.Push(vPrm)
      vPrm = "PB"
      OBJECT CALL oStack.Push(vPrm)
      OBJECT CALL oStack.Pop TO vRes
      bstrOutput = VARIANT$$(vRes)
      OBJECT CALL oStack.Pop TO vRes
      bstrOutput += " " & VARIANT$$(vRes)
      MSGBOX bstrOutput
      oStack = NOTHING
   END IF

   pCLRHost = NOTHING

END FUNCTION</pre>
</div>Same as above, but using the .NET 2 runtime.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">#INCLUDE "CCLRHost.inc"

' ========================================================================================
' Main
' ========================================================================================
FUNCTION PBMAIN () AS LONG

   LOCAL pCLRHost AS ICLRHost
   LOCAL oStack AS DISPATCH
   LOCAL vRes AS VARIANT
   LOCAL vPrm AS VARIANT
   LOCAL bstrOutput AS WSTRING

   ' // Create an instance of the CCLRHost class
   pCLRHost = NewCLRHost("v2.0.50727", "wks")
   IF ISNOTHING(pCLRHost) THEN EXIT FUNCTION

   ' // Create an instance of the Stack collection
   oStack = pCLRHost.CreateInstance("mscorlib", "System.Collections.Stack")
   IF ISOBJECT(oStack) THEN
      ' Push and Pop some strings
      vPrm = "rocks!"
      OBJECT CALL oStack.Push(vPrm)
      vPrm = "PB"
      OBJECT CALL oStack.Push(vPrm)
      OBJECT CALL oStack.Pop TO vRes
      bstrOutput = VARIANT$$(vRes)
      OBJECT CALL oStack.Pop TO vRes
      bstrOutput += " " & VARIANT$$(vRes)
      MSGBOX bstrOutput
      oStack = NOTHING
   END IF

   pCLRHost = NOTHING

END FUNCTION
' ========================================================================================</pre>
</div>The following version allows to use your own domain, instead of the default domain.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">#INCLUDE "CCLRHost.inc"

' ========================================================================================
' Main
' ========================================================================================
FUNCTION PBMAIN () AS LONG

   LOCAL pCLRHost AS ICLRHost
   LOCAL pDomain AS SystemAppDomain

   LOCAL oStack AS DISPATCH
   LOCAL vRes AS VARIANT
   LOCAL vPrm AS VARIANT
   LOCAL bstrOutput AS WSTRING

   ' // Create and instance of the CCLRHost class and initialize it
   pCLRHost = NewCLRHost("v2.0.50727", "wks")
   IF ISNOTHING(pCLRHost) THEN EXIT FUNCTION

   ' // Create a custom domain
   pDomain = pCLRHost.CreateDomain("MyDomain")

   ' // Create an instance of the Stack collection
   oStack = pCLRHost.CreateInstance2(pDomain, "mscorlib", "System.Collections.Stack")
   IF ISOBJECT(oStack) THEN
      ' // Push and Pop some strings
      vPrm = "rocks!"
      OBJECT CALL oStack.Push(vPrm)
      vPrm = "PB"
      OBJECT CALL oStack.Push(vPrm)
      OBJECT CALL oStack.Pop TO vRes
      bstrOutput = VARIANT$$(vRes)
      OBJECT CALL oStack.Pop TO vRes
      bstrOutput += " " & VARIANT$$(vRes)
      MSGBOX bstrOutput
      oStack = NOTHING
   END IF

   pCLRHost.UnloadDomain(pDomain)

   pDomain = NOTHING
   pCLRHost = NOTHING

END FUNCTION
' ========================================================================================</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608609 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608609 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608609 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608610 data-node-publishdate=1333730870 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608610 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608610%23post608610" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608610#post608610" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=Hosting+VBScript+in+your+PowerBASIC+application&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608610%23post608610" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608610">#8</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T09:47:50>6 Apr 2012, 12:47 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								Hosting VBScript in your PowerBASIC application<br/>
<br/>
This example is based i the following Microsoft article:<br/>
<a href="http://support.microsoft.com/kb/223139/en-us" target=_blank rel=nofollow>http://support.microsoft.com/kb/223139/en-us</a><br/>
<br/>
MSDN documentation about the IActiveScriptSite interface:<br/>
<a href="http://msdn.microsoft.com/en-us/library/z70w3w6a%28VS.94%29.aspx" target=_blank rel=nofollow>http://msdn.microsoft.com/en-us/libr...8VS.94%29.aspx</a><br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' Hosting VBScript in your PowerBASIC application
' Copyright (c) 2012 Jos√© Roca. Freeware. Use at your own risk.
' THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER
' EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
' MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE.
' ########################################################################################

' ========================================================================================
' The basic work flow is as follows:
' 1. You start the VBScript engine, vbscript.dll, and obtain IActiveScript and
'    IActiveScriptParse interfaces.
' 2. You give the VBScript engine your implementation of IActiveScriptSite, which the
'    engine uses later to obtain and call to your objects.
' 3. You add the objects that you implement and want to make available to scripts by
'    calling IActiveScript.AddNamedItem().
' 4. You provide the script text to execute through IActiveScriptParse.ParseScriptText().
'    Note that this doesn't actually run the script yet.
' 5. The script engine will now call into your IActiveScriptSite.GetItemInfo() for any
'    objects it doesn't recognize, to get their interface pointers.
' 6. You call IActiveScript.SetScriptState() with SCRIPT_STATE_CONNECTED to run the script.
' 7. The VBScript engine parses the text in the script for you and when it encounters a
'    method call or property reference, it delegates the implementation to your provided
'    interfaces.
' ========================================================================================

#COMPILE EXE
#DIM ALL

'/* header files for imported files */
#INCLUDE ONCE "ActivScp.inc"

' ########################################################################################
' Class MyObject
' Note: We need to declare the class AS COMMON to avoid dead code removal because the
' methods aren't called directly by the code but by the ActiveScript engine.
' ########################################################################################

$IID_CMyObject = GUID$("{F9E4BF70-EFA8-411E-A142-F4B02D89D621}")
$IID_IMyObject = GUID$("{F9E4BF70-EFA8-411E-A142-F4B02D89D622}")

CLASS CMyObject $IID_CMyObject AS COMMON

   INTERFACE IMyObject $IID_IMyObject

   INHERIT IDispatch

   METHOD SayHi (BYVAL bstrTo AS WSTRING)
      ? "Say Hi to " & bstrTo
   END METHOD

   METHOD Sum (BYVAL a AS LONG, BYVAL b AS LONG)
      ? STR$(a) & " +" & STR$(b) & " =" & STR$(a + b) & ", isn't it?"
   END METHOD

   END INTERFACE

END CLASS
' ########################################################################################

' ########################################################################################
' Class CMyScriptSite
' Note: We need to declare the class AS COMMON to avoid dead code removal because the
' methods aren't called directly by the code but by the ActivaScript engine.
' ########################################################################################

$IID_CMyScriptSite = GUID$("{F9E4BF70-EFA8-411E-A142-F4B02D89D620}")

CLASS CMyScriptSite $IID_CMyScriptSite AS COMMON

   INSTANCE m_wszObjectName AS WSTRINGZ * 260
   INSTANCE m_pScriptObjectUnk AS IUnknown

   CLASS METHOD Create
      ' // Creates an instance of our object
      m_pScriptObjectUnk = CLASS "CMyObject"
      m_wszObjectName = "MyObject"
   END METHOD

   CLASS METHOD Destroy
      ' // Releases our object
      m_pScriptObjectUnk = NOTHING
   END METHOD

   ' =====================================================================================
   ' Custom implementation of the IActiveScriptSite interface
   ' =====================================================================================
   INTERFACE IActiveScriptSiteImpl $IID_IActiveScriptSite

      INHERIT IUnknown

      ' ==================================================================================
      ' Retrieves the locale identifier associated with the host's user interface.
      ' ==================================================================================
      METHOD GetLCID (BYREF plcid AS LONG) AS LONG
         METHOD = %S_OK
      END METHOD
      ' ==================================================================================

      ' ==================================================================================
      ' Allows the scripting engine to obtain information about an item added with the
      ' IActiveScript.AddNamedItem method.
      ' ==================================================================================
      METHOD GetItemInfo (BYREF wszName AS WSTRINGZ, BYVAL dwReturnMask AS DWORD, BYREF ppiunkItem AS DWORD, BYREF ppti AS DWORD) AS LONG

         LOCAL IID_CMyScriptSite AS GUID

         ' // Is it expecting an ITypeInfo?
         IF VARPTR(ppti) THEN
            ' // Default to null
            ppti = %NULL
            ' // Return if asking about ITypeInfo...
            IF (dwReturnMask AND %SCRIPTINFO_ITYPEINFO) = %SCRIPTINFO_ITYPEINFO THEN
               METHOD = %TYPE_E_ELEMENTNOTFOUND
               EXIT METHOD
            END IF
         END IF

         ' // Is the engine passing an IUnknown buffer?
         IF VARPTR(ppiunkItem) THEN
            ' // Default to null
            ppiunkItem = %NULL
            ' // Is Script Engine looking for an IUnknown for our object?
            IF (dwReturnMask AND %SCRIPTINFO_IUNKNOWN) = %SCRIPTINFO_IUNKNOWN THEN
               ' // Check for our object name...
               IF wszName = m_wszObjectName THEN
                  ' // Provide our object.
                  ppiunkItem = OBJPTR(m_pScriptObjectUnk)
                  ' // AddRef our object...
                  m_pScriptObjectUnk.AddRef
               END IF
            END IF
         END IF

         METHOD = %S_OK

      END METHOD
      ' ==================================================================================

      ' ==================================================================================
      ' Retrieves a host-defined string that uniquely identifies the current document version.
      ' ==================================================================================
      METHOD GetDocVersionString (BYREF bstrVersion AS WSTRING) AS LONG
         METHOD = %S_OK
      END METHOD
      ' ==================================================================================

      ' ==================================================================================
      ' Informs the host that the script has completed execution.
      ' ==================================================================================
      METHOD OnScriptTerminate (BYREF pvarResult AS VARIANT, BYREF pexcepinfo AS EXCEPINFO) AS LONG
         METHOD = %S_OK
      END METHOD
      ' ==================================================================================

      ' ==================================================================================
      ' Informs the host that the scripting engine has changed states.
      ' ==================================================================================
      METHOD OnStateChange (BYVAL ssScriptState AS DWORD) AS LONG
         METHOD = %S_OK
      END METHOD
      ' ==================================================================================

      ' ==================================================================================
      ' Informs the host that an execution error occurred while the engine was running the script.
      ' ==================================================================================
      METHOD OnScriptError (BYVAL pscripterror AS IActiveScriptError) AS LONG

         LOCAL bstrSourceLine AS WSTRING
         LOCAL ei AS EXCEPINFO
         LOCAL bstrlen AS LONG

         pscripterror.GetSourceLineText bstrSourceLine
         ? "IActiveScriptSite.OnScriptError" & $CRLF & _
            "*** Source line ***" & $CRLF & bstrSourceLine

         LOCAL hr AS LONG
         LOCAL dwSourceContext AS DWORD
         LOCAL ulLineNumber AS DWORD
         LOCAL lCharacterPosition AS LONG
         hr = pscripterror.GetSourcePosition(dwSourceContext, ulLineNumber, lCharacterPosition)
         IF hr = %S_OK THEN
            IF dwSourceContext THEN ? "Source context: " & FORMAT$(dwSourceContext)
            IF ulLineNumber THEN ? "Line number " & FORMAT$(ulLineNumber)
            IF lCharacterPosition THEN ? "Character Position: " & FORMAT$(lCharacterPosition)
         END IF

         ' // Retrieve the error information from EXCEPINFO
         pscripterror.GetExceptionInfo ei
         IF ei.sCode THEN
            ? "Error code: " & FORMAT$(ei.sCode) & " &lt;" & HEX$(ei.scode) & "&gt;"
         END IF
         IF ei.bstrSource THEN
            ? "Error source: " & <a href="https://forum.powerbasic.com/cdn-cgi/l/email-protection" class=__cf_email__ data-cfemail=6a0f03442a08191e1839051f18090f>[email¬†protected]</a>
            SysFreeString ei.bstrSource
         END IF
         IF ei.bstrDescription THEN
            ? "Error description: " & <a href="https://forum.powerbasic.com/cdn-cgi/l/email-protection" class=__cf_email__ data-cfemail=25404c0b654756515761405646574c55514c4a4b>[email¬†protected]</a>
            SysFreeString ei.bstrDescription
         END IF
         IF ei.bstrHelpFile THEN
            ? "Help file: " & <a href="https://forum.powerbasic.com/cdn-cgi/l/email-protection" class=__cf_email__ data-cfemail=2e4b47006e4c5d5a5c664b425e6847424b>[email¬†protected]</a>
            IF ei.dwHelpContext THEN ? "Help context ID: " & FORMAT$(ei.dwHelpContext)
            SysFreeString ei.bstrHelpFile
         END IF

         METHOD = %S_OK

      END METHOD
      ' ==================================================================================

      ' ==================================================================================
      ' Informs the host that the scripting engine has begun executing the script code.
      ' ==================================================================================
      METHOD OnEnterScript () AS LONG
         METHOD = %S_OK
      END METHOD
      ' ==================================================================================

      ' ==================================================================================
      ' Informs the host that the scripting engine has returned from executing script code.
      ' ==================================================================================
      METHOD OnLeaveScript () AS LONG
         METHOD = %S_OK
      END METHOD
      ' ==================================================================================

   END INTERFACE
   ' =====================================================================================

END CLASS
' ########################################################################################


' ########################################################################################
' Main
' ########################################################################################
FUNCTION PBMAIN () AS LONG

   LOCAL hr AS LONG
   LOCAL pMySite AS IActiveScriptSiteImpl
   LOCAL wszObjectName AS WSTRINGZ * 260
   LOCAL wszScript AS WSTRINGZ * 260
   LOCAL ei AS EXCEPINFO

   ' // Create an instance of our script site
   pMySite = CLASS "CMyScriptSite"
   IF ISNOTHING(pMySite) THEN EXIT FUNCTION

   ' // Start inproc script engine, VBSCRIPT.DLL
   LOCAL pIActiveScript AS IActiveScript
   pIActiveScript = NEWCOM CLSID $CLSID_VBScript
   IF ISNOTHING(pIActiveScript) THEN  EXIT FUNCTION

   ' // Get engine's IActiveScriptParse interface
   LOCAL pIActiveScriptParse AS IActiveScriptParse
   pIActiveScriptParse = pIActiveScript
   IF ISNOTHING(pIActiveScriptParse) THEN  EXIT FUNCTION

   ' // Give the engine our IActiveScriptSite interface...
   hr = pIActiveScript.SetScriptSite(pMySite)
   ' // Give the engine a chance to initialize itself...
   hr = pIActiveScriptParse.InitNew
   ' // Add a root-level item to the engine's name space...
   wszObjectName = "MyObject"
   hr = pIActiveScript.AddNamedItem(wszObjectName, %SCRIPTITEM_ISVISIBLE OR %SCRIPTITEM_ISSOURCE)
   wszScript = "Sum 2,3" & $CRLF & _
               "SayHi(" & $DQ & "Active Scripting" & $DQ & ")"
   hr = pIActiveScriptParse.ParseScriptText(wszScript, wszObjectName, _
        NOTHING, "", 0, 0, 0, BYVAL %NULL, ei)
   ' // Set the engine state. This line actually triggers the execution of the script.
   hr = pIActiveScript.SetScriptState(%SCRIPTSTATE_CONNECTED)

   ' // Close script and release interfaces...
   pIActiveScript.Close
   pIActiveScriptParse = NOTHING
   pIActiveScript = NOTHING
   pMySite = NOTHING

   #IF %DEF(%PB_CC32)
   WAITKEY$
   #ENDIF

END FUNCTION
' ########################################################################################</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608610 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608610 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608610 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608611 data-node-publishdate=1333731030 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608611 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608611%23post608611" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608611#post608611" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=Internet+Explorer%3A+How+to+get+IWebBrowser2+from+a+HWND&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608611%23post608611" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608611">#9</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T09:50:30>6 Apr 2012, 12:50 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								Internet Explorer: How to get IWebBrowser2 from a HWND<br/>
<br/>
This article shows how to get the <b>IWebBrowser2</b> interface from a <b>HWND</b>. If Microsoft Active Accessibility (MSAA) is installed, you can send the WM_HTML_GETOBJECT message to the document's window (with the window class "Internet Explorer_Server") and then pass the result from <b>SendMessageTimeout</b> to an MSAA function, <b>ObjectFromLresult</b>, to get a fully marshaled <b>IHTMLDocument2</b> pointer. Then you will call the <b>parentWindow</b> property of the <b>IHTMLDocument2</b> interface to retrieve a reference to the <b>IHTMLWindow2</b> interface and call the <b>QueryInterface</b> method to retrieve a reference to the <b>IServiceProvider</b> interface. Finally, you will call the <b>QueryService</b> method of the <b>IServiceProvider</b> interface to retrieve a reference to the <b>IWebBrowser2</b> interface.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' Demonstrates how to get the IWebBrowser2 interface from a HWND. If Microsoft Active
' Accessibility (MSAA) is installed, you can send the WM_HTML_GETOBJECT message to the
' document's window (with the window class "Internet Explorer_Server") and then pass the
' result from SendMessageTimeout to an MSAA function, ObjectFromLresult, to get a fully
' marshaled IHTMLDocument2 pointer. Then you will call the parentWindow property of the
' IHTMLDocument2 interface to retrieve a reference to the IHTMLWindow2 interface and call
' the QueryInterface method to retrieve a reference to the IServiceProvider interface.
' Finally, you will call the QueryService method of the IServiceProvider interface to
' retrieve a reference to the IWebBrowser2 interface.
' ########################################################################################

#COMPILE EXE
#DIM ALL
#INCLUDE "OLEACC.INC"   ' // Accessibility
#INCLUDE "EXDISP.INC"   ' // WebBrowser Control
#INCLUDE "MSHTML.INC"   ' // MSHTML

' ========================================================================================
' Callback for EnumChildWindows
' ========================================================================================
FUNCTION EnumChildProc(BYVAL hwnd AS DWORD, BYVAL lParam AS DWORD PTR) AS LONG
   LOCAL szClassName AS ASCIIZ * %MAX_PATH
   GetClassName (hwnd, szClassName, %MAX_PATH)
   IF szClassName = "Internet Explorer_Server" THEN
      IF lParam &lt;&gt; %NULL THEN @lParam = hWnd
      FUNCTION = %FALSE
   ELSE
      FUNCTION = %TRUE
   END IF
END FUNCTION
' ========================================================================================

' ========================================================================================
' Main
' ========================================================================================
FUNCTION PBMAIN () AS LONG

   LOCAL hr AS LONG                              ' // HRESULT
   LOCAL hWndExplorer AS DWORD                   ' // Internet Explorer handle
   LOCAL hWndChild AS DWORD                      ' // Child window handle
   LOCAL dwMsg AS DWORD                          ' // Message to send
   LOCAL lRes AS DWORD                           ' // Result of the message processing
   LOCAL pIWebBrowser2 AS IWebBrowser2           ' // IWebBrowser2 interface pointer
   LOCAL pIHTMLDocument2 AS IHTMLDocument2       ' // IHTMLDocument2 interface pointer
   LOCAL pIHTMLWindow2 AS IHTMLWindow2           ' // IHTMLWindow2 interface pointer
   LOCAL pIServiceProvider AS IServiceProvider   ' // IServiceProvider interface pointer

   ' Find the window handle of a running instance of Internet Explorer
   hWndExplorer = FindWindow("IEFrame", BYVAL %NULL)
   IF ISFALSE hWndExplorer THEN
      ? "Internet Explorer isn't running"
      EXIT FUNCTION
   END IF
   ' Enumerate its child windows
   EnumChildWindows hWndExplorer, CODEPTR(EnumChildProc), VARPTR(hWndChild)
   IF ISFALSE hWndChild THEN EXIT FUNCTION
   ' Register the WM_HTML_GETOBJECT message
   dwMsg = RegisterWindowMessage("WM_HTML_GETOBJECT")
   IF ISFALSE dwMsg THEN EXIT FUNCTION
   ' Send a mensage to get an LRESULT
   SendMessageTimeout hWndChild, dwMsg, 0, 0, %SMTO_ABORTIFHUNG, 1000, lRes
   IF ISFALSE lRes THEN EXIT FUNCTION
   ' Retrieve a reference to the IHTMLDocument2 interface from the LRESULT
   hr = ObjectFromLresult(lRes, $IID_IHTMLDocument2, 0, pIHTMLDocument2)
   IF ISNOTHING(pIHTMLDocument2) THEN EXIT FUNCTION
   ' Get a reference to the IHTMLWindow2 interface for the parent window
   pIHTMLWindow2 = pIHTMLDocument2.parentWindow
   IF ISNOTHING(pIHTMLWindow2) THEN EXIT FUNCTION
   ' Retrieve a reference to the IServiceProvider interface
   pIServiceProvider = pIHTMLWindow2
   IF ISNOTHING(pIServiceProvider) THEN EXIT FUNCTION
   ' Retrieve a reference to the IWebBrowser2 interface
   pIServiceProvider.QueryService($IID_IWebBrowserApp, $IID_IWebBrowser2, pIWebBrowser2)
   IF ISNOTHING(pIWebBrowser2) THEN EXIT FUNCTION
   ' ==========================================================================
   ' Now you can call the methods and properties of the IWebBrowser2 interface.
   ' ==========================================================================
   ? "pIWebBrowser2 = " & STR$(OBJPTR(pIWebBrowser2))

   #IF %DEF(%PB_CC32)
   WAITKEY$
   #ENDIF

END FUNCTION
' ========================================================================================</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608611 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608611 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608611 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608612 data-node-publishdate=1333731123 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608612 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608612%23post608612" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608612#post608612" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=Internet+Explorer%3A+How+to+get+IHTMLDocument2+from+a+HWND&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608612%23post608612" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608612">#10</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T09:52:03>6 Apr 2012, 12:52 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								Internet Explorer: How to get IHTMLDocument2 from a HWND<br/>
<br/>
<i>Adapted from the Microsoft Knowledge Base article of the same name</i>: <a href="http://support.microsoft.com/kb/249232" target=_blank rel=nofollow>http://support.microsoft.com/kb/249232</a><br/>
<br/>
This article shows how to get the <b>IHTMLDocument2</b> interface from a <b>HWND</b>. If Microsoft Active Accessibility (MSAA) is installed, you can send the WM_HTML_GETOBJECT message to the document's window (with the window class "Internet Explorer_Server") and then pass the result from <b>SendMessageTimeout</b> to an MSAA function, <b>ObjectFromLresult</b>, to get a fully marshaled <b>IHTMLDocument2</b> pointer.<br/>
<br/>
<b>NOTE</b>: Before Internet Explorer 5.5, frames were implemented by hosting a new instance of Shdocvw.dll, and each frame had a separate window associated with it. Internet Explorer 5.5 implements native frames for better performance, and all frames are rendered by the same instance of Shdocvw.dll. Since there will not be a HWND for each frame for Internet Explorer 5.5 and later, the sample code described in this section will work to get to the document of the main window only. You can still get to each frame's document by using the frames collection of the main document.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' Adapted from the following Microsoft Knowledge Base article: http://support.microsoft.com/kb/249232
' Demonstrates how to get the IHTMLDocument2 interface from a HWND. If Microsoft Active
' Accessibility (MSAA) is installed, you can send the WM_HTML_GETOBJECT message to the
' document's window (with the window class "Internet Explorer_Server") and then pass the
' result from SendMessageTimeout to an MSAA function, ObjectFromLresult, to get a fully
' marshaled IHTMLDocument2 pointer.
' ########################################################################################

#COMPILE EXE
#DIM ALL
#INCLUDE "OLEACC.INC"   ' // Accessibility
#INCLUDE "EXDISP.INC"   ' // WebBrowser Control
#INCLUDE "MSHTML.INC"   ' // MSHTML

' ========================================================================================
' Callback for EnumChildWindows
' ========================================================================================
FUNCTION EnumChildProc(BYVAL hwnd AS DWORD, BYVAL lParam AS DWORD PTR) AS LONG
   LOCAL szClassName AS ASCIIZ * %MAX_PATH
   GetClassName (hwnd, szClassName, %MAX_PATH)
   IF szClassName = "Internet Explorer_Server" THEN
      IF lParam &lt;&gt; %NULL THEN @lParam = hWnd
      FUNCTION = %FALSE
   ELSE
      FUNCTION = %TRUE
   END IF
END FUNCTION
' ========================================================================================

' ========================================================================================
' Main
' ========================================================================================
FUNCTION PBMAIN () AS LONG

   LOCAL hr AS LONG                              ' // HRESULT
   LOCAL hWndExplorer AS DWORD                   ' // Internet Explorer handle
   LOCAL hWndChild AS DWORD                      ' // Child window handle
   LOCAL dwMsg AS DWORD                          ' // Message to send
   LOCAL lRes AS DWORD                           ' // Result of the message processing
   LOCAL pIHTMLDocument2 AS IHTMLDocument2       ' // IHTMLDocument2 interface pointer

   ' Find the window handle of a running instance of Internet Explorer
   hWndExplorer = FindWindow("IEFrame", BYVAL %NULL)
   IF ISFALSE hWndExplorer THEN
      ? "Internet Explorer isn't running"
      EXIT FUNCTION
   END IF
   ' Enumerate its child windows
   EnumChildWindows hWndExplorer, CODEPTR(EnumChildProc), VARPTR(hWndChild)
   IF ISFALSE hWndChild THEN EXIT FUNCTION
   ' Register the WM_HTML_GETOBJECT message
   dwMsg = RegisterWindowMessage("WM_HTML_GETOBJECT")
   IF ISFALSE dwMsg THEN EXIT FUNCTION
   ' Send a mensage to get an LRESULT
   SendMessageTimeout hWndChild, dwMsg, 0, 0, %SMTO_ABORTIFHUNG, 1000, lRes
   IF ISFALSE lRes THEN EXIT FUNCTION
   ' Retrieve a reference to the IHTMLDocument2 interface from the LRESULT
   hr = ObjectFromLresult(lRes, $IID_IHTMLDocument2, 0, pIHTMLDocument2)
   IF ISNOTHING(pIHTMLDocument2) THEN EXIT FUNCTION
   ' Change the background color of the document to red
   pIHTMLDocument2.bgColor = "red"
   ' Cleanup
   pIHTMLDocument2 = NOTHING
   ? "Web page background color changed to red"
   #IF %DEF(%PB_CC32)
   WAITKEY$
   #ENDIF

END FUNCTION
' ========================================================================================</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608612 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608612 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608612 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608614 data-node-publishdate=1333731983 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608614 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608614%23post608614" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608614#post608614" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=Hosting+Windows+Explorer+in+your+application&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608614%23post608614" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608614">#11</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T10:06:23>6 Apr 2012, 01:06 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								Hosting Windows Explorer in your application<br/>
<br/>
<b>Requires Vista or Windows 7.</b><br/>
<br/>
The Explorer Browser object allows developers to host Windows Explorer in their applications.<br/>
<br/>
This is a minimal example. You can also sink to an event class and receive the following events: OnNavigationPending, OnViewCreated, OnNavigationComplete, OnNavigationFailed.<br/>
<br/>
You can also add a toolbar or menu and, in the %WM_COMMAND message, perform one of these actions:<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">CASE %IDC_PREVIOUSFOLDER
   peb.BrowseToIDList(NULL, %SBSP_PARENT)
CASE %IDC_BACK
   peb.BrowseToIDList(NULL, %SBSP_NAVIGATEBACK)
CASE %IDC_FORWARD
   peb.BrowseToIDList(NULL, %SBSP_NAVIGATEFORWARD)</pre>
</div>There are some more options that I haven't yet explored. See:<br/>
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb761909%28v=vs.85%29.aspx" target=_blank rel=nofollow>http://msdn.microsoft.com/en-us/libr...=vs.85%29.aspx</a><br/>
<br/>
<b>The example (DDT Version)</b>:<br/>
<br/>
This example fills the entire client area of the dialog with Explorer, but you can choose the area where to display it passing the wanted position and size with peb.SetRect.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">#COMPILE EXE
#DIM ALL
#COMPILER PBWIN 10

' // Include files for external files
#INCLUDE ONCE "ShlObj.inc"
#INCLUDE ONCE "ShObjIdl.inc"

GLOBAL peb AS IExplorerBrowser

' ========================================================================================
' Main
' ========================================================================================
FUNCTION PBMAIN () AS LONG

   ' // Create the dialog
   LOCAL hDlg AS DWORD
   DIALOG NEW PIXELS, 0, "IExplorerBrowser interface test", , , 500, 320, %WS_SYSMENU TO hDlg

   ' // Create an instance of IExplorerBrowser
   peb = NEWCOM CLSID $CLSID_ExplorerBrowser
   IF ISOBJECT(peb) THEN
      peb.SetOptions(%EBO_SHOWFRAMES)
      LOCAL fs AS FOLDERSETTINGS
      fs.ViewMode = %FVM_DETAILS
      LOCAL rc AS RECT
      GetClientRect hDlg, rc
      peb.Initialize(hDlg, rc, fs)
      ' // Navigate to the Profile folder
      LOCAL pidlBrowse AS DWORD
      IF SUCCEEDED(SHGetFolderLocation(%NULL, %CSIDL_PROFILE, %NULL, 0, pidlBrowse)) THEN
         peb.BrowseToIDList(pidlBrowse, 0)
         ILFree(pidlBrowse)
      END IF
   END IF

   ' // Display and activate the dialog
   DIALOG SHOW MODAL hDlg, CALL DlgProc

   ' // Destroy the instance of the Explorer browser
   IF ISOBJECT(peb) THEN peb.Destroy

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main callback function.
' ========================================================================================
CALLBACK FUNCTION DlgProc() AS LONG

   ' // Process window mesages
   SELECT CASE CB.MSG

      CASE %WM_SIZE
         ' // If the window isn't minimized, resize it
         IF CB.WPARAM &lt;&gt; %SIZE_MINIMIZED THEN
            ' // Resize the explorer browser
            LOCAL rc AS RECT
            GetClientRect CB.HNDL, rc
            IF ISOBJECT(peb) THEN peb.SetRect(BYVAL %NULL, rc)
         END IF

   END SELECT

END FUNCTION
' ========================================================================================</pre>
</div><b>The example (CWindow Version)</b>:<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">#COMPILE EXE
#DIM ALL
%UNICODE = 1

' // Include files for external files
#INCLUDE ONCE "CWindow.inc"   ' // CWindow class
#INCLUDE ONCE "ShlObj.inc"
#INCLUDE ONCE "ShObjIdl.inc"

GLOBAL peb AS IExplorerBrowser

' ========================================================================================
' Main
' ========================================================================================
FUNCTION WinMain (BYVAL hInstance AS DWORD, BYVAL hPrevInstance AS DWORD, BYVAL lpszCmdLine AS WSTRINGZ PTR, BYVAL nCmdShow AS LONG) AS LONG

   ' // Set process DPI aware
   SetProcessDPIAware

   ' // Create an instance of the class
   LOCAL pWindow AS IWindow
   pWindow = CLASS "CWindow"
   IF ISNOTHING(pWindow) THEN EXIT FUNCTION

   ' // Create the main window
   ' // Note: CW_USEDEFAULT is used as the default value When passing 0's as the width and height
   pWindow.CreateWindow(%NULL, "IExplorerBrowser interface test", 0, 0, 0, 0, 0, 0, CODEPTR(WindowProc))
   ' // Set the client size
   pWindow.SetClientSize 500, 320
   ' // Center the window
   pWindow.CenterWindow

   ' // Create an instance of IExplorerBrowser
   peb = NEWCOM CLSID $CLSID_ExplorerBrowser
   IF ISOBJECT(peb) THEN
      peb.SetOptions(%EBO_SHOWFRAMES)
      LOCAL fs AS FOLDERSETTINGS
      fs.ViewMode = %FVM_DETAILS
      LOCAL rc AS RECT
      GetClientRect pWindow.hwnd, rc
      peb.Initialize(pWindow.hwnd, rc, fs)
      ' // Navigate to the Profile folder
      LOCAL pidlBrowse AS DWORD
      IF SUCCEEDED(SHGetFolderLocation(%NULL, %CSIDL_PROFILE, %NULL, 0, pidlBrowse)) THEN
         peb.BrowseToIDList(pidlBrowse, 0)
         ILFree(pidlBrowse)
      END IF
   END IF

   ' // Default message pump (you can replace it with your own)
   pWindow.DoEvents(nCmdShow)

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main callback function.
' ========================================================================================
FUNCTION WindowProc (BYVAL hwnd AS DWORD, BYVAL uMsg AS DWORD, BYVAL wParam AS DWORD, BYVAL lParam AS LONG) AS LONG

   ' // Process window mesages
   SELECT CASE uMsg

      CASE %WM_COMMAND
         SELECT CASE LO(WORD, wParam)
            CASE %IDCANCEL
               ' // If the Escape key has been pressed...
               IF HI(WORD, wParam) = %BN_CLICKED THEN
                  ' // ... close the application by sending a WM_CLOSE message
                  SendMessage hwnd, %WM_CLOSE, 0, 0
                  EXIT FUNCTION
               END IF
         END SELECT

      CASE %WM_SIZE
         ' // If the window isn't minimized, resize it
         IF wParam &lt;&gt; %SIZE_MINIMIZED THEN
            ' // Resize the explorer browser
            LOCAL rc AS RECT
            GetClientRect hwnd, rc
            IF ISOBJECT(peb) THEN peb.SetRect(BYVAL %NULL, rc)
         END IF

      CASE %WM_DESTROY
         ' // Destroy the instance of the Explorer browser
         IF ISOBJECT(peb) THEN peb.Destroy
         ' // End the application
         PostQuitMessage 0
         EXIT FUNCTION

   END SELECT

   ' // Pass unprocessed messages to Windows
   FUNCTION = DefWindowProc(hwnd, uMsg, wParam, lParam)

END FUNCTION
' ========================================================================================</pre>
</div>
		<div class="js-post-attachments b-post-attachments h-clearfix">
			Attached Files
			<ul>
				
					
						
					

					
					
						
						
						
						
							
						
					


					<li class="b-post-attachments__item h-left">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727834">
							
								
									
								
								<img src="resources/fetch1.png" title="Click image for larger version

Name:	ExplorerBrowser_01.PNG
Views:	408
Size:	83.8 KB
ID:	727834" alt="Click image for larger version

Name:	ExplorerBrowser_01.PNG
Views:	408
Size:	83.8 KB
ID:	727834" class=js-lightbox data-fullsize-url="filedata/fetch?id=727834&amp;type=thumb" data-thumb-url="filedata/fetch?id=727834&amp;type=thumb" data-title="Click on the image to see the original version"/>
							
						</a>
					</li>
				
			</ul>
		</div>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608614 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608614 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608614 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608615 data-node-publishdate=1333733076 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608615 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608615%23post608615" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608615#post608615" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=DirectShow%3A+Enumerating+Filters&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608615%23post608615" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608615">#12</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T10:24:36>6 Apr 2012, 01:24 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								DirectShow: Enumerating Filters<br/>
<br/>
The Filter Graph Manager supports the IFilterGraph.EnumFilters method, which enumerates all the filters in the filter graph. It returns a pointer to the IEnumFilters interface. The IEnumFilters.Next method retrieves IBaseFilter interface pointers.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' DirectShow example.
' Enumerating filters.
' ########################################################################################

' CSED_PBCC - Use the PBCC compiler
#COMPILE EXE
#DIM ALL
#INCLUDE ONCE "dshow.inc"
#INCLUDE ONCE "ole2utils.inc"   ' For IUnknown_Release

' ========================================================================================
' The Filter Graph Manager supports the IFilterGraph.EnumFilters method, which enumerates
' all the filters in the filter graph. It returns a pointer to the IEnumFilters interface.
' The IEnumFilters.Next method retrieves IBaseFilter interface pointers.
' ========================================================================================
FUNCTION EnumFilters (BYVAL pGraph AS IGraphBuilder) AS LONG

   LOCAL hr AS LONG                    ' HRESULT
   LOCAL pEnum AS IEnumFilters         ' IEnumFilters interface
   LOCAL pFilter AS IBaseFilter        ' IBaseFilter interface
   LOCAL cFetched AS DWORD             ' Number of filters fetched
   LOCAL FilterInfo AS FILTER_INFO     ' FILTER_INFO structure

   hr = pGraph.EnumFilters(pEnum)
   IF hr &lt;&gt; %S_OK THEN
      FUNCTION = hr
      EXIT FUNCTION
   END IF

   DO
      hr = pEnum.Next(1, pFilter, cFetched)
      IF hr &lt;&gt; %S_OK OR cFetched = 0 THEN EXIT DO
      RESET FilterInfo
      hr = pFilter.QueryFilterInfo(FilterInfo)
      IF hr &lt;&gt; %S_OK THEN
         STDOUT "Could not get the filter info"
      ELSE
         STDOUT FilterInfo.achName
         ' The FILTER_INFO structure holds a pointer to the Filter Graph
         ' Manager, with a reference count that must be released.
         IF FilterInfo.pGraph &lt;&gt; %NULL THEN IUnknown_Release FilterInfo.pGraph
      END IF
      ' Release the filter
      pFilter = NOTHING
   LOOP

   ' Release the collection
   pEnum = NOTHING

   FUNCTION = %S_OK

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main
' ========================================================================================
FUNCTION PBMAIN

   LOCAL pGraph AS IGraphBuilder
   LOCAL wszFile AS WSTRINGZ * %MAX_PATH

   pGraph = NEWCOM CLSID $CLSID_FilterGraph
   wszFile = EXE.Path$ & "useglue.wmv"
   pGraph.RenderFile(wszFile)
   EnumFilters(pGraph)
   pGraph = NOTHING

   WAITKEY$

END FUNCTION
' ========================================================================================</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608615 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608615 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608615 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608616 data-node-publishdate=1333733561 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608616 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608616%23post608616" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608616#post608616" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=DirectShow%3A+Play+Clip&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608616%23post608616" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608616">#13</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T10:32:41>6 Apr 2012, 01:32 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								DirectShow: Play Clip<br/>
<br/>
Allows to select a video clip and plays it.<br/>
<br/>
<b>CWindow version:</b><br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ========================================================================================
' DirectShow example.
' Allows to select a video clip and plays it.
' Based on an example by Vladimir Shulakov posted in the PowerBASIC forums:
' http://www.powerbasic.com/support/pbforums/showthread.php?t=23966
' ========================================================================================

' CSED_PBWIN - Use the PBWIN compiler
#COMPILE EXE
#DIM ALL
%UNICODE = 1

#INCLUDE ONCE "CWindow.inc"
#INCLUDE ONCE "commdlg.inc"
#INCLUDE ONCE "dshow.inc"

' Menu identifiers
%ID_FILE_OPENCLIP = 40001
%ID_FILE_EXIT     = 40002

' Custom message
%WM_GRAPHNOTIFY   = %WM_USER + 13

GLOBAL bIsPlaying AS LONG

' Interface pointers
GLOBAL pIGraphBuilder AS IGraphBuilder
GLOBAL pIMediaControl AS IMediaControl
GLOBAL pIMediaEventEx AS IMediaEventEx
GLOBAL pIVideoWindow  AS IVideoWindow

' ========================================================================================
' Play the movie inside the window.
' ========================================================================================
SUB PlayMovieInWindow (BYVAL hwnd AS DWORD, BYREF wszFileName AS WSTRINGZ)

   LOCAL hr AS LONG

   ' If there is a clip loaded, stop it
   IF ISOBJECT(pIMediaControl) THEN
      pIMediaControl.Stop
      pIMediaControl = NOTHING
      pIVideoWindow = NOTHING
      pIMediaEventEx = NOTHING
      pIGraphBuilder = NOTHING
   END IF

   ' Create an instance of the IGraphBuilder object
   pIGraphBuilder = NEWCOM CLSID $CLSID_FilterGraph
   IF hr &lt;&gt; %S_OK OR ISNOTHING(pIGraphBuilder) THEN EXIT SUB

   ' Retrieve interafce pointers
   pIMediaControl = pIGraphBuilder
   IF ISNOTHING(pIMediaControl) THEN EXIT SUB
   pIMediaEventEx = pIGraphBuilder
   IF ISNOTHING(pIMediaEventEx) THEN EXIT SUB
   pIVideoWindow = pIGraphBuilder
   IF ISNOTHING(pIVideoWindow) THEN EXIT SUB

   ' Render the file
   hr = pIGraphBuilder.RenderFile(wszFileName)
   IF hr &lt;&gt; %S_OK THEN EXIT SUB

   ' Set the window owner and style
   pIVideoWindow.Visible = %OAFALSE
   pIVideoWindow.Owner = hwnd
   pIVideoWindow.WindowStyle = %WS_CHILD OR %WS_CLIPSIBLINGS OR %WS_CLIPCHILDREN

   ' Have the graph signal event via window callbacks for performance
   pIMediaEventEx.SetNotifyWindow(hwnd, %WM_GRAPHNOTIFY, 0)

   ' Set the window position
   LOCAL rc AS RECT
   GetClientRect hwnd, rc
   pIVideoWindow.SetWindowPosition(rc.Left, rc.Top, rc.Right, rc.Bottom)
   ' Make the window visible
   pIVideoWindow.Visible = %OATRUE

   ' Run the graph
   pIMediaControl.Run
   bIsPlaying = %TRUE

END SUB
' ========================================================================================

' ========================================================================================
' Main
' ========================================================================================
FUNCTION WinMain (BYVAL hInstance AS DWORD, BYVAL hPrevInstance AS DWORD, BYVAL lpszCmdLine AS WSTRINGZ PTR, BYVAL nCmdShow AS LONG) AS LONG

   ' // Set process DPI aware
   SetProcessDPIAware

   ' // Create an instance of the class
   LOCAL pWindow AS IWindow
   pWindow = CLASS "CWindow"
   IF ISNOTHING(pWindow) THEN EXIT FUNCTION

   ' // Create the main window
   ' // Note: CW_USEDEFAULT is used as the default value When passing 0's as the width and height
   pWindow.CreateWindow(%NULL, "DirectShow Demo", 0, 0, 0, 0, 0, 0, CODEPTR(WindowProc))
   ' // Set the client size
   pWindow.SetClientSize 500, 320
   ' // Center the window
   pWindow.CenterWindow

   LOCAL hMenu AS DWORD
   LOCAL hMenuFile AS DWORD
   hMenu = CreateMenu
   hMenuFile = CreatePopUpMenu
   AppendMenu hMenu, %MF_POPUP OR %MF_ENABLED, hMenuFile, "&File"
   AppendMenu hMenuFile, %MF_ENABLED, %ID_FILE_OPENCLIP, "&Open clip..."
   AppendMenu hMenuFile, %MF_ENABLED, %ID_FILE_EXIT, "E&xit"
   SetMenu pWindow.hwnd, hMenu

   ' // Default message pump (you can replace it with your own)
   pWindow.DoEvents(nCmdShow)

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main Window procedure
' ========================================================================================
FUNCTION WindowProc (BYVAL hwnd AS DWORD, BYVAL wMsg AS DWORD, BYVAL wParam AS DWORD, BYVAL lParam AS LONG) AS LONG

   LOCAL hDC AS DWORD
   LOCAL rc AS RECT
   LOCAL strFilter AS WSTRING
   LOCAL strDefExt AS WSTRING
   LOCAL strFileName AS WSTRING

   SELECT CASE wMsg

      CASE %WM_COMMAND

         SELECT CASE LO(WORD, wParam)

            CASE %IDCANCEL, %ID_FILE_EXIT
               IF HI(WORD, wParam) = %BN_CLICKED AND bIsPlaying = 0 THEN
                  SendMessage hwnd, %WM_CLOSE, 0, 0
                  FUNCTION = 0
                  EXIT FUNCTION
               END IF

            CASE %ID_FILE_OPENCLIP
               IF HI(WORD, wParam) = %BN_CLICKED THEN
                  strFilter = CHR$("Video Files (*.MPG;*MPEG;*.AVI;*.MOV;*.QT;*.WMV)", 0, "*.MPG;*.MPEG;*.AVI;*.MOV;*.QT;*.WMV", 0)
                  DISPLAY OPENFILE hwnd, 0, 0, "", "", strFilter, "", "", %OFN_EXPLORER OR %OFN_FILEMUSTEXIST TO strFileName
                  IF LEN(strFileName) THEN PlayMovieInWindow(hwnd, BYCOPY strFileName)
               END IF

         END SELECT

      CASE %WM_GRAPHNOTIFY

         LOCAL lEventCode AS LONG
         LOCAL lParam1 AS LONG
         LOCAL lParam2 AS LONG

         IF ISOBJECT(pIMediaEventEx) THEN
            DO
               pIMediaEventEx.GetEvent(lEventCode, lParam1, lParam2, 0)
               IF OBJRESULT &lt;&gt; %S_OK THEN EXIT DO
               pIMediaEventEx.FreeEventParams(lEventCode, lParam1, lParam2)
               IF lEventCode = %EC_COMPLETE THEN
                  IF ISOBJECT(pIVideoWindow) THEN
                     pIVideoWindow.Visible = %OAFALSE
                     pIVideoWindow.Owner = %NULL
                     pIVideoWindow = NOTHING
                  END IF
                  pIMediaControl = NOTHING
                  pIMediaEventEx = NOTHING
                  pIGraphBuilder = NOTHING
                  bIsPlaying = %FALSE
                  EXIT DO
               END IF
            LOOP
         END IF

      CASE %WM_SIZE
         GetClientRect hwnd, rc
         IF ISOBJECT(pIVideoWindow) THEN
            pIVideoWindow.SetWindowPosition(rc.Left, rc.Top, rc.Right, rc.Bottom)
            RedrawWindow hwnd, rc, 0, %RDW_INVALIDATE OR %RDW_UPDATENOW
         END IF

      CASE %WM_ERASEBKGND
         IF bIsPlaying = %FALSE THEN
            hDC = wParam
            GetClientRect hwnd, rc
            FillRect hDC, rc, GetStockObject(%BLACK_BRUSH)
            FUNCTION = %TRUE
            EXIT FUNCTION
         END IF

      CASE %WM_SYSCOMMAND
         ' Capture this message and send a WM_CLOSE message
         IF (wParam AND &HFFF0) = %SC_CLOSE THEN
            SendMessage hwnd, %WM_CLOSE, 0, 0
            EXIT FUNCTION
         END IF

      CASE %WM_DESTROY
         IF ISOBJECT(pIMediaControl) THEN
            pIMediaControl.Stop
            pIMediaControl = NOTHING
         END IF
         IF ISOBJECT(pIVideoWindow) THEN
            pIVideoWindow.Visible = %OAFALSE
            pIVideoWindow.Owner = %NULL
            pIVideoWindow = NOTHING
         END IF
         pIMediaEventEx = NOTHING
         pIGraphBuilder = NOTHING
         PostQuitMessage 0
         EXIT FUNCTION

   END SELECT

   FUNCTION = DefWindowProc(hwnd, wMsg, wParam, lParam)

END FUNCTION
' ========================================================================================</pre>
</div>
		<div class="js-post-attachments b-post-attachments h-clearfix">
			Attached Files
			<ul>
				
					
						
					

					
					


					<li class="b-post-attachments__item h-left h-clear">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727835">
							
								<span class="b-icon b-icon__doc--gray"></span>
								<span class=h-wordwrap>DSHOW_PlayClip.zip</span>
								
									
								
								<span>(320.9 KB, 45 views)</span>
							
						</a>
					</li>
				
			</ul>
		</div>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608616 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608616 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608616 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608617 data-node-publishdate=1333734003 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608617 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608617%23post608617" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608617#post608617" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=Macromedia+Flash+Player&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608617%23post608617" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608617">#14</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T10:40:03>6 Apr 2012, 01:40 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								Macromedia Flash Player<br/>
<br/>
Demonstrates how to create an instance of the ShockWaveFlash player in a DDT dialog, load and play a movie and setting properties.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' Demonstrates how to create an instance of the ShockWaveFlash player in a DDT dialog,
' load and play a movie and setting properties.
' ########################################################################################

#COMPILE EXE
#DIM ALL
%UNICODE = 1

' // Include files for external files
%USEOLECON = 1                ' // Use OLE container
#INCLUDE ONCE "CWindow.inc"   ' // CWindow class
#INCLUDE ONCE "FLASH9.INC"

%IDC_FLASH = 101

' ========================================================================================
' Main
' ========================================================================================
FUNCTION PBMAIN () AS LONG

   ' // Create the dialog
   LOCAL hDlg AS DWORD
   DIALOG NEW PIXELS, 0, "Macromedia Flash Player 9", , , 450, 250, %WS_OVERLAPPEDWINDOW TO hDlg

   ' // Create an instance of the class
   LOCAL pWindow AS IWindow
   pWindow = CLASS "CWindow"
   IF ISNOTHING(pWindow) THEN EXIT FUNCTION

   ' // Add a MS Calendar control
   LOCAL nWide, nHigh AS LONG
   DIALOG GET CLIENT hDlg TO nWide, nHigh
   LOCAL hCtl AS DWORD
   hCtl = pWindow.AddOCX(hDlg, %IDC_FLASH, "ShockwaveFlash.ShockwaveFlash", "", 0, 0, nWide, nHigh)
   CONTROL SET FOCUS hDlg, %IDC_FLASH

   ' // Get the IDispatch of the control
   LOCAL pFlash AS IShockwaveFlash
   pFlash = OC_GetDispatch(hCtl)
   IF ISOBJECT(pFlash) THEN
      ' // Load the flash video - a full qualified path must be used
      pFlash.Movie = EXE.Path$ & "choudanse7.swf"
      ' // Play the video
      pFlash.Play
      ' ---------------------------------------------------------------------
      ' Example code to set properties
      ' ---------------------------------------------------------------------
      ' // Rotate the video
'            pFlash.SetVariable("_rotation", "10")
      ' // Modify the video transparency
'            pFlash.SetVariable("_alpha", "50")
      ' // Modify the scale and position
      pFlash.SetVariable("_xscale", "50")
      pFlash.SetVariable("_yscale", "50")
      pFlash.SetVariable("_x", "80")
      pFlash.SetVariable("_y", "40")
      ' ---------------------------------------------------------------------
      ' // Release the interface
      pFlash = NOTHING
   END IF

   ' // Display and activate the dialog
   DIALOG SHOW MODAL hDlg, CALL DlgProc

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main Dialog procedure
' ========================================================================================
CALLBACK FUNCTION DlgProc() AS LONG

   SELECT CASE CBMSG

      CASE %WM_COMMAND
         SELECT CASE CB.CTL
            ' ...
            ' ...
         END SELECT

      CASE %WM_SIZE
         IF CB.WPARAM &lt;&gt; %SIZE_MINIMIZED THEN
            ' // Resize the control
            LOCAL nWide, nHigh AS LONG
            DIALOG GET CLIENT CB.HNDL TO nWide, nHigh
            CONTROL SET SIZE CB.HNDL, %IDC_FLASH, nWide, nHigh
         END IF

   END SELECT

END FUNCTION
' ========================================================================================</pre>
</div>
		<div class="js-post-attachments b-post-attachments h-clearfix">
			Attached Files
			<ul>
				
					
						
					

					
					
						
						
						
						
							
						
					


					<li class="b-post-attachments__item h-left">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727837">
							
								
									
								
								<img src="resources/fetch.png" title="Click image for larger version

Name:	EX_DDT_Flash.PNG
Views:	387
Size:	98.8 KB
ID:	727837" alt="Click image for larger version

Name:	EX_DDT_Flash.PNG
Views:	387
Size:	98.8 KB
ID:	727837" class=js-lightbox data-fullsize-url="filedata/fetch?id=727837&amp;type=thumb" data-thumb-url="filedata/fetch?id=727837&amp;type=thumb" data-title="Click on the image to see the original version"/>
							
						</a>
					</li>
				
					
						
					

					
					


					<li class="b-post-attachments__item h-left h-clear">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727836">
							
								<span class="b-icon b-icon__doc--gray"></span>
								<span class=h-wordwrap>EX_DDT_Flash.zip</span>
								
									
								
								<span>(166.0 KB, 34 views)</span>
							
						</a>
					</li>
				
			</ul>
		</div>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608617 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608617 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608617 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608622 data-node-publishdate=1333735092 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608622 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608622%23post608622" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608622#post608622" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=Windows+Media+Pleyer&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608622%23post608622" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608622">#15</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T10:58:12>6 Apr 2012, 01:58 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								Windows Media Pleyer<br/>
<br/>
Demonstrates how to embed the Microsoft Windows Media Player control.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' Demonstrates how to embed the Microsoft Windows Media Player control
' ########################################################################################

#COMPILE EXE
#DIM ALL
%UNICODE = 1
%USEOLECON = 1

' // Include files for external files
#INCLUDE ONCE "CWindow.inc"   ' // CWindow class
#INCLUDE ONCE "olecon.inc"    ' // Ole Container
#INCLUDE ONCE "WMP.inc"       ' // Windows Media Player

' // Identifier
%IDC_WMP = 101

' ########################################################################################
' Main
' ########################################################################################
FUNCTION WinMain (BYVAL hInstance AS DWORD, BYVAL hPrevInstance AS DWORD, BYVAL lpszCmdLine AS WSTRINGZ PTR, BYVAL nCmdShow AS LONG) AS LONG

   ' // Make the application High DPI aware
'   SetProcessDPIAware

   ' // Create an instance of the class
   LOCAL pWindow AS IWindow
   pWindow = CLASS "CWindow"
   IF ISNOTHING(pWindow) THEN EXIT FUNCTION

   ' // Create the main window
   pWindow.CreateWindow(%NULL, "Windows Media Player", 0, 0, 0, 0, 0, 0, CODEPTR(WindowProc))
   ' // Set the client size
   pWindow.SetClientSize 400, 320
   ' // Center the window
   pWindow.CenterWindow

   ' // Display a Windows Media Player video
   LOCAL hWMP AS DWORD
   hWMP = pWindow.AddOCX(pWindow.hwnd, %IDC_WMP, "WMPlayer.OCX", "", 0, 0, pWindow.ClientWidth, pWindow.ClientHeight)
   ' // Set the focus in the control
   SetFocus hWMP
   ' // Get a pointer to the IWMPPlayer4 interface
   LOCAL pIWMPPlayer4 AS IWMPPlayer4
   pIWMPPlayer4 = OC_GetDispatch(hWMP)
   ' // Connect events
   IF ISOBJECT(pIWMPPlayer4) THEN
      LOCAL pWMPOCXEvents AS WMPOCXEventsImpl
      pWMPOCXEvents = CLASS "CWMPOCXEvents"
      IF ISOBJECT(pWMPOCXEvents) THEN OC_Advise(hWMP, pWMPOCXEvents, GUID$("{6BF52A51-394A-11D3-B153-00C04F79FAA6}"))
      ' // Set the URL
      pIWMPPlayer4.URL = EXE.Path$ & "Secretarys_***.wmv"
      ' // Play the movie
      pIWMPPlayer4.controls.play
      ' // Release the interface
      pIWMPPlayer4 = NOTHING
   END IF

   ' // Default message pump (you can replace it with your own)
   pWindow.DoEvents(nCmdShow)

END FUNCTION
' ########################################################################################

' ========================================================================================
' Main callback function.
' ========================================================================================
FUNCTION WindowProc (BYVAL hwnd AS DWORD, BYVAL uMsg AS DWORD, BYVAL wParam AS DWORD, BYVAL lParam AS LONG) AS LONG

   STATIC pWindow AS IWindow        ' // Reference to the IWindow interface

   SELECT CASE uMsg

      CASE %WM_CREATE
         ' // Get a reference to the IWindow interface from the CREATESTRUCT structure
         pWindow = CWindow_GetObjectFromCreateStruct(lParam)
         EXIT FUNCTION

      CASE %WM_SYSCOMMAND
         ' // Capture this message and send a WM_CLOSE message
         ' // Note: Needed with some OCXs, that otherwise remain in memory
         IF (wParam AND &HFFF0) = %SC_CLOSE THEN
            SendMessage hwnd, %WM_CLOSE, 0, 0
            EXIT FUNCTION
         END IF

      CASE %WM_COMMAND
         SELECT CASE LO(WORD, wParam)
            CASE %IDCANCEL
               ' // If the Escape key has been pressed...
               IF HI(WORD, wParam) = %BN_CLICKED THEN
                  ' // ... close the application by sending a WM_CLOSE message
                  SendMessage hwnd, %WM_CLOSE, 0, 0
                  EXIT FUNCTION
               END IF
         END SELECT

      CASE %WM_SIZE
         IF wParam &lt;&gt; %SIZE_MINIMIZED THEN
            ' // Resize the control
            pWindow.MoveWindow GetDlgItem(hwnd, %IDC_WMP), 0, 0, pWindow.ClientWidth, pWindow.ClientHeight, %TRUE
         END IF

      CASE %WM_DESTROY
         ' // End the application
         PostQuitMessage 0
         EXIT FUNCTION

   END SELECT

   ' // Pass unprocessed messages to Windows
   FUNCTION = DefWindowProc(hwnd, uMsg, wParam, lParam)

END FUNCTION
' ========================================================================================

' ########################################################################################
' Class CWMPOCXEvents
' Interface name = _WMPOCXEvents
' IID = {6BF52A51-394A-11D3-B153-00C04F79FAA6}
' _WMPOCXEvents: Public interface.
' Attributes = 4112 [&H1010] [Hidden] [Dispatchable]
' Code generated by the TypeLib Browser 4.0.13 (c) 2008 by Jos√© Roca
' Date: 17 dic 2008   Time: 04:21:06
' ########################################################################################

CLASS CWMPOCXEvents GUID$("{E0D086A3-4900-47A6-A2C9-E806B39CD878}") AS EVENT

INTERFACE WMPOCXEventsImpl GUID$("{6BF52A51-394A-11D3-B153-00C04F79FAA6}") AS EVENT

  INHERIT IDispatch

   ' =====================================================================================
   METHOD OpenStateChange &lt;5001&gt; ( _
     BYVAL NewState AS LONG _                           ' [in] NewState VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD PlayStateChange &lt;5101&gt; ( _
     BYVAL NewState AS LONG _                           ' [in] NewState VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD AudioLanguageChange &lt;5102&gt; ( _
     BYVAL LangID AS LONG _                             ' [in] LangID VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD StatusChange &lt;5002&gt;

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD ScriptCommand &lt;5301&gt; ( _
     BYVAL scType AS STRING _                           ' [in] scType VT_BSTR
   , BYVAL Param AS STRING _                            ' [in] Param VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD NewStream &lt;5403&gt;

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD Disconnect &lt;5401&gt; ( _
     BYVAL Result AS LONG _                             ' [in] Result VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD Buffering &lt;5402&gt; ( _
     BYVAL Start AS INTEGER _                           ' [in] Start VT_BOOL &lt;Integer&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD Error &lt;5501&gt;

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD Warning &lt;5601&gt; ( _
     BYVAL WarningType AS LONG _                        ' [in] WarningType VT_I4 &lt;Long&gt;
   , BYVAL Param AS LONG _                              ' [in] Param VT_I4 &lt;Long&gt;
   , BYVAL Description AS STRING _                      ' [in] Description VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD EndOfStream &lt;5201&gt; ( _
     BYVAL Result AS LONG _                             ' [in] Result VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD PositionChange &lt;5202&gt; ( _
     BYVAL oldPosition AS DOUBLE _                      ' [in] oldPosition VT_R8 &lt;Double&gt;
   , BYVAL newPosition AS DOUBLE _                      ' [in] newPosition VT_R8 &lt;Double&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MarkerHit &lt;5203&gt; ( _
     BYVAL MarkerNum AS LONG _                          ' [in] MarkerNum VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD DurationUnitChange &lt;5204&gt; ( _
     BYVAL NewDurationUnit AS LONG _                    ' [in] NewDurationUnit VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CdromMediaChange &lt;5701&gt; ( _
     BYVAL CdromNum AS LONG _                           ' [in] CdromNum VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD PlaylistChange &lt;5801&gt; ( _
     BYVAL Playlist AS IDispatch _                      ' [in] *Playlist VT_DISPATCH &lt;IDispatch&gt;
   , BYVAL change AS LONG _                             ' [in] change WMPPlaylistChangeEventType &lt;enum&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CurrentPlaylistChange &lt;5804&gt; ( _
     BYVAL change AS LONG _                             ' [in] change WMPPlaylistChangeEventType &lt;enum&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CurrentPlaylistItemAvailable &lt;5805&gt; ( _
     BYVAL bstrItemName AS STRING _                     ' [in] bstrItemName VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MediaChange &lt;5802&gt; ( _
     BYVAL Item AS IDispatch _                          ' [in] *Item VT_DISPATCH &lt;IDispatch&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CurrentMediaItemAvailable &lt;5803&gt; ( _
     BYVAL bstrItemName AS STRING _                     ' [in] bstrItemName VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CurrentItemChange &lt;5806&gt; ( _
     BYVAL pdispMedia AS IDispatch _                    ' [in] *pdispMedia VT_DISPATCH &lt;IDispatch&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MediaCollectionChange &lt;5807&gt;

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MediaCollectionAttributeStringAdded &lt;5808&gt; ( _
     BYVAL bstrAttribName AS STRING _                   ' [in] bstrAttribName VT_BSTR
   , BYVAL bstrAttribVal AS STRING _                    ' [in] bstrAttribVal VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MediaCollectionAttributeStringRemoved &lt;5809&gt; ( _
     BYVAL bstrAttribName AS STRING _                   ' [in] bstrAttribName VT_BSTR
   , BYVAL bstrAttribVal AS STRING _                    ' [in] bstrAttribVal VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MediaCollectionAttributeStringChanged &lt;5820&gt; ( _
     BYVAL bstrAttribName AS STRING _                   ' [in] bstrAttribName VT_BSTR
   , BYVAL bstrOldAttribVal AS STRING _                 ' [in] bstrOldAttribVal VT_BSTR
   , BYVAL bstrNewAttribVal AS STRING _                 ' [in] bstrNewAttribVal VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD PlaylistCollectionChange &lt;5810&gt;

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD PlaylistCollectionPlaylistAdded &lt;5811&gt; ( _
     BYVAL bstrPlaylistName AS STRING _                 ' [in] bstrPlaylistName VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD PlaylistCollectionPlaylistRemoved &lt;5812&gt; ( _
     BYVAL bstrPlaylistName AS STRING _                 ' [in] bstrPlaylistName VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD PlaylistCollectionPlaylistSetAsDeleted &lt;5818&gt; ( _
     BYVAL bstrPlaylistName AS STRING _                 ' [in] bstrPlaylistName VT_BSTR
   , BYVAL varfIsDeleted AS INTEGER _                   ' [in] varfIsDeleted VT_BOOL &lt;Integer&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD ModeChange &lt;5819&gt; ( _
     BYVAL ModeName AS STRING _                         ' [in] ModeName VT_BSTR
   , BYVAL NewValue AS INTEGER _                        ' [in] NewValue VT_BOOL &lt;Integer&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MediaError &lt;5821&gt; ( _
     BYVAL pMediaObject AS IDispatch _                  ' [in] *pMediaObject VT_DISPATCH &lt;IDispatch&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD OpenPlaylistSwitch &lt;5823&gt; ( _
     BYVAL pItem AS IDispatch _                         ' [in] *pItem VT_DISPATCH &lt;IDispatch&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD DomainChange &lt;5822&gt; ( _
     BYVAL strDomain AS STRING _                        ' [in] strDomain VT_BSTR
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD SwitchedToPlayerApplication &lt;6501&gt;

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD SwitchedToControl &lt;6502&gt;

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD PlayerDockedStateChange &lt;6503&gt;

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD PlayerReconnect &lt;6504&gt;

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD Click &lt;6505&gt; ( _
     BYVAL nButton AS INTEGER _                         ' [in] nButton VT_I2 &lt;Integer&gt;
   , BYVAL nShiftState AS INTEGER _                     ' [in] nShiftState VT_I2 &lt;Integer&gt;
   , BYVAL fX AS LONG _                                 ' [in] fX VT_I4 &lt;Long&gt;
   , BYVAL fY AS LONG _                                 ' [in] fY VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD DoubleClick &lt;6506&gt; ( _
     BYVAL nButton AS INTEGER _                         ' [in] nButton VT_I2 &lt;Integer&gt;
   , BYVAL nShiftState AS INTEGER _                     ' [in] nShiftState VT_I2 &lt;Integer&gt;
   , BYVAL fX AS LONG _                                 ' [in] fX VT_I4 &lt;Long&gt;
   , BYVAL fY AS LONG _                                 ' [in] fY VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD KeyDown &lt;6507&gt; ( _
     BYVAL nKeyCode AS INTEGER _                        ' [in] nKeyCode VT_I2 &lt;Integer&gt;
   , BYVAL nShiftState AS INTEGER _                     ' [in] nShiftState VT_I2 &lt;Integer&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD KeyPress &lt;6508&gt; ( _
     BYVAL nKeyAscii AS INTEGER _                       ' [in] nKeyAscii VT_I2 &lt;Integer&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD KeyUp &lt;6509&gt; ( _
     BYVAL nKeyCode AS INTEGER _                        ' [in] nKeyCode VT_I2 &lt;Integer&gt;
   , BYVAL nShiftState AS INTEGER _                     ' [in] nShiftState VT_I2 &lt;Integer&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MouseDown &lt;6510&gt; ( _
     BYVAL nButton AS INTEGER _                         ' [in] nButton VT_I2 &lt;Integer&gt;
   , BYVAL nShiftState AS INTEGER _                     ' [in] nShiftState VT_I2 &lt;Integer&gt;
   , BYVAL fX AS LONG _                                 ' [in] fX VT_I4 &lt;Long&gt;
   , BYVAL fY AS LONG _                                 ' [in] fY VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MouseMove &lt;6511&gt; ( _
     BYVAL nButton AS INTEGER _                         ' [in] nButton VT_I2 &lt;Integer&gt;
   , BYVAL nShiftState AS INTEGER _                     ' [in] nShiftState VT_I2 &lt;Integer&gt;
   , BYVAL fX AS LONG _                                 ' [in] fX VT_I4 &lt;Long&gt;
   , BYVAL fY AS LONG _                                 ' [in] fY VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MouseUp &lt;6512&gt; ( _
     BYVAL nButton AS INTEGER _                         ' [in] nButton VT_I2 &lt;Integer&gt;
   , BYVAL nShiftState AS INTEGER _                     ' [in] nShiftState VT_I2 &lt;Integer&gt;
   , BYVAL fX AS LONG _                                 ' [in] fX VT_I4 &lt;Long&gt;
   , BYVAL fY AS LONG _                                 ' [in] fY VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD DeviceConnect &lt;6513&gt; ( _
     BYVAL pDevice AS IWMPSyncDevice _                  ' [in] *pDevice IWMPSyncDevice &lt;interface&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD DeviceDisconnect &lt;6514&gt; ( _
     BYVAL pDevice AS IWMPSyncDevice _                  ' [in] *pDevice IWMPSyncDevice &lt;interface&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD DeviceStatusChange &lt;6515&gt; ( _
     BYVAL pDevice AS IWMPSyncDevice _                  ' [in] *pDevice IWMPSyncDevice &lt;interface&gt;
   , BYVAL NewStatus AS LONG _                          ' [in] NewStatus WMPDeviceStatus &lt;enum&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD DeviceSyncStateChange &lt;6516&gt; ( _
     BYVAL pDevice AS IWMPSyncDevice _                  ' [in] *pDevice IWMPSyncDevice &lt;interface&gt;
   , BYVAL NewState AS LONG _                           ' [in] NewState WMPSyncState &lt;enum&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD DeviceSyncError &lt;6517&gt; ( _
     BYVAL pDevice AS IWMPSyncDevice _                  ' [in] *pDevice IWMPSyncDevice &lt;interface&gt;
   , BYVAL pMedia AS IDispatch _                        ' [in] *pMedia VT_DISPATCH &lt;IDispatch&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CreatePartnershipComplete &lt;6518&gt; ( _
     BYVAL pDevice AS IWMPSyncDevice _                  ' [in] *pDevice IWMPSyncDevice &lt;interface&gt;
   , BYVAL hrResult AS LONG _                           ' [in] hrResult VT_HRESULT &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CdromRipStateChange &lt;6519&gt; ( _
     BYVAL pCdromRip AS IWMPCdromRip _                  ' [in] *pCdromRip IWMPCdromRip &lt;interface&gt;
   , BYVAL wmprs AS LONG _                              ' [in] wmprs WMPRipState &lt;enum&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CdromRipMediaError &lt;6520&gt; ( _
     BYVAL pCdromRip AS IWMPCdromRip _                  ' [in] *pCdromRip IWMPCdromRip &lt;interface&gt;
   , BYVAL pMedia AS IDispatch _                        ' [in] *pMedia VT_DISPATCH &lt;IDispatch&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CdromBurnStateChange &lt;6521&gt; ( _
     BYVAL pCdromBurn AS IWMPCdromBurn _                ' [in] *pCdromBurn IWMPCdromBurn &lt;interface&gt;
   , BYVAL wmpbs AS LONG _                              ' [in] wmpbs WMPBurnState &lt;enum&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CdromBurnMediaError &lt;6522&gt; ( _
     BYVAL pCdromBurn AS IWMPCdromBurn _                ' [in] *pCdromBurn IWMPCdromBurn &lt;interface&gt;
   , BYVAL pMedia AS IDispatch _                        ' [in] *pMedia VT_DISPATCH &lt;IDispatch&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD CdromBurnError &lt;6523&gt; ( _
     BYVAL pCdromBurn AS IWMPCdromBurn _                ' [in] *pCdromBurn IWMPCdromBurn &lt;interface&gt;
   , BYVAL hrError AS LONG _                            ' [in] hrError VT_HRESULT &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD LibraryConnect &lt;6524&gt; ( _
     BYVAL pLibrary AS IWMPLibrary _                    ' [in] *pLibrary IWMPLibrary &lt;interface&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD LibraryDisconnect &lt;6525&gt; ( _
     BYVAL pLibrary AS IWMPLibrary _                    ' [in] *pLibrary IWMPLibrary &lt;interface&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD FolderScanStateChange &lt;6526&gt; ( _
     BYVAL wmpfss AS LONG _                             ' [in] wmpfss WMPFolderScanState &lt;enum&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD StringCollectionChange &lt;5824&gt; ( _
     BYVAL pdispStringCollection AS IDispatch _         ' [in] *pdispStringCollection VT_DISPATCH &lt;IDispatch&gt;
   , BYVAL change AS LONG _                             ' [in] change WMPStringCollectionChangeEventType &lt;enum&gt;
   , BYVAL lCollectionIndex AS LONG _                   ' [in] lCollectionIndex VT_I4 &lt;Long&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MediaCollectionMediaAdded &lt;5825&gt; ( _
     BYVAL pdispMedia AS IDispatch _                    ' [in] *pdispMedia VT_DISPATCH &lt;IDispatch&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

   ' =====================================================================================
   METHOD MediaCollectionMediaRemoved &lt;5826&gt; ( _
     BYVAL pdispMedia AS IDispatch _                    ' [in] *pdispMedia VT_DISPATCH &lt;IDispatch&gt;
   )                                                    ' VOID

     ' *** Insert your code here ***
     OutputDebugString FUNCNAME$

   END METHOD
   ' =====================================================================================

END INTERFACE

END CLASS</pre>
</div>
		<div class="js-post-attachments b-post-attachments h-clearfix">
			Attached Files
			<ul>
				
					
						
					

					
					
						
						
						
						
							
						
					


					<li class="b-post-attachments__item h-left">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727839">
							
								
									
								
								<img src="resources/fetch1.jpg" title="Click image for larger version

Name:	EX_CW_OC_WMP.jpg
Views:	417
Size:	41.7 KB
ID:	727839" alt="Click image for larger version

Name:	EX_CW_OC_WMP.jpg
Views:	417
Size:	41.7 KB
ID:	727839" class=js-lightbox data-fullsize-url="filedata/fetch?id=727839&amp;type=thumb" data-thumb-url="filedata/fetch?id=727839&amp;type=thumb" data-title="Click on the image to see the original version"/>
							
						</a>
					</li>
				
					
						
					

					
					


					<li class="b-post-attachments__item h-left h-clear">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727838">
							
								<span class="b-icon b-icon__doc--gray"></span>
								<span class=h-wordwrap>WMP.zip</span>
								
									
								
								<span>(1.76 MB, 62 views)</span>
							
						</a>
					</li>
				
			</ul>
		</div>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608622 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608622 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608622 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=608624 data-node-publishdate=1333735375 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post608624 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608624%23post608624" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=608624#post608624" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=Outlook+View+Control&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D608624%23post608624" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post608624">#16</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2012-04-06T11:02:55>6 Apr 2012, 02:02 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								Outlook View Control<br/>
<br/>
Demonstrates how to embed an instance of the Microsoft Office Outlook View Control.<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ########################################################################################
' Demonstrates how to embed an instance of the Microsoft Office Outlook View Control
' ########################################################################################

#COMPILE EXE
#DIM ALL
%UNICODE = 1
%USEOLECON = 1

#INCLUDE "CWindow.inc"            ' // CWindow class
#INCLUDE "olecon.inc"             ' // OLE Container
#INCLUDE "commctrl.inc"           ' // Common controls constants and declares
#INCLUDE "outlctl.inc"            ' // Microsoft View Control include file
#INCLUDE "ToolbarCtrl.inc"        ' // Toolbar wrapper functions
#INCLUDE "CAfxImageList.inc"      ' // Image List class
#RESOURCE RES, "EX_OVC_01.RES"    ' // Resource file

' Control identifiers
%IDC_TOOLBAR         = 1001
%IDC_OVC             = 1002

%IDM_CALENDAR        = 28000
%IDM_CONTACTS        = 28001
%IDM_DELETED         = 28002
%IDM_DRAFTS          = 28003
%IDM_INBOX           = 28004
%IDM_NOTES           = 28005
%IDM_OUTBOX          = 28006
%IDM_SENT            = 28007
%IDM_TASKS           = 28009

' Icon identifiers
%IDI_CALENDAR        = 100
%IDI_CONTACTS        = 101
%IDI_DELETED         = 102
%IDI_DRAFTS          = 103
%IDI_INBOX           = 104
%IDI_JOURNAL         = 105
%IDI_NOTES           = 106
%IDI_OUTBOX          = 107
%IDI_OUTLOOK         = 108
%IDI_PERSONALFOLDERS = 109
%IDI_SENT            = 110
%IDI_TASKS           = 111

' ========================================================================================
' Creates the toolbar
' ========================================================================================
FUNCTION OvcCreateToolbar (BYVAL pWindow AS IWindow) AS DWORD

   LOCAL hToolBar AS DWORD
   LOCAL cx, cy AS LONG

   ' // Create the ToolBar Window.
   hToolBar = pWindow.AddToolBar(pWindow.hwnd, %IDC_TOOLBAR, "", 0, 0, 0, 0, _
              %WS_CHILD OR %WS_VISIBLE OR %TBSTYLE_TOOLTIPS OR %TBSTYLE_FLAT)
   ' // Set the extended style
   ToolBar_SetExtendedStyle hToolbar, %TBSTYLE_EX_DRAWDDARROWS

   ' // Set the size of the bitmapped images
   ToolBar_SetBitmapSize(hToolbar, 24, 24)

   ' // Add buttons to the toolbar
   Toolbar_AddButton hToolBar, 0, %IDM_CALENDAR
   Toolbar_AddButton hToolBar, 1, %IDM_CONTACTS
   Toolbar_AddButton hToolBar, 2, %IDM_DELETED
   Toolbar_AddButton hToolBar, 3, %IDM_DRAFTS
   Toolbar_AddButton hToolBar, 4, %IDM_INBOX
   Toolbar_AddButton hToolBar, 5, %IDM_NOTES
   Toolbar_AddButton hToolBar, 6, %IDM_OUTBOX
   Toolbar_AddButton hToolBar, 7, %IDM_SENT
   Toolbar_AddButton hToolBar, 8, %IDM_TASKS

   ' // Update the size of the toolbar
   ToolBar_AutoSize(hToolbar)

   ' // Create the image list
   LOCAL pAfxImageList AS IAfxImageList
   pAfxImageList = CLASS "CAfxImageList"
   IF ISNOTHING(pAfxImageList) THEN EXIT FUNCTION

   ' // Desired icon size width and height
   cx = GetSystemMetrics(%SM_CXSMICON)
   cy = GetSystemMetrics(%SM_CYSMICON)
   ' // Create the image list
   pAfxImageList.CreateImageList(cx, cy, %ILC_COLOR32 OR %ILC_MASK, 9)

   ' // Give a name to the image list
   pAfxImageList.Name = "Toolbar image list"

   ' // Add the bitmaps from the resource file
   pAfxImageList.LoadResBitmapMasked(%IDI_CALENDAR, cx, cy)
   pAfxImageList.LoadResBitmapMasked(%IDI_CONTACTS, cx, cy)
   pAfxImageList.LoadResBitmapMasked(%IDI_DELETED, cx, cy)
   pAfxImageList.LoadResBitmapMasked(%IDI_DRAFTS, cx, cy)
   pAfxImageList.LoadResBitmapMasked(%IDI_INBOX, cx, cy)
   pAfxImageList.LoadResBitmapMasked(%IDI_NOTES, cx, cy)
   pAfxImageList.LoadResBitmapMasked(%IDI_OUTBOX, cx, cy)
   pAfxImageList.LoadResBitmapMasked(%IDI_SENT, cx, cy)
   pAfxImageList.LoadResBitmapMasked(%IDI_TASKS, cx, cy)

   ' // Set the image list
   ToolBar_SetImageList(hToolbar, pAfxImageList.hImageList)

   ' // Register the image list class in the collection
   pWindow.AddObject "Toolbar image list", pAfxImageList

   ' // Return the handle of the toolbar
   FUNCTION = hToolbar

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main
' ========================================================================================
FUNCTION WinMain (BYVAL hInstance AS DWORD, BYVAL hPrevInstance AS DWORD, BYVAL lpszCmdLine AS WSTRINGZ PTR, BYVAL nCmdShow AS LONG) AS LONG

   ' // Set process DPI aware
   IF AfxGetWindowsVersion =&gt; 6.00 THEN SetProcessDPIAware

   ' // Create an instance of the class
   LOCAL pWindow AS IWindow
   pWindow = CLASS "CWindow"
   IF ISNOTHING(pWindow) THEN EXIT FUNCTION

   ' // Create the main window
   pWindow.CreateWindow(%NULL, "Microsoft Outlook View Control Demo", 0, 0, 0, 0, 0, 0, CODEPTR(WindowProc))
   ' // Disable background erasing
   pWindow.ClassStyle = %CS_DBLCLKS
   ' // Set the client siz
   pWindow.SetClientSize 600, 350
   ' // Center the window
   pWindow.CenterWindow

   ' // Create the View Control window container
   LOCAL hCtl AS DWORD
   hCtl = pWindow.AddOCX(pWindow.hwnd, %IDC_OVC, "OVCtl.OVCtl", "", 0, 0, 0, 0)
   ' // Get a reference to the control
   LOCAL pOvc AS OVCtl_IViewCtl
   pOvc = OC_GetDispatch(hCtl)
   IF ISOBJECT(pOvc) THEN
      ' // Choose the Calendar view
      pOvc.Folder = "Inbox"
      ' // Release the reference
      pOvc = NOTHING
   END IF

   ' // Add the toolbar
   OvcCreateToolBar pWindow

   ' // Default message pump (you can replace it with your own)
   pWindow.DoEvents(nCmdShow)

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main callback function.
' ========================================================================================
FUNCTION WindowProc (BYVAL hwnd AS DWORD, BYVAL uMsg AS DWORD, BYVAL wParam AS DWORD, BYVAL lParam AS LONG) AS LONG

   LOCAL  hCtl       AS DWORD
   LOCAL  rc         AS RECT
   LOCAL  pOvc       AS OVCtl_IViewCtl
   LOCAL  pTOOLTIP   AS TOOLTIPTEXT PTR
   LOCAL  lpNmh      AS NMHDR  PTR
   STATIC pWindow    AS IWindow        ' // Reference to the IWindow interface
   STATIC wszTipText AS WSTRINGZ * 64

   ' // Process window mesages
   SELECT CASE uMsg

      CASE %WM_CREATE
         ' // Get a reference to the IWindow interface from the CREATESTRUCT structure
         pWindow = CWindow_GetObjectFromCreateStruct(lParam)
         EXIT FUNCTION

      CASE %WM_SYSCOMMAND
        ' Capture this message and send a %WM_CLOSE message
        IF (wParam AND &HFFF0) = %SC_CLOSE THEN
           SendMessage hWnd, %WM_CLOSE, 0, 0
           EXIT FUNCTION
        END IF

      CASE %WM_COMMAND

         SELECT CASE LO(WORD, wParam)

            CASE %IDCANCEL
               ' // If the Escape key has been pressed...
               IF HI(WORD, wParam) = %BN_CLICKED THEN
                  ' // ... close the application by sending a WM_CLOSE message
                  SendMessage hwnd, %WM_CLOSE, 0, 0
                  EXIT FUNCTION
               END IF

            CASE %IDM_CALENDAR, %IDM_CONTACTS, %IDM_DRAFTS, %IDM_DELETED, %IDM_INBOX, _
                 %IDM_NOTES, %IDM_OUTBOX, %IDM_SENT, %IDM_TASKS
               IF HI(WORD, wParam) = %BN_CLICKED THEN
                  hCtl = GetDlgItem(hwnd, %IDC_OVC)
                  pOvc = OC_GetDispatch(hCtl)
                  IF ISOBJECT(pOvc) THEN
                     ' Choose the view
                     SELECT CASE LO(WORD, wParam)
                        CASE %IDM_CALENDAR : pOvc.Folder = "Calendar"
                        CASE %IDM_CONTACTS : pOvc.Folder = "Contacts"
                        CASE %IDM_DRAFTS   : pOvc.Folder = "Drafts"
                        CASE %IDM_DELETED  : pOvc.Folder = "Deleted Items"
                        CASE %IDM_INBOX    : pOvc.Folder = "Inbox"
                        CASE %IDM_NOTES    : pOvc.Folder = "Notes"
                        CASE %IDM_OUTBOX   : pOvc.Folder = "Outbox"
                        CASE %IDM_SENT     : pOvc.Folder = "Sent Items"
                        CASE %IDM_TASKS    : pOvc.Folder = "Tasks"
                     END SELECT
                     ' Release the reference
                     pOvc = NOTHING
                  END IF
                  EXIT FUNCTION
               END IF

         END SELECT

      CASE %WM_NOTIFY
         lpNmh = lParam
         SELECT CASE @lpNmh.Code
         CASE %TTN_NEEDTEXT ' ToolTips
            pTOOLTIP = lParam
            wszTipText = ""
            IF @pTOOLTIP.hdr.code = %TTN_NEEDTEXT THEN
               SELECT CASE @pTOOLTIP.hdr.idFrom
                  CASE %IDM_CALENDAR : wszTipText = " Calendar "
                  CASE %IDM_CONTACTS : wszTipText = " Contacts "
                  CASE %IDM_DELETED  : wszTipText = " Deleted Items "
                  CASE %IDM_DRAFTS   : wszTipText = " Drafts "
                  CASE %IDM_INBOX    : wszTipText = " Inbox "
                  CASE %IDM_NOTES    : wszTipText = " Notes "
                  CASE %IDM_OUTBOX   : wszTipText = " Outbox "
                  CASE %IDM_SENT     : wszTipText = " Sent Items "
                  CASE %IDM_TASKS    : wszTipText = " Tasks "
               END SELECT
               IF wszTipText &lt;&gt; "" THEN
                  @pTOOLTIP.lpszText = VARPTR(wszTipText)
                  EXIT FUNCTION
               END IF
            END IF
         END SELECT

      CASE %WM_SIZE
         ' // If the window isn't minimized, resize it
         IF wParam &lt;&gt; %SIZE_MINIMIZED THEN
            ' // Resize the toolbar
            LOCAL hToolBar AS DWORD
            hToolBar = GetDlgItem(hwnd, %IDC_TOOLBAR)
            SendMessage hToolBar, uMsg, wParam, lParam
            ' // Calculate the size of the toolbar
            LOCAL ToolBarHeight AS DWORD
            pWindow.GetControlWindowRect hToolbar, rc
            ToolBarHeight = rc.Bottom - rc.Top
            ' // Resize the outlook view control
            pWindow.MoveWindow GetDlgItem(hwnd, %IDC_OVC), 0, ToolBarHeight, pWindow.ClientWidth, pWindow.ClientHeight - ToolBarHeight, %TRUE
         END IF

      CASE %WM_DESTROY
         ' // End the application
         PostQuitMessage 0
         EXIT FUNCTION

   END SELECT

   ' // Pass unprocessed messages to Windows
   FUNCTION = DefWindowProc(hwnd, uMsg, wParam, lParam)

END FUNCTION
' ========================================================================================</pre>
</div>
		<div class="js-post-attachments b-post-attachments h-clearfix">
			Attached Files
			<ul>
				
					
						
					

					
					
						
						
						
						
							
						
					


					<li class="b-post-attachments__item h-left">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727841">
							
								
									
								
								<img src="resources/fetch.jpg" title="Click image for larger version

Name:	EX_CW_OC_OVC_01.jpg
Views:	395
Size:	62.7 KB
ID:	727841" alt="Click image for larger version

Name:	EX_CW_OC_OVC_01.jpg
Views:	395
Size:	62.7 KB
ID:	727841" class=js-lightbox data-fullsize-url="filedata/fetch?id=727841&amp;type=thumb" data-thumb-url="filedata/fetch?id=727841&amp;type=thumb" data-title="Click on the image to see the original version"/>
							
						</a>
					</li>
				
					
						
					

					
					


					<li class="b-post-attachments__item h-left h-clear">
						<a href="https://forum.powerbasic.com/filedata/fetch?id=727840">
							
								<span class="b-icon b-icon__doc--gray"></span>
								<span class=h-wordwrap>OutlookViewControl.zip</span>
								
									
								
								<span>(31.9 KB, 41 views)</span>
							
						</a>
					</li>
				
			</ul>
		</div>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=608624 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-608624 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-608624 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=786638 data-node-publishdate=1574188417 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post786638 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image.png" alt="Jos√© Roca" title="Jos√© Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class="avatar medium h-left">
		<img src="resources/image1.png" alt="Jos√© Roca" title="Jos√© Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				Jos√© Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-jos√©-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-jos√©-roca" class data-vbnamecard=1464>Jos√© Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7898</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="Jos√© Roca is offline"><span class="b-icon b-icon__status--gray"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D786638%23post786638" data-url-not-encoded="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples?p=786638#post786638" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fjose-s-corner%2Fsource-code-ab%2F51321-assorted-com-examples%3Fp%3D786638%23post786638" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="#post786638">#17</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2019-11-19T10:33:37>19 Nov 2019, 01:33 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						
							<div class="axd axd_last-post">
								
								
								
							</div>
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								An user has asked me how to use IFileOpenDialog with multiple selection:<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">#COMPILE EXE
#DIM ALL
#INCLUDE "ShObjIdl.inc"

FUNCTION PBMAIN () AS LONG

   LOCAL hr AS LONG

   ' // Create an instance of the IFileOpenDialog interface
   LOCAL pofd AS IFileOpenDialog
   pofd = NEWCOM CLSID $CLSID_FileOpenDialog
   IF ISNOTHING(pofd) THEN EXIT FUNCTION

   DIM rgFileTypes(2) AS COMDLG_FILTERSPEC
   DIM pszNames(2) AS WSTRINGZ * %MAX_PATH
   DIM pszSpecs(2) AS WSTRINGZ * %MAX_PATH
   pszNames(0) = "PB code files"
   pszNames(1) = "Executable files"
   pszNames(2) = "All files"
   pszSpecs(0) = "*.bas;*.inc"
   pszSpecs(1) = "*.exe;*.dll"
   pszSpecs(2) = "*.*"
   rgFileTypes(0).pszName = VARPTR(pszNames(0)) : rgFileTypes(0).pszSpec = VARPTR(pszSpecs(0))
   rgFileTypes(1).pszName = VARPTR(pszNames(1)) : rgFileTypes(1).pszSpec = VARPTR(pszSpecs(1))
   rgFileTypes(2).pszName = VARPTR(pszNames(2)) : rgFileTypes(2).pszSpec = VARPTR(pszSpecs(2))
   hr = pofd.SetFileTypes(3, rgFileTypes(0))

   ' // Set the title of the dialog
   hr = pofd.SetTitle("A Single-Selection Dialog")
   ' // Allow mutiselection
   hr = pofd.SetOptions(%FOS_ALLOWMULTISELECT)

   ' // Display the dialog
   hr = pofd.Show(0)

   ' // Get the results
   LOCAL pItemArray AS IShellItemArray
   hr = pofd.GetResults(pItemArray)
   LOCAL dwItemCount AS LONG
   IF ISOBJECT(pItemArray) THEN
      pItemArray.GetCount(dwItemCount)
      LOCAL pItem AS IShellItem
      LOCAL pwszName AS WSTRINGZ PTR
      LOCAL idx AS LONG
      FOR idx = 0 TO dwItemCount - 1
         pItemArray.GetItemAt(idx, pItem)
         IF ISOBJECT(pItem) THEN
            pItem.GetDisplayName(%SIGDN_FILESYSPATH, pwszName)
            IF pwszName THEN
               MSGBOX @pwszName
               CoTaskMemFree(pwszName)
               pwszName = %NULL
            END IF
            pItem = NOTHING
         END IF
      NEXT
   END IF

END FUNCTION</pre>
</div>
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=786638 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-786638 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-786638 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
						</ul>
					</div>
				</div>
				
					


	



	


<div class="pagenav-container h-clearfix noselect h-hide">
	<div class="js-pagenav pagenav h-right js-shrink-event-parent" data-baseurl="https://forum.powerbasic.com/forum/jose-s-corner/source-code-ab/51321-assorted-com-examples">

		

		
		
			<a class="js-pagenav-button js-pagenav-prev-button b-button b-button--secondary h-hide-imp js-shrink-event-child" data-page=0 tabindex=0>Previous</a>
		

		
		
		
		
		
		<a class="js-pagenav-button b-button b-button--narrow js-shrink-event-child b-button--secondary js-pagenav-button--template h-hide-imp" data-page=0 tabindex=0>template</a>

		
		
			<a class="js-pagenav-button js-pagenav-next-button b-button b-button--secondary h-hide-imp js-shrink-event-child" data-page=0 tabindex=0>Next</a>
		

	</div>
</div>
					
						<div class=h-margin-top-xl></div>
					
				

				
			</div>
		
		
	</div>
	





	<!-- *** END WIDGET widgetid:6, widgetinstanceid:20, template:widget_conversationdisplay *** -->


	

</div>

	

</div>

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	







<!-- section 3 -->



<div class="canvas-widget-list section-3 js-sectiontype-extra h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	

	

</div>

	

</div>

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	







<!-- section 201 -->



<div class="canvas-widget-list section-201 js-sectiontype-global_before_footer h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	

	

</div>

	

</div>

	

</div>

</div>
	<div class=h-clear></div>
</main>

	<footer id=footer>
		
		
		<nav id=footer-tabbar class="h-clearfix js-shrink-event-parent">
			
			
			
			
			
				
			
			
			<ul class="h-left js-footer-chooser-list h-margin-left-xxl js-shrink-event-child">
				
				
					<li>

						<div class="b-comp-menu-dropdown js-comp-menu-dropdown b-comp-menu-dropdown--open-on-hover b-comp-menu-dropdown--direction-up js-languagechooser js-select-on-xsmall h-margin-right-l">
							<div class="b-comp-menu-dropdown__trigger js-comp-menu-dropdown__trigger b-comp-menu-dropdown__trigger--arrow">
								
									
								
									
										English (US)
									
								
									
								
									
								
							</div>
							<ul class="b-comp-menu-dropdown__content js-comp-menu-dropdown__content b-comp-menu-dropdown__content--left">
								
									<li class=b-comp-menu-dropdown__content-item>
										<a href="https://forum.powerbasic.com/#" data-languageid=3>Deutsch (Du)</a>
									</li>
								
									<li class="b-comp-menu-dropdown__content-item b-comp-menu-dropdown__content-item--current">
										<a href="https://forum.powerbasic.com/#" data-languageid=1>English (US)</a>
									</li>
								
									<li class=b-comp-menu-dropdown__content-item>
										<a href="https://forum.powerbasic.com/#" data-languageid=2>French</a>
									</li>
								
									<li class=b-comp-menu-dropdown__content-item>
										<a href="https://forum.powerbasic.com/#" data-languageid=4>Spanish</a>
									</li>
								
							</ul>
						</div>

					</li>
				
				
			</ul>

			<ul class="nav-list h-right js-footer-nav-list h-margin-right-xxl b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive js-shrink-event-child" data-dropdown-trigger-phrase=go_to_ellipsis data-dropdown-menu-classes="h-margin-vert-l b-comp-menu-dropdown--direction-up" data-dropdown-trigger-classes=b-comp-menu-dropdown__trigger--arrow>
				
				
					
					
					
					
					
					
					
					
					
					

					<li class>
						<a target=_blank href="http://www.powerbasic.com/">PowerBASIC Web Site</a>
					</li>

				
					
					
					
						
						
					
					
					
					
					
					
					
					

					<li class>
						<a rel=nofollow href="https://forum.powerbasic.com/help">Site Help</a>
					</li>

				
					
					
					
						
						
					
					
					
					
					
					
					
					

					<li class>
						<a rel=nofollow href="https://forum.powerbasic.com/contact-us">Contact Us</a>
					</li>

				
					
					
					
					
					
					
					
					
					
					

					<li class>
						<a href="https://forum.powerbasic.com/">Community Main Page</a>
					</li>

				
				<li><a href="https://forum.powerbasic.com/#" class=js-footer-go-to-top>Top of Page</a></li>
			</ul>
		</nav>
		
      
      
      
      

      
    

	</footer>
</div>
<div id=footer-copyright>
	<div id=footer-user-copyright>Copyright ¬© 1998-2022 PowerBASIC Tools, LLC - All Rights Reserved.</div>
	<div id=footer-vb-copyright>Powered by <a href="https://www.vbulletin.com" id=vbulletinlink>vBulletin¬Æ</a> Version 5.6.6 <br/>Copyright ¬© 2022 vBulletin Solutions, Inc. All rights reserved. </div>
	<div id=footer-current-datetime>All times are GMT-5. This page was generated at 07:45 AM.</div>
</div>
</div>

<div id=loading-indicator class="js-loading-indicator b-ajax-loading-indicator h-hide">
	<span>Working...</span>
</div>
<div class="js-flash-message b-ajax-loading-indicator b-ajax-loading-indicator--medium h-hide">
	<span class=js-flash-message-content></span>
</div>
<div id=confirm-dialog class=sb-dialog>
	<div class="dialog-content h-clearfix">
		<div class="icon h-left"></div>
		<div class=message></div>
	</div>
	<div class=b-button-group>
		<button id=btnConfirmDialogYes type=button class="b-button b-button--primary js-button">Yes</button>
		<button id=btnConfirmDialogNo type=button class="b-button b-button--secondary js-button">No</button>
	</div>
</div>
<div id=alert-dialog class=sb-dialog>
	<div class="dialog-content h-clearfix">
		<div class="icon h-left"></div>
		<div class=message></div>
	</div>
	<div class=b-button-group>
		<button id=btnAlertDialogOK type=button class="b-button b-button--primary js-button">OK</button>
	</div>
</div>
<div id=prompt-dialog class=sb-dialog>
	<div class="dialog-content table h-clearfix">
		<div class="message td"></div>
		<div class="input-box-container td">
			<input type=text class="input-box textbox"/>
			<textarea class="input-box textbox h-hide" rows=3></textarea>
		</div>
	</div>
	<div class="js-prompt-error h-hide"></div>
	<div class=b-button-group>
		<button id=btnPromptDialogOK type=button class="b-button b-button--primary js-button">OK</button>
		<button id=btnPromptDialogCancel type=button class="b-button b-button--secondary js-button">Cancel</button>
	</div>
</div>
<div id=slideshow-dialog class="sb-dialog slideshow">
	<div class="b-icon b-icon__x-square--gray close-btn">X</div>
	<div class=slideshow-wrapper></div>
	<div class=caption></div>
	<div class=thumbnails-wrapper>
		<div class=thumbnails></div>
	</div>

</div>

<div class=unsubscribe-overlay-container></div>

<div id=fb-root data-facebook-language=en_US></div>



















	<div class="b-modal-banner__banner js-privacy-consent-banner__banner h-hide-imp b-modal-banner__banner--center">
	
		<p class=b-modal-banner__paragraph>We process personal data about users of our site, through the use of cookies and other technologies, to deliver our services, and to analyze site activity. For additional details, refer to our <a href="https://www.powerbasic.com/privacy-notice" target=_blank class=b-modal-banner__clickable>Privacy Policy</a>.</p>

<p class=b-modal-banner__paragraph>By clicking "<b>I AGREE</b>" below, you agree to our <a href="https://www.powerbasic.com/privacy-notice" target=_blank class=b-modal-banner__clickable>Privacy Policy</a> and our personal data processing and cookie practices as described therein. You also acknowledge that this forum may be hosted outside your country and you consent to the collection, storage, and processing of your data in the country where this forum is hosted.</p>
		<p class=b-modal-banner__paragraph>
			<a href="https://forum.powerbasic.com/#" class="b-button b-button--primary b-modal-banner__clickable js-privacy-consent-banner__button">I Agree</a>
		</p>
	
</div>
<div class="b-modal-banner__overlay js-privacy-consent-banner__overlay h-hide-imp"></div>
	







</body>
<!--saved from url=(0024)http://www.bauerapps.com--></html>