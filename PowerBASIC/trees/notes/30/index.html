<!DOCTYPE html>
<!--saved from url=(0024)http://www.bauerapps.com--><html id=htmlTag xmlns="http://www.w3.org/1999/xhtml" xml:lang=en lang=en dir=ltr>
<head>
	
	
	<base/>
	
		<link rel="Shortcut Icon" href="resources/favicon_2021.ico" type="image/x-icon"/>
	

	
	
	
		
		
	

	

	
	<link rel=stylesheet type="text/css" href="resources/css4.css"/>
<link rel=stylesheet type="text/css" href="resources/css6.css"/>



		<meta name=robots content=noindex />
	
	
	
		<meta property=og:site_name content="PowerBASIC Peer Support Community"/>
		<meta property=og:description content="PowerBASIC and related source code. Please do not post questions or discussions, just source code."/>
		<meta property=og:url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
		
		<meta property=og:type content=website />
	
	

	
	
	

	
	<meta name=viewport content="width=device-width, initial-scale=1, viewport-fit=cover"/>

	
	
	
		
		
		
			
			
		
	

	
	
	
		

	<title>Microsoft Script Control wrapper functions - PowerBASIC Peer Support Community</title>

	<meta name=description content="PowerBASIC and related source code. Please do not post questions or discussions, just source code."/>
	<meta name=generator content="vBulletin 5.6.6"/>

	
	

	<link rel=stylesheet type="text/css" href="resources/css2.css"/>
<link rel=stylesheet type="text/css" href="resources/css.css"/>
<link rel=stylesheet type="text/css" href="resources/css3.css"/>
<link rel=stylesheet type="text/css" href="resources/css1.css"/>
<link class=js-additional-css rel=stylesheet type="text/css" href="resources/css5.css"/>


	
	



<meta http-equiv=Content-Type content="text/html; charset=utf-8">
</head>

	







	

<body id=vb-page-body class="l-desktop page89 vb-page view-mode logged-out" itemscope itemtype="http://schema.org/ItemPage" data-usergroupid=1 data-styleid=39>





	


<div class="b-top-menu__background b-top-menu__background--sitebuilder js-top-menu-sitebuilder h-hide-on-small h-hide">
	<div class=b-top-menu__container>
		<ul class="b-top-menu b-top-menu--sitebuilder js-top-menu-sitebuilder--list js-shrink-event-parent">
			
		</ul>
	</div>
</div>

<nav class="b-top-menu__background js-top-menu-user">
	<div class=b-top-menu__container>
		<ul class="b-top-menu b-top-menu--user js-top-menu-user--list js-shrink-event-parent">
			




	



	<li class="b-top-menu__item b-top-menu__item--no-left-divider b-top-menu__item--no-right-divider username-container js-shrink-event-child">

		<div class="b-comp-menu-dropdown b-comp-menu-dropdown--headerbar js-comp-menu-dropdown b-comp-menu-dropdown--open-on-hover js-login-menu">
			<div id=lnkLoginSignupMenu class="b-comp-menu-dropdown__trigger js-comp-menu-dropdown__trigger b-comp-menu-dropdown__trigger--arrow b-comp-menu-dropdown__trigger--headerbar js-button" tabindex=0>
				Login or Sign Up
			</div>

			<ul class="b-comp-menu-dropdown__content js-comp-menu-dropdown__content b-comp-menu-dropdown__content--right">

				<li class="b-comp-menu-dropdown__content-item js-comp-menu-dropdown__content-maintain-menu b-comp-menu-dropdown__content-item--no-hover">
					

<div class="js-login-form-main-container login-form-main-container">

<div class="js-error-box error h-margin-bottom-l h-hide"></div>

<div class="js-login-message-box login-message-box h-hide">
	<div class=h-center-container><div class=h-center>Logging in...</div></div>
</div>

<form action method=post class="h-clearfix js-login-form-main ">
	<div class="login-fieldset table">
		<div class=tr>
			
				
					
				
			
			<span class=td>
				<input type=text name=username value class="js-login-username b-form-input__input b-form-input__input--full" placeholder="User/Email"/>
			</span>
		</div>
		<div class=tr>
			<span class=td>
				<input type=password autocomplete=off name=password class="js-login-password b-form-input__input b-form-input__input--full" placeholder=Password />
			</span>
		</div>
	</div>

	
	
		<div class="h-warning h-text-size--11">By logging into your account, you agree to our <a href="https://www.powerbasic.com/privacy-notice" target=_blank>Privacy Policy</a>, personal data processing and storage practices as described therein.</div>
		<input type=hidden name=privacyconsent value=1 />
	

	<div class="secondary-controls h-left h-clear-left h-margin-top-s">
		<label><input type=checkbox name=rememberme />Remember me</label>
	</div>

	<div class="primary-controls h-right h-clear-right h-margin-top-s">
		<button type=button class="js-login-button b-button b-button--primary">Log in</button>
	</div>

	<div class="secondary-controls h-left h-clear-left">
		<a href="https://forum.powerbasic.com/lostpw" class="b-link lost-password-link">Forgot password or user name?</a>
	</div>

	<div class="primary-controls h-right h-clear-right">
		
			
			
			
		
		or <a id=idLoginSignup href="https://forum.powerbasic.com/register?urlpath=aHR0cHM6Ly9mb3J1bS5wb3dlcmJhc2ljLmNvbS9mb3J1bS91c2VyLXRvLXVzZXItZGlzY3Vzc2lvbnMvc291cmNlLWNvZGUvMjUxNzctbWljcm9zb2Z0LXNjcmlwdC1jb250cm9sLXdyYXBwZXItZnVuY3Rpb25z" target=_top>Sign Up</a>
	</div>

</form>
</div>
				</li>

				
				

				<li id=externalLoginProviders class="b-comp-menu-dropdown__content-item js-comp-menu-dropdown__content-maintain-menu b-comp-menu-dropdown__content-item--no-hover js-external-login-providers h-clearfix h-hide-imp">
					<span class="h-left h-margin-left-s h-margin-top-s">Log in with</span>
					
					
					
			

			

				</li>

			</ul>

		</div>

	</li>

	

		</ul>
	</div>
</nav>

<div id=sitebuilder-wrapper class="noselect h-clearfix h-hide-on-small">
	
</div>

<div class=main-navbar-bottom-line></div>

<div id=outer-wrapper>
<div id=wrapper>

	
	<div id=header-axd class="header-edit-box axdnum_1 h-clearfix">
		
		<div class="axd-container axd-container_header">
			<div class=admin-only>
				
			</div>
			<div class="axd axd_header">
				
			</div>
		</div>
		<div class="axd-container axd-container_header2">
			<div class=admin-only>
				
			</div>
			<div class="axd axd_header2">
				
			</div>
		</div>
	</div>
	
	
	
	<header class=b-top-background__header-mainnav-subnav>

		
		<div class=b-top-background__header-mainnav>

			
			<div id=header class=noselect>
				<div class=header-cell>
					
					<div class="site-logo header-edit-box">
						<a href="https://forum.powerbasic.com/"><img src="resources/forum.hdr.pb2016.912x96.png" data-orig-src="https://forum.powerbasic.com/core/css/0/0/3/1/8/7//images/forum.hdr.pb2016.912x96.png" alt=Logo title="Powered by vBulletin"/></a>
					</div>
				</div>
				<div class=toolbar>
					<ul class=h-right>
						
						
						
						<li class=search-container>
							<form id=searchForm action="https://forum.powerbasic.com/search" class=h-left method=GET>
								<div class=h-left>

									
									<div class="search-box h-clearfix">

										<div class=search-term-container>

											<input type=text name=q id=q placeholder=Search class="search-term b-form-input__input b-form-input__input--shadow" autocomplete=off />

											<div class="search-menu-container h-clearfix">
												<div class=vertical-divider-left></div>
												<div class="b-comp-menu-dropdown js-comp-menu-dropdown b-comp-menu-dropdown--open-on-hover b-comp-menu-dropdown--header-search">
													<div class="b-comp-menu-dropdown__trigger js-comp-menu-dropdown__trigger b-comp-menu-dropdown__trigger--arrow js-button" tabindex=0></div>
													<ul class="b-comp-menu-dropdown__content js-comp-menu-dropdown__content">

	<li class="b-comp-menu-dropdown__content-item b-comp-menu-dropdown__content-item--first b-comp-menu-dropdown__content-item--no-hover js-comp-menu-dropdown__content-maintain-menu">

		<div class=searchPopupBody>

			<label><input type=checkbox name="searchFields[title_only]" class=searchFields_title_only value=1 />Search in titles only</label>

			

			
				
				
					<label><input type=checkbox name="searchFields[channel][]" class=searchFields_channel value=36 />Search in Source Code Library only</label>
				
			

			<div class="b-button-group h-margin-top-xs">
				<button type=submit id=btnSearch-popup class="b-button b-button--primary">Search</button>
			</div>

		</div>

		<input type=hidden name=searchJSON value />
	</li>

	<li class="b-comp-menu-dropdown__content-item js-comp-menu-dropdown__content-maintain-menu">
		<a href="https://forum.powerbasic.com/#" id=btnAdvSearch class=adv-search-btn>Advanced Search</a>
	</li>

</ul>
												</div>
											</div>

										</div>

										<button type=submit id=btnSearch class=search-btn title=Search><span class="b-icon b-icon__search"></span></button>

									</div>

								</div>
							</form>
						</li>
						
					</ul>
				</div>
				
			</div>

			
			<nav id=channel-tabbar class="h-clearfix noselect">
				<ul class="channel-tabbar-list h-left b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-comp-menu-dropdown--inactive js-comp-menu-dropdown__content--main-menu h-hide-on-small js-shrink-event-parent">

					
						
					

					
					
					
						
						
						
						<li class="current section-item js-shrink-event-child">
							<a href class="h-left navbar_home">Community</a>
							
								<span class=channel-tabbar-divider></span>
							
							<span class="mobile dropdown-icon"><span class="icon h-right"></span></span>
						</li>
					
						
						
						
						<li class=" section-item js-shrink-event-child">
							<a href="https://forum.powerbasic.com/PowerBASICLinks" class="h-left navbar_powerbasic_home_page">PowerBASIC Links</a>
							
								<span class=channel-tabbar-divider></span>
							
							<span class="mobile dropdown-icon"><span class="icon h-right"></span></span>
						</li>
					
						
						
						
						<li class=" section-item js-shrink-event-child">
							<a href="https://forum.powerbasic.com/RulesAndGuidelines" class="h-left navbar_forum_rules_ampamp_guidelines">Forum Rules & Guidelines</a>
							
							<span class="mobile dropdown-icon"><span class="icon h-right"></span></span>
						</li>
					
					
				</ul>
			</nav>


		</div>


		
		<nav id=channel-subtabbar class="h-clearfix  h-hide-on-small h-block js-channel-subtabbar">
			<ul class="h-left channel-subtabbar-list js-channel-subtabbar-list js-shrink-event-parent">
				
					
					
					<li class=" js-shrink-event-child">
						<a href="https://forum.powerbasic.com/search?searchJSON={%22view%22:%22topic%22,%22unread_only%22:1,%22sort%22:{%22lastcontent%22:%22desc%22},%22exclude%22:%2245%22,%22exclude_type%22:[%22vBForum_PrivateMessage%22],%22date%22:%22lastVisit%22}" class=navbar__>NEW POSTS</a>
					</li>
				
					
					
					<li class=" js-shrink-event-child">
						<a href="http://forum.powerbasic.com/search?searchJSON={%22date%22:{%22from%22:%222%22},%22sort%22:{%22created%22:%22desc%22},%22view%22:%22%22,%22exclude%22:%2245%22,%22exclude_type%22:[%22vBForum_PrivateMessage%22]}" class=navbar_.>Activity Stream</a>
					</li>
				
					
					
					<li class=" js-shrink-event-child">
						<a href="https://forum.powerbasic.com/search?searchJSON={%22view%22:%22topic%22,%22unread_only%22:1,%22sort%22:{%22lastcontent%22:%22desc%22},%22exclude%22:%2245%22,%22exclude_type%22:[%22vBForum_PrivateMessage%22]}" class=navbar_todays_posts>Today's Posts</a>
					</li>
				
					
					
					<li class=" js-shrink-event-child">
						<a href='https://forum.powerbasic.com/search?searchJSON={"view":"topic","unread_only":1,"sort":{"lastcontent":"desc"},"exclude":"45","exclude_type":["vBForum_PrivateMessage"],"date":"lastVisit"}' class=navbar_newtopics>New Topics</a>
					</li>
				
					
					
					<li class=" js-shrink-event-child">
						<a href="https://forum.powerbasic.com/search" class=navbar_advanced_search>ADVANCED SEARCH</a>
					</li>
				
			</ul>
		</nav>


	</header>


	
		
	

	
	
		
		<nav class=breadcrumbs-wrapper>
		<ul id=breadcrumbs class=h-clearfix itemprop=breadcrumb>
			<li class=crumb>
				<a class="crumb-link h-flex-valign-center" href>
					<span class="b-icon b-icon__home" title="Community Home"></span>
				</a>
			</li>
			
				
					
					
				
				<li class=crumb>
					<span class="b-icon b-icon__chevron-right--gray separator"></span>
					
						<a class=crumb-link href="https://forum.powerbasic.com/forum">Community</a>
					
				</li>
			
				
					
					
				
				<li class=crumb>
					<span class="b-icon b-icon__chevron-right--gray separator"></span>
					
						<a class=crumb-link href="https://forum.powerbasic.com/forum/user-to-user-discussions">User to User Discussions</a>
					
				</li>
			
				
					
					
				
				<li class=crumb>
					<span class="b-icon b-icon__chevron-right--gray separator"></span>
					
						<a class=crumb-link href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code">Source Code Library</a>
					
				</li>
			
		</ul>
		</nav>
	

	

	
	
		
			
			
				
				
				
			
		
			
			
				
				
				
			
		
	

	

	

<ul id=notices class=notices>
	
	
		
		<li class="notice restore" data-notice-id=5 data-notice-persistent=1><b>You are not logged in.</b>  You can browse in the PowerBASIC Community, but you must click Login <i>(top right)</i> before you can post.  If this is your first visit, check out the <a href="https://forum.powerbasic.com/help" target=_blank><b>FAQ</b></a> or <a href="https://forum.powerbasic.com/register" target=_blank><b>Sign Up</b></a>.</li>
	
</ul>


	


	
	<main id=content>
		<div class="canvas-layout-container js-canvas-layout-container">

<div id=canvas-layout-full class=canvas-layout data-layout-id=1>

	

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	







<!-- section 200 -->



<div class="canvas-widget-list section-200 js-sectiontype-global_after_breadcrumb h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	

	

</div>

	

</div>

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	







<!-- section 2 -->



<div class="canvas-widget-list section-2 js-sectiontype-notice h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	
	<!-- *** START WIDGET widgetid:28, widgetinstanceid:18, template:widget_announcement *** -->
	
	


	
	





<div class="b-module canvas-widget default-widget announcement-widget" id=widget_18 data-widget-id=28 data-widget-instance-id=18>
	
	<div class="widget-header h-clearfix">
		
		
			
		

		<div class="module-title h-left">
			
				<h1 class="main-title js-main-title hide-on-editmode">Announcement</h1>
				
				
				
			
		</div>
		
			<div class=module-buttons>
				
					<span class="toggle-button module-button-item collapse" title=Collapse data-toggle-title=Expand><span class="b-icon b-icon__toggle-collapse">Collapse</span></span>
				
			</div>
		
	</div>
	

	<div class=widget-content>
		
			
				<div class=announcement-tabs>
					<ul>
						
						
							
							<li><a href="https://forum.powerbasic.com/#announcementtabs-18-13"></a></li>
						
						
					</ul>
					
					
						<div id=announcementtabs-18-13 class=tab data-index=0 data-id=13>
							
							
							<h3>Forum Guidelines</h3>
							<div class="announcementtext restore h-hide"><b>This forum is for finished source code that is working properly.</b>   If you have <i>questions</i> about this or any other source code, please post it in one of the Discussion Forums, not here.</div>
						</div>
					
					<div class="condense-text h-hide">
						<div class=see-more>See more</div>
						<div class=see-less>See less</div>
					</div>
					
				</div>
				
			
				
	</div>
</div>
	<!-- *** END WIDGET widgetid:28, widgetinstanceid:18, template:widget_announcement *** -->

	<!-- *** START WIDGET widgetid:51, widgetinstanceid:19, template:widget_pagetitle *** -->
	
	


	
	





	
	
	
		
		
	







	




	



<div class="b-module canvas-widget default-widget page-title-widget widget-no-header-buttons widget-no-border" id=widget_19 data-widget-id=51 data-widget-instance-id=19>
	
	<div class="widget-header h-clearfix">
		
		

		<div class="module-title h-left">
			
				<h1 class="main-title js-main-title hide-on-editmode">Microsoft Script Control wrapper functions</h1>
				
				
				
			
		</div>
		
			<div class=module-buttons>
				
					<span class="toggle-button module-button-item collapse" title=Collapse data-toggle-title=Expand><span class="b-icon b-icon__toggle-collapse">Collapse</span></span>
				
			</div>
		
	</div>
	


	
	

</div>
	<!-- *** END WIDGET widgetid:51, widgetinstanceid:19, template:widget_pagetitle *** -->


	

</div>

	

</div>

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	

	
	







<!-- section 0 -->



<div class="canvas-widget-list section-0 js-sectiontype-primary js-sectiontype-secondary h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	
	<!-- *** START WIDGET widgetid:6, widgetinstanceid:20, template:widget_conversationdisplay *** -->
	



	
		
	
	
		
			
		
	

	
	
	
	
		
		
		
		
		

		
			
			
			

			
			
			
			
				
			
			
			

			
				
			
			

			

			

			
				
					
				
				
				
				
				
				
			

			

			

			

			
			
			

			
			

			
				
			

			
				
				
				
			

			
			

			
				
			


			
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			
				
					
					
					
				
				
					
				
			

			
			
			

			
				
				
					
				

				
			

			
			
			
			
			
			

		
	

	
	
	
		
		
		 
	

	
	
	
		
		
	

	<div class="b-module canvas-widget default-widget conversation-content-widget  forum-conversation-content-widget widget-tabs widget-no-border widget-no-header-buttons  axd-container" id=widget_20 data-widget-id=6 data-widget-instance-id=20 data-widget-default-tab="#thread-view-tab">
		
			<div class=conversation-status-messages>
				
				
				
				
				<div class="conversation-status-message notice h-hide"><span></span><div class=close>X</div></div>
			</div>

			<div class="widget-header h-clearfix">
				<div class="module-title h-left main-header-title">
					
				</div>
				<div class=module-buttons>
					<span class="toggle-button module-button-item collapse" title=Collapse data-toggle-title=Expand><span class="b-icon b-icon__toggle-collapse">Collapse</span></span>
				</div>
				
				
				<div class="conversation-controls h-right h-clear hide-on-editmode b-button-group h-margin-bottom-l js-movable-toolbar-button-container">
					
				</div>
				
					<div class="widget-tabs-nav h-clear">
						<a id=topic-module-top class="anchor js-module-top-anchor"></a>
						
						<ul class="ui-tabs-nav hide-on-editmode h-left b-comp-menu-horizontal js-module-tab-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive">
							
							
							<li><a href="https://forum.powerbasic.com/#thread-view-tab" data-href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?view=thread">Posts</a></li>
							
							<li><a href="https://forum.powerbasic.com/#stream-view-tab" data-href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?view=stream">Latest Activity</a></li>
							
							<li><a href="https://forum.powerbasic.com/#media-view-tab" data-href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?view=media">Photos</a></li>
						</ul>
					</div>
				
			</div>
			<div class="widget-content tab widget-tabs-panel">
				<input type=hidden name=canmoderate id=canmoderate value=0 />
				
					
					
					
					
				
				<div id=thread-view-tab class="conversation-view conversation-thread-view">
					
						
					
					
						
							
						
					

					


	
		
	



	











<div class="conversation-toolbar-wrapper  top h-clear hide-on-editmode
	
		scrolltofixed-floating
		scrolltofixed-top
	
" data-allow-history=1>
	<div class=conversation-toolbar>


		

		
			
			<div class=toolset-left>

				
				<div class="conversation-toolbar-height-shim js-shrink-event-child">
					<div class=b-button> </div>
				</div>

			</div>
		
		

		

		<ul class="toolset-right js-shrink-event-parent">

			
				<li class="toolbar-search h-hide-on-small js-shrink-event-child">
					<form name=toolbar-search-form action="activity/get" method=post class=toolbar-search-form>
						<input type=hidden name=nodeid value=25177 />
						<input type=hidden name=view value=thread />
						
							<input type=hidden name=per-page value=20 />
							<input type=hidden name=pagenum value=1 />
						

						<div class="js-toolbar-search-inner b-form-input__input-with-button-container b-form-input__input-with-button-container--full">

							<input type=text name=q value class="b-form-input__input b-form-input__input--with-button b-form-input__input--shadow js-filter-search" placeholder=Search data-filter-name=Search />

							<button type=submit name=btnSearch id=btnSearch-top class=b-form-input__inside-button><span class="b-form-input__inside-button-icon b-icon b-icon__search-gray-s">Search</span></button>

						</div>

					</form>
				</li>
				<li class="h-hide-on-small js-shrink-event-child">
					<div class=toolbar-divider>
						<span class=toolbar-divider-inner></span>
					</div>
				</li>
			

			
			
				
			

			
			
				<li class="toolbar-pagenav js-toolbar-pagenav h-hide-on-xsmall js-shrink-event-child">
					<div class=toolbar-pagenav-wrapper>
						<!-- Page Nav controls -->











<div class="pagenav-controls ">
	<form class="pagenav-form h-clearfix" action="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions">
		<input type=hidden class=defaultpage value=1 />
		
		<div class="pagenav h-left">
			Page <input type=text name=page class="js-pagenum textbox h-padding-horiz-none b-form-input__input--shadow" value=1 /> of <span class=pagetotal>1</span>
		</div>

		<div class="horizontal-arrows h-left">
			<a class="arrow left-arrow h-disabled" title="Previous Page" rel=prev><span class="vb-icon vb-icon-arrow-left"></span></a>
			<a class="arrow right-arrow h-disabled" title="Next Page" rel=next><span class="vb-icon vb-icon-arrow-right"></span></a>
		</div>
	</form>	
</div>
					</div>
				</li>
				
					<li class="h-hide-on-xsmall js-shrink-event-child">
						<div class=toolbar-divider>
							<span class=toolbar-divider-inner></span>
						</div>
					</li>
				
			

			
				<li class="toolbar-filter toolbar-filter-top js-shrink-event-child">
					<div class="filter-wrapper h-clearfix js-button" tabindex=0>
						<div class="label h-left">Filter</div>
						<div class="arrow vb-icon-wrapper h-left"><span class="vb-icon vb-icon-triangle-down-wide"></span></div>
					</div>
				</li>
			

			

			
		</ul>
	</div>


	

	
		
			
		
		
		<form action="activity/get" method=post class="toolbar-filter-overlay h-clearfix">
			<input type=hidden name=nodeid value=25177 />
			<input type=hidden name=view value=thread />
			
			
			
			
				<input type=hidden name=nolimit value=1 />
			
			
				<input type=hidden name=per-page value=20 />
				<input type=hidden name=pagenum value=1 />
			
			
			
			
				<input type=hidden name=userid value=0 />
			
			
			
			<input type=hidden name=showChannelInfo value=1 />
			<ul class=filter-options-list>
				
				
				<li>
					<div class=filter-header>Time</div>
					<div class=filter-options>
						
						
						
						
						
						
						
						
						
							
						
						
						
						

						
							<label><input type=radio name=filter_time value=time_all checked=checked class=js-default-checked /><span>All Time</span></label>
						
						<label><input type=radio name=filter_time value=time_today /><span>Today</span></label>
						<label><input type=radio name=filter_time value=time_lastweek /><span>Last Week</span></label>
						<label><input type=radio name=filter_time value=time_lastmonth /><span>Last Month</span></label>
					</div>
				</li>
				

				

				
				<li>
					<div class=filter-header>Show</div>
					<div class=filter-options>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
							
						
						
						
						

						<label><input type=radio name=filter_show value=show_all checked=checked class=js-default-checked /><span>All</span></label>
						<label><input type=radio name=filter_show value=vBForum_Text /><span>Discussions only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Gallery /><span>Photos only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Video /><span>Videos only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Link /><span>Links only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Poll /><span>Polls only</span></label>
						<label><input type=radio name=filter_show value=vBForum_Event /><span>Events only</span></label>
					</div>
				</li>
				
				
				
				
				
				

				

				
				<!-- end if prefixsets -->
			</ul>
		</form>

		

		<div class="filtered-by h-clearfix h-hide">
			<label>Filtered by:</label>
			<div class="filter-text-wrapper h-left">
				
				
				
			</div>
			<a href="https://forum.powerbasic.com/#" class="clear-all h-hide">Clear All</a>
		</div>
		<div class=new-conversations-strip><span></span> new posts</div>
	
</div>



	<div class="h-show-on-xsmall h-right h-margin-top-l js-under-toolbar-pagenav h-margin-bottom-m">
		


	



	


<div class="pagenav-container h-clearfix noselect h-hide pagenav-container--no-margin">
	<div class="js-pagenav pagenav h-right js-shrink-event-parent" data-baseurl="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions">

		

		
		
			<a class="js-pagenav-button js-pagenav-prev-button b-button b-button--secondary h-hide-imp js-shrink-event-child" data-page=0 href tabindex=0>Previous</a>
		

		
		
		
		
		
		<a class="js-pagenav-button b-button b-button--narrow js-shrink-event-child b-button--secondary js-pagenav-button--template h-hide-imp" data-page=0 href=index.html tabindex=0>template</a>

		
		
			<a class="js-pagenav-button js-pagenav-next-button b-button b-button--secondary h-hide-imp js-shrink-event-child" data-page=0 href tabindex=0>Next</a>
		

	</div>
</div>
	</div>

					<div class=conversation-content>
						<ul class="conversation-list list-container h-clearfix   thread-view">
							
								
								
								

								
								
								
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								
									

									

									
										
									
								

								

								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
									

									
										
									
								
							
							
							
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							

							

							
							
							
								
									
									
								
								
									
									<!-- Starter Conversation -->
									
									



	
	


















	
		
	





<li data-node-id=25177 data-node-publishdate=1110646320 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text b-post--first js-conversation-starter h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/CreativeWork">

	
	
	
		<a id=post25177 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%23post25177" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions#post25177" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=Microsoft+Script+Control+wrapper+functions&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%23post25177" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions#post25177">#1
								</a>
							

							

							


						</div>
						<div class=b-media__body>
							
								<h2 class="b-post__title js-post-title b-post__hide-when-deleted">
									
									
									Microsoft Script Control wrapper functions
								</h2>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T08:52:00>12 Mar 2005, 11:52 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						
							<div class="axd axd_first-post">
								
								
								
							</div>
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								The Microsoft Script Control allows the user to write and run scripts<br/>
for any scripting engine, such as VBScript or JScript, both of which<br/>
are included with the Script Control. You can add the run-time functionality<br/>
of any Automation object that exposes methods and properties to the<br/>
Script Control. By combining the run-time functionality of an application<br/>
with a scripting engine, you can create a scripting application that runs<br/>
macros to control the application.<br/>
<br/>
The wrapper functions posted below allow to use the Script Control in<br/>
procedural form. As always, use at your own risk.<br/>
<br/>
The help file, called MSSCRIPT.HLP, is located in the C:\WINDOWS\SYSTEM32 folder.<br/>
<br/>
<b><br/>
13 March 2005 : Added the code in bold font.<br/>
When the "home made" dispatch variant goes out of scope, is set to empty or<br/>
you assign a new value to it, the reference counter is decreased,<br/>
so we need to increment the count with ScriptingAddRef to maintain<br/>
the balance.<br/>
</b><br/>
<br/>
------------------<br/>
<br/>
<br/>
<br/>
<br/>
[This message has been edited by José Roca (edited March 13, 2005).]
							
						</div>
					</div>


	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 







		
			
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		
			<div class="h-margin-bottom-xl h-margin-top-none h-text-size--11" id=content-tags-25177>

	
	
	
	
	
	
		
	

	
		<strong>Tags:</strong>
	

	
		<span class=js-content-tag-none>None</span>
	
</div>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=25177 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class=edit-conversation-container></div>
		



      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
									
									
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292902 data-node-publishdate=1110646380 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292902 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292902%23post292902" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292902#post292902" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292902%23post292902" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292902#post292902">#2</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T08:53:00>12 Mar 2005, 11:53 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Save as MSSCRIPT.INC</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' ********************************************************************************************
' Library name: MSScriptControl
' Version: 1.0
' Documentation string: Microsoft Script Control 1.0
' Library GUID: {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}
' ********************************************************************************************

' ********************************************************************************************
' EXCEPINFO structure
' ********************************************************************************************
TYPE Scripting_EXCEPINFO
   wCode AS WORD               ' An error code describing the error.
   wReserved AS WORD           ' Reserved
   bstrSource AS DWORD         ' Source of the exception.
   bstrDescription AS DWORD    ' Textual description of the error.
   bstrHelpFile AS DWORD       ' Help file path.
   dwHelpContext AS DWORD      ' Help context ID.
   pvReserved AS DWORD         ' Reserved.
   pfnDeferredFillIn AS DWORD  ' Pointer to function that fills in Help and description info.
   scode AS DWORD              ' An error code describing the error.
END TYPE
' ********************************************************************************************

' ********************************************************************************************
' Global error variable
' ********************************************************************************************

GLOBAL ScriptingResult AS LONG

' ********************************************************************************************

' ********************************************************************************************
' Returns a boolean value indicating if an error has happened
' ********************************************************************************************
FUNCTION ScriptingError () AS LONG
  FUNCTION = ISTRUE ScriptingResult
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' Returns a pointer to a specified interface on an object to which a client currently holds an
' interface pointer. You must release the returned interface, when no longer needed, with a call
' to the Release method.
' ********************************************************************************************
FUNCTION ScriptingQueryInterface (BYVAL pthis AS DWORD PTR, BYREF riid AS GUID, BYREF ppvObj AS DWORD) AS LONG
    LOCAL HRESULT AS LONG
    CALL DWORD @@pthis[0] USING ScriptingQueryInterface(pthis, riid, ppvObj) TO HRESULT
    FUNCTION = HRESULT
END FUNCTION
' ********************************************************************************************
[b]
' ********************************************************************************************
' Increments the reference count for an interface on an object. It should be called for every
' new copy of a pointer to an interface on a given object.
' ********************************************************************************************
FUNCTION ScriptingAddRef (BYVAL pthis AS DWORD PTR) AS DWORD
    LOCAL DWRESULT AS LONG
    IF ISFALSE pthis THEN EXIT FUNCTION
    CALL DWORD @@pthis[1] USING ScriptingAddRef(pthis) TO DWRESULT
    FUNCTION = DWRESULT
END FUNCTION
' ********************************************************************************************
[/b]
' ********************************************************************************************
' Decrements the reference count for the calling interface on a object. If the reference count
' on the object falls to 0, the object is freed from memory.
' ********************************************************************************************
FUNCTION ScriptingRelease (BYVAL pthis AS DWORD PTR) AS DWORD
    LOCAL DWRESULT AS DWORD
    IF ISFALSE pthis THEN EXIT FUNCTION
    CALL DWORD @@pthis[2] USING ScriptingRelease(pthis) TO DWRESULT
    FUNCTION = DWRESULT
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' Creates an instance of an object.
' Parameters:
' strProgID
'   Required. String. The program ID or the CLSID of the object to create.
' Return value:
'   The address of a pointer to the IUnknown or IDispatch intercace of the control.
'   Upon failure, the value returned is %NULL.
' ********************************************************************************************
FUNCTION ScriptingCreateObject (BYVAL strProgID AS STRING) AS DWORD

    LOCAL pUnknown AS DWORD             ' IUnknown pointer
    LOCAL pDispatch AS DWORD            ' IDispatch pointer
    LOCAL IID_NULL AS GUID              ' Null GUID
    LOCAL IID_IUnknown AS GUID          ' Iunknown GUID
    LOCAL IID_IDispatch AS GUID         ' IDispatch GUID
    LOCAL ClassID AS GUID               ' CLSID

    ' Standard interface GUIDs
    IID_NULL = GUID$("{00000000-0000-0000-0000-000000000000}")
    IID_IUnknown = GUID$("{00000000-0000-0000-c000-000000000046}")
    IID_IDispatch = GUID$("{00020400-0000-0000-c000-000000000046}")

    ' Exit if strProgID is a null string
    IF strProgID = "" THEN
       ScriptingResult = %E_INVALIDARG
       EXIT FUNCTION
    END IF

    ' Convert the ProgID in a CLSID
    ClassID = CLSID$(strProgID)

    ' If it fails, see if it is a CLSID
    IF ClassID = IID_NULL THEN ClassID = GUID$(strProgID)

    ' If not a valid ProgID or CLSID return an error
    IF ClassID = IID_NULL THEN
       ScriptingResult = %E_INVALIDARG
       EXIT FUNCTION
    END IF

    ' Create an instance of the object
    ' Context: &H17 (%CLSCTX_ALL) =
    ' %CLSCTX_INPROC_SERVER OR %CLSCTX_INPROC_HANDLER OR _
    ' %CLSCTX_LOCAL_SERVER OR %CLSCTX_REMOTE_SERVER
    ScriptingResult = CoCreateInstance(ClassID, BYVAL %NULL, &H17, IID_IUnknown, pUnknown)
    IF ISTRUE ScriptingResult OR ISFALSE pUnknown THEN EXIT FUNCTION

    ' Ask for the dispatch interface
    ScriptingResult = ScriptingQueryInterface(pUnknown, IID_IDispatch, pDispatch)

    ' If it fails, return the Iunknown interface
    IF ISTRUE ScriptingResult OR ISFALSE pDispatch THEN
       FUNCTION = pUnknown
       EXIT FUNCTION
    END IF

    ' Release the IUnknown interface
    ScriptingRelease pUnknown

    ' Return a pointer to the dispatch interface
    FUNCTION = pDispatch

END FUNCTION
' ********************************************************************************************

' *********************************************************************************************
' Puts the address of an object in a variant and marks it as containing a dispatch variable
' Useful when we have a pointer to an interface stored in a DWORD variable and we need to
' pass it to a function that expects a variant. We can't simply pass the pointer by value,
' because the variant must we of the type %VT_DISPATCH.
' *********************************************************************************************
SUB ScriptingMakeDispatchVariant (BYVAL lpObj AS DWORD, BYREF vObj AS VARIANT)
   LOCAL lpvObj AS VARIANTAPI PTR                 ' Pointer to a VARIANTAPI structure
   LET vObj = EMPTY                               ' Make sure is empty to avoid memory leaks
   lpvObj = VARPTR(vObj)                          ' Get the VARIANT address
   @lpvObj.vt = %VT_DISPATCH                      ' Mark it as containing a dispatch variable
   @lpvObj.vd.pdispVal = lpObj                    ' Set the dispatch pointer address
   [b]ScriptingAddRef lpObj                          ' Increment the reference counter[/b]
END SUB
' *********************************************************************************************

' ********************************************************************************************
' Provides access to properties and methods exposed by an object.
' ********************************************************************************************
FUNCTION Scripting_Invoke (BYVAL pthis AS DWORD PTR, BYVAL dispidMember AS LONG, BYREF riid AS GUID, _
    BYVAL lcid AS DWORD, BYVAL wFlags AS WORD, BYREF pdispparams AS DISPPARAMS, BYREF pvarResult AS VARIANT, _
    BYREF pexcepinfo AS Scripting_EXCEPINFO, BYREF puArgErr AS DWORD) AS LONG

    LOCAL HRESULT AS LONG
    CALL DWORD @@pthis[6] USING Scripting_Invoke (pthis, dispidMember, riid, lcid, wFlags, pdispparams, pvarResult, pexcepinfo, puArgErr) TO HRESULT
    FUNCTION = HRESULT

END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' IScriptProcedure interface
' IID: {70841C73-067D-11D0-95D8-00A02463AB28}
' Help string: Describes a procedure
' Attributes: 4304 [&H10D0]  [Hidden] [Dual] [Nonextensible] [Dispatchable]
' ********************************************************************************************

' ********************************************************************************************
' [get_]Name property
' Help string: Name of the procedure
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptProcedure_GetName (BYVAL pthis AS DWORD PTR, BYREF pbstrName AS STRING) AS LONG
' ********************************************************************************************
FUNCTION IScriptProcedure_GetName (BYVAL pthis AS DWORD PTR) AS STRING
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pbstrName AS STRING
    CALL DWORD @@pthis[7] USING Proto_IScriptProcedure_GetName(pthis, pbstrName) TO ScriptingResult
    FUNCTION = ACODE$(pbstrName)
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]NumArgs property
' Help string: Number of arguments that are expected
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptProcedure_GetNumArgs (BYVAL pthis AS DWORD PTR, BYREF pcArgs AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptProcedure_GetNumArgs (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pcArgs AS LONG
    CALL DWORD @@pthis[8] USING Proto_IScriptProcedure_GetNumArgs(pthis, pcArgs) TO ScriptingResult
    FUNCTION = pcArgs
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]HasReturnValue property
' Help string: True if procedure returns a value
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptProcedure_HasReturnValue (BYVAL pthis AS DWORD PTR, BYREF pfHasReturnValue AS INTEGER) AS LONG
' ********************************************************************************************
FUNCTION IScriptProcedure_HasReturnValue (BYVAL pthis AS DWORD PTR) AS INTEGER
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pfHasReturnValue AS INTEGER
    CALL DWORD @@pthis[9] USING Proto_IScriptProcedure_HasReturnValue(pthis, pfHasReturnValue) TO ScriptingResult
    FUNCTION = pfHasReturnValue
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' IScriptProcedureCollection interface
' IID: {70841C71-067D-11D0-95D8-00A02463AB28}
' ********************************************************************************************

' ********************************************************************************************
' [get_]_NewEnum property
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptProcedureCollection_NewEnum (BYVAL pthis AS DWORD PTR, BYREF ppenumProcedures AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptProcedureCollection_NewEnum (BYVAL pthis AS DWORD PTR) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppenumProcedures AS DWORD
    CALL DWORD @@pthis[7] USING Proto_IScriptProcedureCollection_NewEnum(pthis, ppenumProcedures) TO ScriptingResult
    FUNCTION = ppenumProcedures
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Item property
' Help string: Get a procedure indexed by position or procedure name
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptProcedureCollection_GetItem (BYVAL pthis AS DWORD PTR, BYVAL Index AS VARIANT, BYREF ppdispProcedure AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptProcedureCollection_GetItem (BYVAL pthis AS DWORD PTR, BYVAL Index AS VARIANT) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppdispProcedure AS DWORD
    CALL DWORD @@pthis[8] USING Proto_IScriptProcedureCollection_GetItem(pthis, Index, ppdispProcedure) TO ScriptingResult
    FUNCTION = ppdispProcedure
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Count property
' Help string: Number of procedures
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptProcedureCollection_GetCount (BYVAL pthis AS DWORD PTR, BYREF plCount AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptProcedureCollection_GetCount (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL plCount AS LONG
    CALL DWORD @@pthis[9] USING Proto_IScriptProcedureCollection_GetCount(pthis, plCount) TO ScriptingResult
    FUNCTION = plCount
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' IScriptModule interface
' IID: {70841C70-067D-11D0-95D8-00A02463AB28}
' Help string: Context in which functions can be defined and expressions can be evaluated
' ********************************************************************************************

' ********************************************************************************************
' [get_]Name property
' Help string: Name of the module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModule_GetName (BYVAL pthis AS DWORD PTR, BYREF pbstrName AS STRING) AS LONG
' ********************************************************************************************
FUNCTION IScriptModule_GetName (BYVAL pthis AS DWORD PTR) AS STRING
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pbstrName AS STRING
    CALL DWORD @@pthis[7] USING Proto_IScriptModule_GetName(pthis, pbstrName) TO ScriptingResult
    FUNCTION = ACODE$(pbstrName)
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]CodeObject property
' Help string: Object exposed by the scripting engine that contains methods and properties defined in the code added to the module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModule_GetCodeObject (BYVAL pthis AS DWORD PTR, BYREF ppdispObject AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptModule_GetCodeObject (BYVAL pthis AS DWORD PTR) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppdispObject AS DWORD
    CALL DWORD @@pthis[8] USING Proto_IScriptModule_GetCodeObject(pthis, ppdispObject) TO ScriptingResult
    FUNCTION = ppdispObject
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Procedures property
' Help string: Collection of procedures that are defined in the module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModule_GetProcedures (BYVAL pthis AS DWORD PTR, BYREF ppdispProcedures AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptModule_GetProcedures (BYVAL pthis AS DWORD PTR) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppdispProcedures AS DWORD
    CALL DWORD @@pthis[9] USING Proto_IScriptModule_GetProcedures(pthis, ppdispProcedures) TO ScriptingResult
    FUNCTION = ppdispProcedures
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' AddCode method
' Help string: Add code to the module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModule_AddCode (BYVAL pthis AS DWORD PTR, BYVAL Code AS DWORD) AS LONG
' ********************************************************************************************
SUB IScriptModule_AddCode (BYVAL pthis AS DWORD PTR, BYVAL Code AS STRING)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    Code = UCODE$(Code)
    CALL DWORD @@pthis[10] USING Proto_IScriptModule_AddCode(pthis, BYVAL STRPTR(Code)) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' Eval method
' Help string: Evaluate an expression within the context of the module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModule_Eval (BYVAL pthis AS DWORD PTR, BYVAL Expression AS DWORD, BYREF pvarResult AS VARIANT) AS LONG
' ********************************************************************************************
SUB IScriptModule_Eval (BYVAL pthis AS DWORD PTR, BYVAL Expression AS STRING, BYREF pvarResult AS VARIANT)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    Expression = UCODE$(Expression)
    CALL DWORD @@pthis[11] USING Proto_IScriptModule_Eval(pthis, BYVAL STRPTR(Expression), pvarResult) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' ExecuteStatement method
' Help string: Execute a statement within the context of the module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModule_ExecuteStatement(BYVAL pthis AS DWORD PTR, BYVAL Statement AS DWORD) AS LONG
' ********************************************************************************************
SUB IScriptModule_ExecuteStatement (BYVAL pthis AS DWORD PTR, BYVAL Statement AS STRING)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    Statement = UCODE$(Statement)
    CALL DWORD @@pthis[12] USING Proto_IScriptModule_ExecuteStatement(pthis, BYVAL STRPTR(Statement)) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' Run method
' Help string: Call a procedure defined in the module
' DispID: 2003 [&H000007D3]
' Note: I'm using Invoke in this function because the previous wrapper function that
' did a direct VTable call didn't worked.
' ********************************************************************************************
SUB IScriptModule_Run ( _
    BYVAL pthis AS DWORD PTR, _                         ' VT_PTR &lt;*VT_DISPATCH&gt;
    BYVAL ProcedureName AS STRING, _                    ' VT_BSTR &lt;DYNAMIC UNICODE STRING&gt;  [in]
    BYREF Parameters AS VARIANT, _                      ' VT_ARRAY | VT_VARIANT &lt;VARIANT&gt;  [in]
    BYREF vResult AS VARIANT _                          ' *VT_VARIANT &lt;VARIANT&gt;  [out]
    )

    LOCAL tDispParams AS DISPPARAMS, tExcepInfo AS Scripting_EXCEPINFO, IID_NULL AS GUID, InvokeKind AS LONG, DispID AS LONG, MSScriptControl_ERROR_UARGERR AS LONG
    DIM vArgs(0 TO 1) AS VARIANT  ' Array of arguments

    vArgs(1) = ProcedureName AS STRING
    vArgs(0) = Parameters

    tDispParams.CountArgs = 2
    tDispParams.VariantArgs = VARPTR(vArgs(0))
    DispID = 2003 : InvokeKind = 1  ' %INVOKE_FUNC
    ScriptingResult = Scripting_Invoke(pthis, DispID, IID_NULL, 0, InvokeKind, tDispParams, vResult, tExcepInfo, MSScriptControl_ERROR_UARGERR)
    IF ScriptingResult = %DISP_E_EXCEPTION THEN
       ScriptingResult = tExcepInfo.scode
       IF ISTRUE tExcepInfo.wcode THEN ScriptingResult = tExcepInfo.wcode
    END IF

END SUB
' ********************************************************************************************

' ********************************************************************************************
' IScriptModuleCollection interface
' IID: {70841C6F-067D-11D0-95D8-00A02463AB28}
' Help string: Collection of modules
' ********************************************************************************************

' ********************************************************************************************
' [get_]_NewEnum property
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModuleCollection_NewEnum (BYVAL pthis AS DWORD PTR, BYREF ppenumContexts AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptModuleCollection_NewEnum (BYVAL pthis AS DWORD PTR) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppenumContexts AS DWORD
    CALL DWORD @@pthis[7] USING Proto_IScriptModuleCollection_NewEnum(pthis, ppenumContexts) TO ScriptingResult
    FUNCTION = ppenumContexts
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Item property
' Help string: Get a module indexed by position or module name
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModuleCollection_GetItem (BYVAL pthis AS DWORD PTR, BYVAL Index AS VARIANT, BYREF ppmod AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptModuleCollection_GetItem (BYVAL pthis AS DWORD PTR, BYVAL Index AS VARIANT) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppmod AS DWORD
    CALL DWORD @@pthis[8] USING Proto_IScriptModuleCollection_GetItem(pthis, Index, ppmod) TO ScriptingResult
    FUNCTION = ppmod
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Count property
' Help string: Number of modules
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModuleCollection_GetCount (BYVAL pthis AS DWORD PTR, BYREF plCount AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptModuleCollection_GetCount (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL plCount AS LONG
    CALL DWORD @@pthis[9] USING Proto_IScriptModuleCollection_GetCount(pthis, plCount) TO ScriptingResult
    FUNCTION = plCount
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' Add method
' Help string: Add a new module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptModuleCollection_Add(BYVAL pthis AS DWORD PTR, BYVAL pbstrName AS DWORD, BYREF varPrmObject AS VARIANT, BYREF ppmod AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptModuleCollection_Add (BYVAL pthis AS DWORD PTR, BYVAL pbstrName AS STRING, OPTIONAL BYVAL varPrmObject AS VARIANT) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    pbstrName = UCODE$(pbstrName)
    LOCAL ppmod AS DWORD
    IF VARIANTVT(varPrmObject) = %VT_EMPTY THEN varPrmObject = ERROR %DISP_E_PARAMNOTFOUND
    CALL DWORD @@pthis[10] USING Proto_IScriptModuleCollection_Add(pthis, BYVAL STRPTR(pbstrName), varPrmObject, ppmod) TO ScriptingResult
    FUNCTION = ppmod
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' IScriptError interface
' IID: {70841C78-067D-11D0-95D8-00A02463AB28}
' Help string: Provides access to scripting error information
' ********************************************************************************************

' ********************************************************************************************
' [get_]Number property
' Help string: Error number
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptError_GetNumber (BYVAL pthis AS DWORD PTR, BYREF plNumber AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptError_GetNumber (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL plNumber AS LONG
    CALL DWORD @@pthis[7] USING Proto_IScriptError_GetNumber(pthis, plNumber) TO ScriptingResult
    FUNCTION = plNumber
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Source property
' Help string: Source of the error
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptError_GetSource (BYVAL pthis AS DWORD PTR, BYREF pbstrSource AS STRING) AS LONG
' ********************************************************************************************
FUNCTION IScriptError_GetSource (BYVAL pthis AS DWORD PTR) AS STRING
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pbstrSource AS STRING
    CALL DWORD @@pthis[8] USING Proto_IScriptError_GetSource(pthis, pbstrSource) TO ScriptingResult
    FUNCTION = ACODE$(pbstrSource)
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Description property
' Help string: Friendly description of error
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptError_GetDescription (BYVAL pthis AS DWORD PTR, BYREF pbstrDescription AS STRING) AS LONG
' ********************************************************************************************
FUNCTION IScriptError_GetDescription (BYVAL pthis AS DWORD PTR) AS STRING
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pbstrDescription AS STRING
    CALL DWORD @@pthis[9] USING Proto_IScriptError_GetDescription(pthis, pbstrDescription) TO ScriptingResult
    FUNCTION = ACODE$(pbstrDescription)
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]HelpFile property
' Help string: File in which help for the error can be found
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptError_GetHelpFile (BYVAL pthis AS DWORD PTR, BYREF pbstrHelpFile AS STRING) AS LONG
' ********************************************************************************************
FUNCTION IScriptError_GetHelpFile (BYVAL pthis AS DWORD PTR) AS STRING
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pbstrHelpFile AS STRING
    CALL DWORD @@pthis[10] USING Proto_IScriptError_GetHelpFile(pthis, pbstrHelpFile) TO ScriptingResult
    FUNCTION = ACODE$(pbstrHelpFile)
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]HelpContext property
' Help string: Context ID for the topic with information on the error
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptError_GetHelpContext (BYVAL pthis AS DWORD PTR, BYREF plHelpContext AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptError_GetHelpContext (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL plHelpContext AS LONG
    CALL DWORD @@pthis[11] USING Proto_IScriptError_GetHelpContext(pthis, plHelpContext) TO ScriptingResult
    FUNCTION = plHelpContext
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Text property
' Help string: Line of source code on which the error occurred
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptError_GetText (BYVAL pthis AS DWORD PTR, BYREF pbstrText AS STRING) AS LONG
' ********************************************************************************************
FUNCTION IScriptError_GetText (BYVAL pthis AS DWORD PTR) AS STRING
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pbstrText AS STRING
    CALL DWORD @@pthis[12] USING Proto_IScriptError_GetText(pthis, pbstrText) TO ScriptingResult
    FUNCTION = ACODE$(pbstrText)
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Line property
' Help string: Source code line number where the error occurred
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptError_GetLine (BYVAL pthis AS DWORD PTR, BYREF plLine AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptError_GetLine (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL plLine AS LONG
    CALL DWORD @@pthis[13] USING Proto_IScriptError_GetLine(pthis, plLine) TO ScriptingResult
    FUNCTION = plLine
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Column property
' Help string: Source code column position where the error occurred
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptError_GetColumn (BYVAL pthis AS DWORD PTR, BYREF plColumn AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptError_GetColumn (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL plColumn AS LONG
    CALL DWORD @@pthis[14] USING Proto_IScriptError_GetColumn(pthis, plColumn) TO ScriptingResult
    FUNCTION = plColumn
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' Clear method
' Help string: Clear the script error
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptError_Clear (BYVAL pthis AS DWORD PTR) AS LONG
' ********************************************************************************************
SUB IScriptError_Clear (BYVAL pthis AS DWORD PTR)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    LOCAL ScriptingResult AS LONG
    CALL DWORD @@pthis[15] USING Proto_IScriptError_Clear(pthis) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' IScriptControl interface
' IID: {0E59F1D3-1FBE-11D0-8FF2-00A0D10038BC}
' Help string: Control to host scripting engines that understand the ActiveX Scripting interface
' Attributes: 4304 [&H10D0]  [Hidden] [Dual] [Nonextensible] [Dispatchable]
' ********************************************************************************************

' ********************************************************************************************
' [get_]Language property
' Help string: Language engine to use
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetLanguage (BYVAL pthis AS DWORD PTR, BYREF pbstrLanguage AS STRING) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetLanguage (BYVAL pthis AS DWORD PTR) AS STRING
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pbstrLanguage AS STRING
    CALL DWORD @@pthis[7] USING Proto_IScriptControl_GetLanguage(pthis, pbstrLanguage) TO ScriptingResult
    FUNCTION = ACODE$(pbstrLanguage)
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [put_]Language property
' Help string: Language engine to use
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_SetLanguage(BYVAL pthis AS DWORD PTR, BYVAL pbstrLanguage AS DWORD) AS LONG
' ********************************************************************************************
SUB IScriptControl_SetLanguage (BYVAL pthis AS DWORD PTR, BYVAL pbstrLanguage AS STRING)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    pbstrLanguage = UCODE$(pbstrLanguage)
    CALL DWORD @@pthis[8] USING Proto_IScriptControl_SetLanguage(pthis, BYVAL STRPTR(pbstrLanguage)) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' [get_]State property
' Help string: State of the control
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetState (BYVAL pthis AS DWORD PTR, BYREF pssState AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetState (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pssState AS LONG
    CALL DWORD @@pthis[9] USING Proto_IScriptControl_GetState(pthis, pssState) TO ScriptingResult
    FUNCTION = pssState
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [put_]State property
' Help string: State of the control
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_SetState (BYVAL pthis AS DWORD PTR, BYVAL pssState AS LONG) AS LONG
' ********************************************************************************************
SUB IScriptControl_SetState (BYVAL pthis AS DWORD PTR, BYVAL pssState AS LONG)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    CALL DWORD @@pthis[10] USING Proto_IScriptControl_SetState(pthis, pssState) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' [put_]SitehWnd property
' Help string: hWnd used as a parent for displaying UI
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_SetSitehWnd (BYVAL pthis AS DWORD PTR, BYVAL phwnd AS LONG) AS LONG
' ********************************************************************************************
SUB IScriptControl_SetSitehWnd (BYVAL pthis AS DWORD PTR, BYVAL phwnd AS LONG)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    LOCAL ScriptingResult AS LONG
    CALL DWORD @@pthis[11] USING Proto_IScriptControl_SetSitehWnd(pthis, phwnd) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' [get_]SitehWnd property
' Help string: hWnd used as a parent for displaying UI
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetSitehWnd (BYVAL pthis AS DWORD PTR, BYREF phwnd AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetSitehWnd (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL phwnd AS LONG
    CALL DWORD @@pthis[12] USING Proto_IScriptControl_GetSitehWnd(pthis, phwnd) TO ScriptingResult
    FUNCTION = phwnd
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Timeout property
' Help string: Length of time in milliseconds that a script can execute before being considered hung
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetTimeout (BYVAL pthis AS DWORD PTR, BYREF plMilleseconds AS LONG) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetTimeout (BYVAL pthis AS DWORD PTR) AS LONG
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL plMilleseconds AS LONG
    CALL DWORD @@pthis[13] USING Proto_IScriptControl_GetTimeout(pthis, plMilleseconds) TO ScriptingResult
    FUNCTION = plMilleseconds
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [put_]Timeout property
' Help string: Length of time in milliseconds that a script can execute before being considered hung
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_SetTimeout (BYVAL pthis AS DWORD PTR, BYVAL plMilleseconds AS LONG) AS LONG
' ********************************************************************************************
SUB IScriptControl_SetTimeout (BYVAL pthis AS DWORD PTR, BYVAL plMilleseconds AS LONG)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    CALL DWORD @@pthis[14] USING Proto_IScriptControl_SetTimeout(pthis, plMilleseconds) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' [get_]AllowUI property
' Help string: Enable or disable display of the UI
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetAllowUI (BYVAL pthis AS DWORD PTR, BYREF pfAllowUI AS INTEGER) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetAllowUI (BYVAL pthis AS DWORD PTR) AS INTEGER
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pfAllowUI AS INTEGER
    CALL DWORD @@pthis[15] USING Proto_IScriptControl_GetAllowUI(pthis, pfAllowUI) TO ScriptingResult
    FUNCTION = pfAllowUI
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [put_]AllowUI property
' Help string: Enable or disable display of the UI
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_SetAllowUI (BYVAL pthis AS DWORD PTR, BYVAL pfAllowUI AS INTEGER) AS LONG
' ********************************************************************************************
SUB IScriptControl_SetAllowUI (BYVAL pthis AS DWORD PTR, BYVAL pfAllowUI AS INTEGER)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    IF ISTRUE pfAllowUI THEN pfAllowUI = -1
    CALL DWORD @@pthis[16] USING Proto_IScriptControl_SetAllowUI(pthis, pfAllowUI) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' [get_]UseSafeSubset property
' Help string: Force script to execute in safe mode and disallow potentially harmful actions
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetUseSafeSubset (BYVAL pthis AS DWORD PTR, BYREF pfUseSafeSubset AS INTEGER) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetUseSafeSubset (BYVAL pthis AS DWORD PTR) AS INTEGER
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL pfUseSafeSubset AS INTEGER
    CALL DWORD @@pthis[17] USING Proto_IScriptControl_GetUseSafeSubset(pthis, pfUseSafeSubset) TO ScriptingResult
    FUNCTION = pfUseSafeSubset
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [put_]UseSafeSubset property
' Help string: Force script to execute in safe mode and disallow potentially harmful actions
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_SetUseSafeSubset (BYVAL pthis AS DWORD PTR, BYVAL pfUseSafeSubset AS INTEGER) AS LONG
' ********************************************************************************************
SUB IScriptControl_SetUseSafeSubset (BYVAL pthis AS DWORD PTR, BYVAL pfUseSafeSubset AS INTEGER)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    IF ISTRUE pfUseSafeSubset THEN pfUseSafeSubset = -1
    CALL DWORD @@pthis[18] USING Proto_IScriptControl_SetUseSafeSubset(pthis, pfUseSafeSubset) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' [get_]Modules property
' Help string: Collection of modules for the ScriptControl
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetModules (BYVAL pthis AS DWORD PTR, BYREF ppmods AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetModules (BYVAL pthis AS DWORD PTR) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppmods AS DWORD
    CALL DWORD @@pthis[19] USING Proto_IScriptControl_GetModules(pthis, ppmods) TO ScriptingResult
    FUNCTION = ppmods
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Error property
' Help string: The last error reported by the scripting engine
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetError (BYVAL pthis AS DWORD PTR, BYREF ppse AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetError (BYVAL pthis AS DWORD PTR) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppse AS DWORD
    CALL DWORD @@pthis[20] USING Proto_IScriptControl_GetError(pthis, ppse) TO ScriptingResult
    FUNCTION = ppse
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]CodeObject property
' Help string: Object exposed by the scripting engine that contains methods and properties defined in the code added to the global module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetCodeObject (BYVAL pthis AS DWORD PTR, BYREF ppdispObject AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetCodeObject (BYVAL pthis AS DWORD PTR) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppdispObject AS DWORD
    CALL DWORD @@pthis[21] USING Proto_IScriptControl_GetCodeObject(pthis, ppdispObject) TO ScriptingResult
    FUNCTION = ppdispObject
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' [get_]Procedures property
' Help string: Collection of procedures that are defined in the global module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_GetProcedures (BYVAL pthis AS DWORD PTR, BYREF ppdispProcedures AS DWORD) AS LONG
' ********************************************************************************************
FUNCTION IScriptControl_GetProcedures (BYVAL pthis AS DWORD PTR) AS DWORD
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT FUNCTION
    LOCAL ppdispProcedures AS DWORD
    CALL DWORD @@pthis[22] USING Proto_IScriptControl_GetProcedures(pthis, ppdispProcedures) TO ScriptingResult
    FUNCTION = ppdispProcedures
END FUNCTION
' ********************************************************************************************

' ********************************************************************************************
' _AboutBox method
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_AboutBox (BYVAL pthis AS DWORD PTR) AS LONG
' ********************************************************************************************
SUB IScriptControl_AboutBox (BYVAL pthis AS DWORD PTR)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    CALL DWORD @@pthis[23] USING Proto_IScriptControl_AboutBox(pthis) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' AddObject method
' Help string: Add an object to the global namespace of the scripting engine
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_AddObject(BYVAL pthis AS DWORD PTR, BYVAL pbstrName AS DWORD, BYVAL pObjectDispatch AS DWORD, BYVAL AddMembers AS INTEGER) AS LONG
' ********************************************************************************************
SUB IScriptControl_AddObject (BYVAL pthis AS DWORD PTR, BYVAL pbstrName AS STRING, BYVAL pObjectDispatch AS DWORD, OPTIONAL BYVAL AddMembers AS INTEGER)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    pbstrName = UCODE$(pbstrName)
    IF ISTRUE AddMembers THEN AddMembers = -1
    CALL DWORD @@pthis[24] USING Proto_IScriptControl_AddObject(pthis, BYVAL STRPTR(pbstrName), pObjectDispatch, AddMembers) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' Reset method
' Help string: Reset the scripting engine to a newly created state
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_Reset (BYVAL pthis AS DWORD PTR) AS LONG
' ********************************************************************************************
SUB IScriptControl_Reset (BYVAL pthis AS DWORD PTR)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    LOCAL ScriptingResult AS LONG
    CALL DWORD @@pthis[25] USING Proto_IScriptControl_Reset(pthis) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' AddCode method
' Help string: Add code to the global module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_AddCode(BYVAL pthis AS DWORD PTR, BYVAL Code AS DWORD) AS LONG
' ********************************************************************************************
SUB IScriptControl_AddCode (BYVAL pthis AS DWORD PTR, BYVAL Code AS STRING)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    Code = UCODE$(Code)
    CALL DWORD @@pthis[26] USING Proto_IScriptControl_AddCode(pthis, BYVAL STRPTR(Code)) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' Eval method
' Help string: Evaluate an expression within the context of the global module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_Eval(BYVAL pthis AS DWORD PTR, BYVAL Expression AS DWORD, BYREF pvarResult AS VARIANT) AS LONG
' ********************************************************************************************
SUB IScriptControl_Eval (BYVAL pthis AS DWORD PTR, BYVAL Expression AS STRING, BYREF pvarResult AS VARIANT)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    Expression = UCODE$(Expression)
    CALL DWORD @@pthis[27] USING Proto_IScriptControl_Eval(pthis, BYVAL STRPTR(Expression), pvarResult) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' ExecuteStatement method
' Help string: Execute a statement within the context of the global module
' ********************************************************************************************
DECLARE FUNCTION Proto_IScriptControl_ExecuteStatement(BYVAL pthis AS DWORD PTR, BYVAL Statement AS DWORD) AS LONG
' ********************************************************************************************
SUB IScriptControl_ExecuteStatement (BYVAL pthis AS DWORD PTR, BYVAL Statement AS STRING)
    IF ISFALSE pthis THEN ScriptingResult = -1 : EXIT SUB
    Statement = UCODE$(Statement)
    CALL DWORD @@pthis[28] USING Proto_IScriptControl_ExecuteStatement(pthis, BYVAL STRPTR(Statement)) TO ScriptingResult
END SUB
' ********************************************************************************************

' ********************************************************************************************
' Run method
' Help string: Call a procedure defined in the global module
' DispID: 2003 [&H000007D3]
' Note: I'm using Invoke in this function because the previous wrapper function that
' did a direct VTable call didn't worked.
' ********************************************************************************************
SUB IScriptControl_Run ( _
    BYVAL pthis AS DWORD PTR, _                         ' VT_PTR &lt;*VT_DISPATCH&gt;
    BYVAL ProcedureName AS STRING, _                    ' VT_BSTR &lt;DYNAMIC UNICODE STRING&gt;  [in]
    BYREF Parameters AS VARIANT, _                      ' *VT_ARRAY | VT_VARIANT &lt;VARIANT&gt;  [in]
    BYREF vResult AS VARIANT _                          ' *VT_VARIANT &lt;VARIANT&gt;  [out]
    )

    LOCAL tDispParams AS DISPPARAMS, tExcepInfo AS Scripting_EXCEPINFO, IID_NULL AS GUID, InvokeKind AS LONG, DispID AS LONG, MSScriptControl_ERROR_UARGERR AS LONG
    DIM vArgs(0 TO 1) AS VARIANT  ' Array of arguments

    vArgs(1) = ProcedureName AS STRING
    vArgs(0) = Parameters

    tDispParams.CountArgs = 2
    tDispParams.VariantArgs = VARPTR(vArgs(0))
    DispID = 2003 : InvokeKind = 1  ' %INVOKE_FUNC
    ScriptingResult = Scripting_Invoke(pthis, DispID, IID_NULL, 0, InvokeKind, tDispParams, vResult, tExcepInfo, MSScriptControl_ERROR_UARGERR)
    IF ScriptingResult = %DISP_E_EXCEPTION THEN
       ScriptingResult = tExcepInfo.scode
       IF ISTRUE tExcepInfo.wcode THEN ScriptingResult = tExcepInfo.wcode
    END IF

END SUB
' ********************************************************************************************

' *********************************************************************************************
' Helper function to retrieve error information.
' Adapt it to your own taste and language.
' *********************************************************************************************
Function MSScriptControl_GetErrorInfo (ByVal lpSc As Dword, Optional ByVal lError As Long) As String

   Local strMsg As String
   Local lpError As Dword
   Local lErrorNumber As Long
   Local strErrorSource As String
   Local strErrorDescription As String
   Local strErrorHelpFile As String
   Local lErrorHelpContext As Long
   Local strErrorText As String
   Local lErrorLine As Long
   Local lErrorColumn As Long
   Local ncbBuffer As Dword
   Local pBuffer As Asciiz Ptr

   ' Exit if it is a null pointer
   If lpSc = 0 Then Exit Function

   ' ======================================================
   ' First look at the Error object
   ' ======================================================
   ' Get a reference to the Error interface
   lpError = IScriptControl_GetError(lpSc)
   If lpError Then
      lErrorNumber = IScriptError_GetNumber(lpError)
      If lErrorNumber Then
         strErrorSource = IScriptError_GetSource(lpError)
         strErrorDescription = IScriptError_GetDescription(lpError)
         strErrorText = IScriptError_GetText(lpError)
         lErrorLine = IScriptError_GetLine(lpError)
         lErrorColumn = IScriptError_GetColumn(lpError)
         strMsg = "Error number: " & Format$ (lErrorNumber)& " [&H" & Hex$(lErrorNumber) & "]" & $CRLF & _
                  "Error source: " & strErrorSource & $CRLF & _
                  "Error description: " & strErrorDescription & $CRLF & _
                  "Error text: " & strErrorText & $CRLF & _
                  "Error line: " & Format$(lErrorLine) & $CRLF & _
                  "Error column: " & Format$(lErrorColumn)
         IScriptError_Clear lpError
         ScriptingRelease lpError
         Function = strMsg
         Exit Function
      Else
         ScriptingRelease lpError
         If lError Then strMsg = "Error code:" & Format$(lError) & " [&H" & Hex$(lError, 8) & "]"
      End If
   End If
   ' ======================================================

   Function = strMsg

End Function
' *********************************************************************************************</pre>
</div><br/>
------------------<br/>
<br/>
<br/>
[This message has been edited by José Roca (edited March 13, 2005).]
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292902 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292902 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292902 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292903 data-node-publishdate=1110646500 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292903 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292903%23post292903" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292903#post292903" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292903%23post292903" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292903#post292903">#3</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T08:55:00>12 Mar 2005, 11:55 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Example: Evaluating an executed statement</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' This program uses the ExecuteStatement method to execute an
' statement and then uses Eval to evaluate it.
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32Api.INC"
#Include "MSSCRIPT.INC"         ' Scripting wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local vRes As Variant

   ' ======================================================
   ' Create an instance of the Microsoft Script Control
   ' ======================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ======================================================

   ' ======================================================
   ' Set the language. It can be 'VBScript' or 'JScript'
   ' ======================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ======================================================

   ' ======================================================
   ' In the following code, the ExecuteStatement method
   ' executes the statement and assigns the value 100 to the
   ' variable x. The next two lines use the Eval method to
   ' test the statements x = 100 and x = 100/2.
   ' Note: Since VARIANT# converts %VT_BOOL variants
   ' to LONG, we need to use CINT to convert it to an integer.
   ' ======================================================
   IScriptControl_ExecuteStatement lpSc, "x = 100"
   IScriptControl_Eval lpSc, "x = 100", vRes
   MsgBox Str$(CInt(Variant#(vRes)))  ' -1 - True (in COM, True is -1, not 1)
   IScriptControl_Eval lpSc, "x = 100/2", vRes
   MsgBox Str$(CInt(Variant#(vRes)))  ' 0 - False
   ' ======================================================

   ' ======================================================
   ' Release the ScriptControl interface
   ' ======================================================
   If lpSc Then ScriptingRelease lpSc
   ' ======================================================

End Function
' *************************************************************</pre>
</div><br/>
------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292903 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292903 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292903 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292904 data-node-publishdate=1110646560 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292904 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292904%23post292904" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292904#post292904" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292904%23post292904" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292904#post292904">#4</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T08:56:00>12 Mar 2005, 11:56 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Example: ExecuteStatement and Eval (VBScript)</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' ExecuteStatemnent and Eval (VBScript)
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32Api.INC"
#Include "MSSCRIPT.INC"         ' Scripting wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local strScript As String
   Local vRes As Variant

   ' ==========================================================
   ' Create an instance of the Microsoft Script Control
   ' ==========================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ==========================================================

   ' ==========================================================
   ' Set the language. It can be 'VBScript' or 'JScript'
   ' ==========================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ==========================================================

   ' ==========================================================
   ' Make and execute an script
   ' ==========================================================
   strScript = "Function MyTest" & $CRLF & _
               "  MyTest = ""Hello this is a test""" & $CRLF & _
               "End Function"
   IScriptControl_ExecuteStatement lpSc, StrScript
   If ScriptingError Then GoTo Terminate
   ' ==========================================================

   ' ==========================================================
   ' Evaluate the result of the function 'MyTest'
   ' ==========================================================
   IScriptControl_Eval lpSc, "MyTest", vRes
   If ScriptingError Then GoTo Terminate
   MsgBox Variant$(vRes)
   ' ==========================================================

   ' ==========================================================
   ' Test another script
   ' ==========================================================
   strScript = "Function GetCurrentDate" & $CRLF & _
               "  GetCurrentDate = FormatDateTime(Date, 1)" & $CRLF & _
               "End Function"
   IScriptControl_ExecuteStatement lpSc, StrScript
   If ScriptingError Then GoTo Terminate
   IScriptControl_Eval lpSc, "GetCurrentDate", vRes
   If ScriptingError Then GoTo Terminate
   MsgBox Variant$(vRes)
   ' ==========================================================

   ' ==========================================================
   ' And another one
   ' ==========================================================
   strScript = "Function ReportFolderStatus(fldr)" & $CRLF & _
               "   Dim fso, msg" & $CRLF & _
               "   Set fso = CreateObject(""Scripting.FileSystemObject"")" & $CRLF & _
               "   If (fso.FolderExists(fldr)) Then" & $CRLF & _
               "      msg = fldr & "" exists.""" & $CRLF & _
               "   Else" & $CRLF & _
               "      msg = fldr & "" does Not exists.""" & $CRLF & _
               "   End If" & $CRLF & _
               "   ReportFolderStatus = msg" & $CRLF & _
               "End Function"
   IScriptControl_ExecuteStatement lpSc, StrScript
   If ScriptingError Then GoTo Terminate
   IScriptControl_Eval lpSc, "ReportFolderStatus(""C:\WINNT"")", vRes
   If ScriptingError Then GoTo Terminate
   MsgBox Variant$(vRes)
   ' ==========================================================

Terminate:

   ' ==========================================================
   ' Show error information
   ' ==========================================================
   If ScriptingResult Then
      MsgBox MSScriptControl_GetErrorInfo(lpSc, ScriptingResult)
   End If
   ' ==========================================================

   ' ==========================================================
   ' Release the ScriptControl interface
   ' ==========================================================
   If lpSc Then ScriptingRelease lpSc
   ' ==========================================================

End Function
' *************************************************************</pre>
</div>------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292904 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292904 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292904 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292905 data-node-publishdate=1110646620 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292905 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292905%23post292905" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292905#post292905" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292905%23post292905" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292905#post292905">#5</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T08:57:00>12 Mar 2005, 11:57 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Example: ExecuteStatement and Eval (JScript)</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' ExecuteStatemnent and Eval (JScript)
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32Api.INC"
#Include "MSSCRIPT.INC"         ' Scripting wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local strScript As String
   Local vRes As Variant

   ' ==========================================================
   ' Create an instance of the Microsoft Script Control
   ' ==========================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ==========================================================

   ' ==========================================================
   ' Set the language. It can be 'VBScript' or 'JScript'
   ' ==========================================================
   IScriptControl_SetLanguage lpSc, "JScript"
   ' ==========================================================

   ' ==========================================================
   ' Make and evaluate a JScript
   ' ==========================================================
   strScript = "function Calculate(num) {" & $CRLF & _
               "   if( num &lt; 2 ) return 1;" & $CRLF & _
               "   return num*Calculate(num-1);" & $CRLF & _
               "}"
   IScriptControl_ExecuteStatement lpSc, StrScript
   If ScriptingError Then GoTo Terminate
   IScriptControl_Eval lpSc, "Calculate(6)", vRes
   If ScriptingError Then GoTo Terminate
   MsgBox Str$(Variant#(vRes))
   ' ==========================================================

Terminate:

   ' ==========================================================
   ' Show error information
   ' ==========================================================
   If ScriptingResult Then
      MsgBox MSScriptControl_GetErrorInfo(lpSc, ScriptingResult)
   End If
   ' ==========================================================

   ' ==========================================================
   ' Release the ScriptControl interface
   ' ==========================================================
   If lpSc Then ScriptingRelease lpSc
   ' ==========================================================

End Function
' *************************************************************</pre>
</div><br/>
------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292905 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292905 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292905 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292906 data-node-publishdate=1110646680 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292906 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292906%23post292906" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292906#post292906" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292906%23post292906" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292906#post292906">#6</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T08:58:00>12 Mar 2005, 11:58 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Example: Retrieving error information</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' IScriptControl_Run
' This example contains a division by zero, which throws an
' error. The helper function MSScriptControl_GetErrorInfo
' retrieves rich error information about the error calling
' the properties of the Error object.
' *************************************************************
' Note: When using the IScriptControl_Run procedure, the called
' function or procedure in the script must have a parameter,
' even if the function or procedure doesn't use it.
' This parameter is a variant that contains a safearray of
' variants. When no parameters are needed, such in this example,
' simply pass an empty variant.
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32Api.INC"
#Include "MSSCRIPT.INC"         ' Scripting wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local strScript As String
   Local vRes As Variant
   Local vPrm As Variant

   ' ======================================================
   ' Create an instance of the Microsoft Script Control
   ' ======================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ======================================================

   ' ======================================================
   ' Set the language. It can be 'VBScript' or 'JScript'
   ' ======================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ======================================================

   ' ======================================================
   ' Make and execute an script.
   ' Will throw a division by zero error.
   ' ======================================================
   strScript = "Sub DivideByZero(vPrms)" & $CRLF & _
               "   Dim prime" & $CRLF & _
               "   prime = 3" & $CRLF & _
               "   MsgBox prime/0" & $CRLF & _
               "End Sub"

   IScriptControl_AddCode lpSc, StrScript
   If ScriptingError Then GoTo Terminate

   ' Run the script
   vPrm = Empty  ' No parameters
   IScriptControl_Run lpSc, "DivideByZero", vPrm, vRes
   ' ======================================================

Terminate:

   ' ==========================================================
   ' Show error information
   ' ==========================================================
   If ScriptingResult Then
      MsgBox MSScriptControl_GetErrorInfo(lpSc, ScriptingResult)
   End If
   ' ==========================================================

   ' ======================================================
   ' Release the ScriptControl interface
   ' ======================================================
   If lpSc Then ScriptingRelease lpSc
   ' ======================================================

End Function
' *************************************************************</pre>
</div>------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292906 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292906 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292906 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292907 data-node-publishdate=1110646740 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292907 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292907%23post292907" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292907#post292907" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292907%23post292907" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292907#post292907">#7</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T08:59:00>12 Mar 2005, 11:59 AM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Example: Passing parameters</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' This example shows how to pass parameters to a procedure or
' function that is executed using IScriptControl_Run.
' Parameters are passed in a variant that contains a safearray
' of variants, that are accessed in the script as any array.
' The called function or procedure in the script must have a
' parameter, even if doesn't make use it. When no parameters
' are needed, simply pass an empty variant.
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32Api.INC"
#Include "MSSCRIPT.INC"         ' Scripting wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local strScript As String
   Local vRes As Variant

   ' ======================================================
   ' Create an instance of the Microsoft Script Control
   ' ======================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ======================================================

   ' ======================================================
   ' Set the language. It can be 'VBScript' or 'JScript'
   ' ======================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ======================================================

   ' ======================================================
   ' Make and execute an script
   ' ======================================================
   strScript = "Sub Multiply(vPrms)" & $CRLF & _
               "   Dim result" & $CRLF & _
               "   result = vPrms(0) * vPrms(1)" & $CRLF & _
               "   MsgBox result" & $CRLF & _
               "End Sub"

   IScriptControl_AddCode lpSc, StrScript
   If ScriptingError Then GoTo Terminate

   IScriptControl_SetAllowUI lpSc, -1
   If ScriptingError Then GoTo Terminate

   DIM vParameters AS VARIANT
   DIM vParams(1) AS VARIANT
   vParams(0) = 20 AS LONG
   vParams(1) = 6 AS LONG
   vParameters = vParams()

   ' Run the script
   IScriptControl_Run lpSc, "Multiply", vParameters, vRes


Terminate:

   ' ==========================================================
   ' Show error information
   ' ==========================================================
   If ScriptingResult Then
      MsgBox MSScriptControl_GetErrorInfo(lpSc, ScriptingResult)
   End If
   ' ==========================================================

   ' ======================================================
   ' Release the ScriptControl interface
   ' ======================================================
   If lpSc Then ScriptingRelease lpSc
   ' ======================================================

End Function
' *************************************************************</pre>
</div><br/>
------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292907 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292907 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292907 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292908 data-node-publishdate=1110646860 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292908 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292908%23post292908" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292908#post292908" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292908%23post292908" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292908#post292908">#8</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T09:01:00>12 Mar 2005, 12:01 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Example: Returning a result</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' This example shows how to pass parameters to a function that
' is executed using the Run method and how the function returns
' the result.
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32Api.INC"
#Include "MSSCRIPT.INC"         ' Scripting wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local strScript As String
   Local vRes As Variant

   ' ======================================================
   ' Create an instance of the Microsoft Script Control
   ' ======================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ======================================================

   ' ======================================================
   ' Set the language. It can be 'VBScript' or 'JScript'
   ' ======================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ======================================================

   ' ======================================================
   ' Make and execute an script
   ' ======================================================
   strScript = "Function Multiply(vPrms)" & $CRLF & _
               "   Dim result" & $CRLF & _
               "   result = vPrms(0) * vPrms(1)" & $CRLF & _
               "   Multiply = result" & $CRLF & _
               "End Function"

   IScriptControl_AddCode lpSc, StrScript
   If ScriptingError Then GoTo Terminate


   IScriptControl_SetAllowUI lpSc, -1
   If ScriptingError Then GoTo Terminate

   Dim vParameters As Variant
   Dim vParams(1) As Variant
   vParams(0) = 20 As Long
   vParams(1) = 6 As Long
   vParameters = vParams()

   ' Run the script
   IScriptControl_Run lpSc, "Multiply", vParameters, vRes
   MsgBox "Result: " & Str$(Variant#(vRes))


Terminate:

   ' ==========================================================
   ' Show error information
   ' ==========================================================
   If ScriptingResult Then
      MsgBox MSScriptControl_GetErrorInfo(lpSc, ScriptingResult)
   End If
   ' ==========================================================

   ' ======================================================
   ' Release the ScriptControl interface
   ' ======================================================
   If lpSc Then ScriptingRelease lpSc
   ' ======================================================

End Function
' *************************************************************</pre>
</div><br/>
------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292908 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292908 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292908 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292909 data-node-publishdate=1110646920 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292909 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292909%23post292909" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292909#post292909" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292909%23post292909" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292909#post292909">#9</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T09:02:00>12 Mar 2005, 12:02 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Example: Using PB automation</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' This example shows how to add a module and call it using
' de dotted syntax of the PB Automation.
' Note: Make sure that you write correctly the name of the
' property of method when using OBJECT GET/CALL/LET/SET or the
' program will finish without a warning.
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32Api.INC"
#Include "MSSCRIPT.INC"         ' Scripting wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local strScript As String
   Local lpModules As Dword
   Local lpModule As Dword
   Local lpObj As Dword
   Local vObj As Variant
   Local oObj As Dispatch

   ' ======================================================
   ' Create an instance of the Microsoft Script Control
   ' ======================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ======================================================

   ' ======================================================
   ' Set the language. It can be 'VBScript' or 'JScript'
   ' ======================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ======================================================

   ' ======================================================
   ' Add a new module and a procedure and call it using
   ' PB automation
   ' ======================================================
   ' Get a reference to the modules collection
   lpModules = IScriptControl_GetModules(lpSc)
   If IsTrue lpModules Then
      ' Add a new module
      lpModule = IScriptModuleCollection_Add(lpModules, "MyModule")
      If IsTrue lpModule Then
         ' Add a procedure to the module
         strScript = "Sub Hello" & $CRLF & _
                     "   Msgbox ""Hello World""" & $CRLF & _
                     "End Sub"
         IScriptModule_AddCode lpModule, strScript
         ' Get the dispatch interface of the module
         lpObj = IScriptModule_GetCodeObject(lpModule)
         If IsTrue lpObj Then
            ' Covert the pointer to a dispatch variant
            ScriptingMakeDispatchVariant lpObj, vObj
            Set oObj = vObj
            vObj = Empty
            ' Use PB automation to call the procedure
            If IsTrue IsObject(oObj) Then
               Object Call oObj.Hello
               Set oObj = Nothing
            End If
         End If
         ScriptingRelease lpModule
      End If
      ScriptingRelease lpModules
   End If
   ' ======================================================

   ' ======================================================
   ' Release the ScriptControl interface
   ' ======================================================
   If lpSc Then ScriptingRelease lpSc
   ' ======================================================

End Function
' *************************************************************</pre>
</div>------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292909 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292909 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292909 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292910 data-node-publishdate=1110646980 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292910 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292910%23post292910" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292910#post292910" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292910%23post292910" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292910#post292910">#10</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T09:03:00>12 Mar 2005, 12:03 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Example: Using functions with PB automation</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' This example shows how to add a module and call it using
' de dotted syntax of the PB Automation, passing parameters
' and retrieving the result.
' Note: Make sure that you write correctly the name of the
' property of method when using OBJECT GET/CALL/LET/SET or the
' program will finish without a warning.
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32APi.INC"
#Include "MSSCRIPT.INC"   ' Microsoft Scripting Runtime wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local strScript As String
   Local lpModules As Dword
   Local lpModule As Dword
   Local lpObj As Dword
   Local vObj As Variant
   Local oObj As Dispatch
   Local vPrm1 As Variant
   Local vPrm2 As Variant
   Local vRes As Variant

   ' ==========================================================
   ' Create an instance of the Microsoft Script Control
   ' ==========================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ==========================================================

   ' ==========================================================
   ' Set the language. It can be 'VBScript' or 'JScript'
   ' ==========================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ==========================================================

   ' ==========================================================
   ' Add a new module and a procedure and call it using PB
   ' automation
   ' ==========================================================
   ' Get a reference to the modules collection
   lpModules = IScriptControl_GetModules(lpSc)
   If IsTrue lpModules Then
      ' Add a new module
      lpModule = IScriptModuleCollection_Add(lpModules, "MyModule")
      If IsTrue lpModule Then
         ' Add a procedure to the module
         strScript = "Function Multiply(vPrm1, vPrm2)" & $CRLF & _
                     "   Dim result" & $CRLF & _
                     "   result = vPrm1 * vPrm2" & $CRLF & _
                     "   Multiply = result" & $CRLF & _
                     "End Function"
         IScriptModule_AddCode lpModule, strScript
         ' Get the dispatch interface of the module
         lpObj = IScriptModule_GetCodeObject(lpModule)
         If IsTrue lpObj Then
            ' Covert the pointer to a dispatch variant
            ScriptingMakeDispatchVariant lpObj, vObj
            Set oObj = vObj
            vObj = Empty
            ' Use PB automation to call the procedure
            If IsTrue isobject(oObj) Then
               vPrm1 = 6 : vPrm2 = 5
               Object Call oObj.Multiply(vPrm1, vPrm2) To vRes
               MsgBox "Result: " & str$(Variant#(vRes))
               Set oObj = Nothing
            End If
         End If
         ScriptingRelease lpModule
      End If
      ScriptingRelease lpModules
   End If
   ' ==========================================================

   ' ==========================================================
   ' Release the ScriptControl interface
   ' ==========================================================
   If lpSc Then ScriptingRelease lpSc
   ' ==========================================================

End Function
' *************************************************************</pre>
</div><br/>
------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292910 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292910 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292910 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292911 data-node-publishdate=1110647040 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292911 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292911%23post292911" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292911#post292911" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292911%23post292911" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292911#post292911">#11</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T09:04:00>12 Mar 2005, 12:04 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Example: Using events</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' This example shows how to use events. It contains a deliberate
' error in the script and the Error event is fired.
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32APi.INC"
#Include "MSSCRIPT.INC"   ' Microsoft Scripting Runtime wrapper functions

' *************************************************************
' OnEvent Functions
' *************************************************************

' *************************************************************
' Variants can hold any kind of numeric values. When returning
' one of these values you can assign them directly, e.g. 
' @pvapi[1]<a href="https://forum.powerbasic.com/cdn-cgi/l/email-protection" class=__cf_email__ data-cfemail=dcf2aab8f29cacb08abdb0>[email protected]</a> = -1, but when you need to assign an 
' string or a variant you need to declare a variable of the 
' appropiate kind and pass his address with VARPTR. Strings
' must be converted to unicode with UCODE$.
' *************************************************************

' *************************************************************
' DScriptControlSource dispatch interface
' IID = {8B167D60-8605-11D0-ABCB-00A0C90FFFC0}
' Attributes = 4112 [&H1010]  [Hidden] [Dispatchable]
' Number of functions = 2
' *************************************************************

' *************************************************************
' EXCEPINFO structure
' *************************************************************
Type MSScriptControl_EXCEPINFO
   wCode As Word               ' An error code describing the error.
   wReserved As Word           ' Reserved
   bstrSource As Dword         ' Source of the exception.
   bstrDescription As Dword    ' Textual description of the error.
   bstrHelpFile As Dword       ' Help file path.
   dwHelpContext As Dword      ' Help context ID.
   pvReserved As Dword         ' Reserved.
   pfnDeferredFillIn As Dword  ' Pointer to function that fills in Help and description info.
   scode As Dword              ' An error code describing the error.
End Type
' *************************************************************

' *************************************************************
' Returns a pointer to a specified interface on an object to
' which a client currently holds an interface pointer.
' *************************************************************
Function MSScriptControl_IUnknown_QueryInterface (ByVal pthis As Dword Ptr, _
   ByRef riid As Guid, ByRef ppvObj As Dword) As Long
   Local HRESULT As Long
   Call Dword @@pthis[0] Using MSScriptControl_IUnknown_QueryInterface(pthis, riid, ppvObj) To HRESULT
   Function = HRESULT
End Function
' *************************************************************

' *************************************************************
' Decrements the reference count for the calling interface on a object. If the reference count
' on the object falls to 0, the object is freed from memory.
' *************************************************************
Function MSScriptControl_IUnknown_Release (ByVal pthis As Dword Ptr) As Dword
   Local DWRESULT As Dword
   Call Dword @@pthis[2] Using MSScriptControl_IUnknown_Release(pthis) To DWRESULT
   Function = DWRESULT
End Function
' *************************************************************

' *************************************************************
' IConnectionPointContainer::FindConnectionPoint
' Returns a pointer to the IConnectionPoint interface of a connection point for a specified IID,
' if that IID describes a supported outgoing interface.
' *************************************************************
Function MSScriptControl_IConnectionPointContainer_FindConnectionPoint ( _
   ByVal pthis As Dword Ptr, ByRef riid As Guid, ByRef ppCP As Dword) As Long
   Local HRESULT As Long
   Call Dword @@pthis[4] Using MSScriptControl_IConnectionPointContainer_FindConnectionPoint(pthis, riid, ppCP) To HRESULT
   Function = HRESULT
End Function
' *************************************************************

' *************************************************************
' IConnectionPoint::Advise
' Establishes a connection between the connection point object and the client's sink.
' *************************************************************
Function MSScriptControl_IConnectionPoint_Advise (ByVal pthis As Dword Ptr, _
   ByVal pUnkSink As Dword, ByRef pdwCookie As Dword) As Long
   Local HRESULT As Long
   Call Dword @@pthis[5] Using MSScriptControl_IConnectionPoint_Advise(pthis, pUnkSink, pdwCookie) To HRESULT
   Function = HRESULT
End Function
' *************************************************************

' *************************************************************
' IConnectionPoint::Unadvise
' Terminates an advisory connection previously established through IConnectionPoint_Advise.
' The dwCookie parameter identifies the connection to terminate.
' *************************************************************
Function MSScriptControl_IConnectionPoint_Unadvise (ByVal pthis As Dword Ptr, ByVal dwCookie As Dword) As Long
   Local HRESULT As Long
   Call Dword @@pthis[6] Using MSScriptControl_IConnectionPoint_Unadvise(pthis, dwCookie) To HRESULT
   Function = HRESULT
End Function
' *************************************************************

' *************************************************************
' IDispatch virtual table
' *************************************************************
Type MSScriptControl_IDispatchVtbl
   QueryInterface As Dword     ' Returns pointers to supported interfaces
   AddRef As Dword             ' Increments reference count
   Release As Dword            ' Decrements reference count
   GetTypeInfoCount As Dword   ' Retrieves the number of type descriptions
   GetTypeInfo As Dword        ' Retrieves a description of object's programmable interface
   GetIDsOfNames As Dword      ' Maps name of method or property to DispId
   Invoke As Dword             ' Calls one of the object's methods, or gets/sets one of its properties
   pVtblAddr As Dword          ' Address of the virtual table
   cRef As Dword               ' Reference counter
   pthis As Dword              ' IUnknown or IDispatch of the control that fires the events
End Type
' *************************************************************

' *************************************************************
' UI4 AddRef()
' Increments the reference counter.
' *************************************************************
Function MSScriptControl_AddRef (ByVal pCookie As MSScriptControl_IDispatchVtbl Ptr) As Dword
   Incr @@pCookie.cRef
   Function = @@pCookie.cRef
End Function
' *************************************************************

' *************************************************************
' HRESULT QueryInterface([in] *GUID riid, [out] **VOID ppvObj)
' Returns the IUnknown of our class and increments the reference counter.
' *************************************************************
Function MSScriptControl_QueryInterface (ByVal pCookie As MSScriptControl_IDispatchVtbl Ptr, _
   ByRef riid As Guid, ByRef ppvObj As Dword) As Long
   ppvObj = pCookie
   MSScriptControl_AddRef pCookie
   Function = %S_OK
End Function
' *************************************************************

' *************************************************************
' UI4 Release()
' Releases our class if there is only a reference to him and decrements the reference counter.
' *************************************************************
Function MSScriptControl_Release (ByVal pCookie As MSScriptControl_IDispatchVtbl Ptr) As Dword
   Local pVtblAddr As Dword
   If @@pCookie.cRef = 1 Then
      pVtblAddr = @@pCookie.pVtblAddr
      If IsFalse HeapFree(GetProcessHeap(), 0, ByVal pVtblAddr) Then
         Function = @@pCookie.cRef
         Exit Function
      End If
   End If
   DECR @@pCookie.cRef
   Function = @@pCookie.cRef
End Function
' *************************************************************

' *************************************************************
' HRESULT GetTypeInfoCount([out] *UINT pctinfo)
' *************************************************************
Function MSScriptControl_GetTypeInfoCount (ByVal pCookie As MSScriptControl_IDispatchVtbl Ptr, ByRef pctInfo As Dword) As Long
   Function = %E_NOTIMPL
End Function
' *************************************************************

' *************************************************************
' HRESULT GetTypeInfo([in] UINT itinfo, [in] UI4 lcid, [out] **VOID pptinfo)
' *************************************************************
Function MSScriptControl_GetTypeInfo (ByVal pCookie As MSScriptControl_IDispatchVtbl Ptr, _
   ByVal itinfo As Dword, ByVal lcid As Dword, ByRef pptinfo As Dword) As Long
   Function = %E_NOTIMPL
End Function
' *************************************************************

' *************************************************************
' HRESULT GetIDsOfNames([in] *GUID riid, [in] **I1 rgszNames, [in] UINT cNames, [in] UI4 lcid, [out] *I4 rgdispid)
' *************************************************************
Function MSScriptControl_GetIDsOfNames ( ByVal pCookie As MSScriptControl_IDispatchVtbl Ptr, _
   ByRef riid As Guid, ByVal rgszNames As Dword, ByVal cNames As Dword, ByVal lcid As Dword, ByRef rgdispid As Long) As Long
   Function = %E_NOTIMPL
End Function
' *************************************************************

' *************************************************************
' Builds the IDispatch Virtual Table
' *************************************************************
Function MSScriptControl_BuildVtbl (ByVal pthis As Dword) As Dword

   Local pVtbl As MSScriptControl_IDispatchVtbl Ptr
   Local pUnk As MSScriptControl_IDispatchVtbl Ptr

   pVtbl = HeapAlloc(GetProcessHeap(), %HEAP_ZERO_MEMORY, SizeOf(@pVtbl))
   If pVtbl = 0 Then Exit Function

   @pVtbl.QueryInterface   = CodePtr(MSScriptControl_QueryInterface)
   @pVtbl.AddRef           = CodePtr(MSScriptControl_AddRef)
   @pVtbl.Release          = CodePtr(MSScriptControl_Release)
   @pVtbl.GetTypeInfoCount = CodePtr(MSScriptControl_GetTypeInfoCount)
   @pVtbl.GetTypeInfo      = CodePtr(MSScriptControl_GetTypeInfo)
   @pVtbl.GetIDsOfNames    = CodePtr(MSScriptControl_GetIDsOfNames)
   @pVtbl.Invoke           = CodePtr(MSScriptControl_Invoke)
   @pVtbl.pVtblAddr        = pVtbl
   @pVtbl.pthis            = pthis

   pUnk = VarPtr(@pVtbl.pVtblAddr)
   Function = pUnk

End Function
' *************************************************************

' *************************************************************
' Establishes a connection between the connection point object and the client's sink.
' Returns a token that uniquely identifies this connection.
' *************************************************************
Function MSScriptControl_ConnectEvents (ByVal pthis As Dword, ByRef pdwCookie As Dword) As Long

   Local HRESULT As Long                 ' HRESULT code
   Local pCPC As Dword                   ' IConnectionPointContainer
   Local pCP As Dword                    ' IConnectionPoint
   Local IID_CPC As Guid                 ' IID_IConnectionPointContainer
   Local IID_CP As Guid                  ' Events dispinterface
   Local dwCookie As Dword               ' Returned token
   Local pUnkSink As Dword               ' IUnknown of the class

   IID_CPC = GUID$("{B196B284-BAB4-101A-B69C-00AA00341D07}")
   IID_CP  = GUID$("{8B167D60-8605-11D0-ABCB-00A0C90FFFC0}")

   If pthis = 0 Then Function = -1 : Exit Function
   HRESULT = MSScriptControl_IUnknown_QueryInterface(pthis, IID_CPC, pCPC)
   If HRESULT &lt;&gt; %S_OK Then Function = HRESULT : Exit Function

   HRESULT = MSScriptControl_IConnectionPointContainer_FindConnectionPoint(pCPC, IID_CP, pCP)
   MSScriptControl_IUnknown_Release pCPC
   If HRESULT &lt;&gt; %S_OK Then Function = HRESULT : Exit Function

   pUnkSink = MSScriptControl_BuildVtbl(pthis)
   If IsTrue pUnkSink Then HRESULT = MSScriptControl_IConnectionPoint_Advise(pCP, pUnkSink, dwCookie)
   MSScriptControl_IUnknown_Release pCP
   pdwCookie = dwCookie
   Function = HRESULT

End Function
' *************************************************************

' *************************************************************
' Releases the events connection identified with the cookie returned by the ConnectEvents function
' *************************************************************
Function MSScriptControl_DisconnectEvents (ByVal pthis As Dword, ByVal dwCookie As Dword) As Long

   Local HRESULT As Long                 ' HRESULT code
   Local pCPC As Dword                   ' IConnectionPointContainer
   Local pCP As Dword                    ' IConnectionPoint
   Local IID_CPC As Guid                 ' IID_IConnectionPointContainer
   Local IID_CP As Guid                  ' ConnectionEvents dispinterface

   IID_CPC = GUID$("{B196B284-BAB4-101A-B69C-00AA00341D07}")
   IID_CP  = GUID$("{8B167D60-8605-11D0-ABCB-00A0C90FFFC0}")

   If pthis = 0 Then Function = -1 : Exit Function
   HRESULT = MSScriptControl_IUnknown_QueryInterface(pthis, IID_CPC, pCPC)
   If HRESULT &lt;&gt; %S_OK Then Function = HRESULT : Exit Function

   HRESULT = MSScriptControl_IConnectionPointContainer_FindConnectionPoint(pCPC, IID_CP, pCP)
   MSScriptControl_IUnknown_Release pCPC
   If HRESULT &lt;&gt; %S_OK Then Function = HRESULT : Exit Function

   HRESULT = MSScriptControl_IConnectionPoint_Unadvise(pCP, dwCookie)
   MSScriptControl_IUnknown_Release pCP
   Function = HRESULT

End Function
' *************************************************************

' *************************************************************
' Function name: Error
' Dispatch interface name: DScriptControlSource
' Help string = Event fired when any error occurs in the scripting engine
' Help context = 1130320 [&H113F50]
' Member identifier: &H00000BB8 (3000)
' *************************************************************
Function MSScriptControl_Error (ByVal pCookie As MSScriptControl_IDispatchVtbl Ptr, ByRef pdispparams As DISPPARAMS) As Long

'  ============================================================
'  Retrieve the IUnknown or IDispatch of the control that has fired the event.
'  ============================================================
   Local pthis As Dword
   pthis = @@pCookie.pthis
'  ============================================================

'  ============================================================
'  *** Put your code here ***
'  ============================================================

   ' Show the error message retrieved by the helper
   ' function MsScriptControl_GetErrorInfo
   MsgBox MsScriptControl_GetErrorInfo(pthis)

   Function = %S_OK

End Function
' *************************************************************

' *************************************************************
' Function name: Timeout
' Dispatch interface name: DScriptControlSource
' Help string = Event fired when a script is aborted because of a timeout
' Help context = 1130319 [&H113F4F]
' Member identifier: &H00000BB9 (3001)
' *************************************************************
Function MSScriptControl_Timeout (ByVal pCookie As MSScriptControl_IDispatchVtbl Ptr, ByRef pdispparams As DISPPARAMS) As Long

'  ============================================================
'  Retrieve the IUnknown or IDispatch of the control that has fired the event.
'  ============================================================
   Local pthis As Dword
   pthis = @@pCookie.pthis
'  ============================================================

'  ============================================================
'  *** Put your code here ***
'  ============================================================

   Function = %S_OK

End Function
'  ============================================================


' *************************************************************
' HRESULT Invoke([in] I4 dispidMember, [in] *GUID riid, [in] UI4 lcid, [in] UI2 wFlags, [in] *DISPPARAMS pdispparams, [out] *VARIANT pvarResult, [out] *EXCEPINFO pexcepinfo, [out] *UINT puArgErr)
' *************************************************************
Function MSScriptControl_Invoke (ByVal pCookie As MSScriptControl_IDispatchVtbl Ptr, ByVal dispidMember As Long, ByRef riid As Guid, _
  ByVal lcid As Dword, ByVal wFlags As Word, ByRef pdispparams As DISPPARAMS, ByRef pvarResult As Variant, _
  ByRef pexcepinfo As MSScriptControl_EXCEPINFO, ByRef puArgErr As Dword) As Long

   Function = %S_OK
   If VARPTR(pdispparams) Then
      Select Case As Long dispidMember
         Case &H00000BB8  ' (3000)  ' // Error
            Function = MSScriptControl_Error(pCookie, pdispparams)
         Case &H00000BB9  ' (3001)  ' // Timeout
            Function = MSScriptControl_Timeout(pCookie, pdispparams)
      End Select
   End If

End Function
' *************************************************************

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local strScript As String
   Local lpModules As Dword
   Local lpModule As Dword
   Local lpObj As Dword
   Local vObj As Variant
   Local oObj As Dispatch
   Local vPrm1 As Variant
   Local vPrm2 As Variant
   Local vRes As Variant
   Local hr As Long
   Local dwCookie As Dword

   ' ==========================================================
   ' Creates an instance of the Microsoft Script Control
   ' ==========================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ==========================================================

   ' ==========================================================
   ' Connect to the events fired by the control
   ' ==========================================================
   hr = MSScriptControl_ConnectEvents(lpSc, dwCookie)
   ' ==========================================================

   ' ==========================================================
   ' Set the language. It can be 'VBScript' or 'JScript'
   ' ==========================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ==========================================================

   ' ==========================================================
   ' Add a new module and a procedure and call it using PB
   ' automation
   ' ==========================================================
   ' Get a reference to the modules collection
   lpModules = IScriptControl_GetModules(lpSc)
   If IsTrue lpModules Then
      ' Add a new module
      lpModule = IScriptModuleCollection_Add(lpModules, "MyModule")
      If IsTrue lpModule Then
         ' Add a procedure to the module
         strScript = "Function Multiply(vPrm1, vPrm2)" & $CRLF & _
                     "   Dim result" & $CRLF & _
                     "   result = vPrm1 * vPrm2" & $CRLF & _
                     "   Multiply == result" & $CRLF & _
                     "End Function"
         IScriptModule_AddCode lpModule, strScript
         ' Get the dispatch interface of the module
         lpObj = IScriptModule_GetCodeObject(lpModule)
         If IsTrue lpObj Then
            ' Covert the pointer to a dispatch variant
            ScriptingMakeDispatchVariant lpObj, vObj
            Set oObj = vObj
            vObj = Empty
            ' Use PB automation to call the procedure
            If IsTrue isobject(oObj) Then
               vPrm1 = 6 : vPrm2 = 5
               Object Call oObj.Multiply(vPrm1, vPrm2) To vRes
               MsgBox "Result: " & str$(Variant#(vRes))
               Set oObj = Nothing
            End If
         End If
         ScriptingRelease lpModule
      End If
      ScriptingRelease lpModules
   End If
   ' ==========================================================

   ' ==========================================================
   ' Disconnect events
   ' ==========================================================
   If dwCookie Then hr = MSScriptControl_DisconnectEvents(lpSc, dwCookie)
   ' ==========================================================

   ' ==========================================================
   ' Releases the interface
   ' ==========================================================
   If lpSc Then ScriptingRelease lpSc
   ' ==========================================================

End Function
' *************************************************************</pre>
</div><br/>
------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292911 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292911 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292911 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292912 data-node-publishdate=1110647820 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292912 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292912%23post292912" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292912#post292912" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292912%23post292912" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292912#post292912">#12</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T09:17:00>12 Mar 2005, 12:17 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								Visual Basic code is not difficult to be translated as a VBScipt.<br/>
For example, the following Visual Basic code:<br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">Dim xmlDoc As New Msxml2.DOMDocument40
xmlDoc.async = False
xmlDoc.Load ("books.xml")
If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then
   Dim myErr
   Set myErr = xmlDoc.parseError
   MsgBox("You have error " & myErr.reason)
Else
   MsgBox xmlDoc.xml
End If</pre>
</div>Translates as <br/>
<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">Dim xmlDoc
Set xmlDoc = CreateObject("Msxml2.DOMDocument.4.0")
xmlDoc.async = False
xmlDoc.Load ("books.xml")
If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then
   Dim myErr
   Set myErr = xmlDoc.parseError
   MsgBox("You have error " & myErr.reason)
Else
   MsgBox xmlDoc.xml
End If</pre>
</div>For tips to convert java scripts to VBScript see:<br/>
<br/>
 <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/xmmsctipsforconvertingsamplestovbscript.asp" target=_blank rel=nofollow>http://msdn.microsoft.com/library/de...tovbscript.asp</a> <br/>
<br/>
The next example shows how to use the above script with PowerBasic.<br/>
<br/>
<br/>
------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292912 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292912 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292912 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292913 data-node-publishdate=1110647880 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292913 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292913%23post292913" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292913#post292913" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292913%23post292913" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292913#post292913">#13</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T09:18:00>12 Mar 2005, 12:18 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								<b>Save as books.xml</b><br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">&lt;?xml version="1.0"?&gt;
&lt;catalog&gt;
   &lt;book id="bk101"&gt;
      &lt;author&gt;Gambardella, Matthew&lt;/author&gt;
      &lt;title&gt;XML Developer's Guide&lt;/title&gt;
      &lt;genre&gt;Computer&lt;/genre&gt;
      &lt;price&gt;44.95&lt;/price&gt;
      &lt;publish_date&gt;2000-10-01&lt;/publish_date&gt;
      &lt;description&gt;An in-depth look at creating applications
      with XML.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk102"&gt;
      &lt;author&gt;Ralls, Kim&lt;/author&gt;
      &lt;title&gt;Midnight Rain&lt;/title&gt;
      &lt;genre&gt;Fantasy&lt;/genre&gt;
      &lt;price&gt;5.95&lt;/price&gt;
      &lt;publish_date&gt;2000-12-16&lt;/publish_date&gt;
      &lt;description&gt;A former architect battles corporate zombies,
      an evil sorceress, and her own childhood to become queen
      of the world.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk103"&gt;
      &lt;author&gt;Corets, Eva&lt;/author&gt;
      &lt;title&gt;Maeve Ascendant&lt;/title&gt;
      &lt;genre&gt;Fantasy&lt;/genre&gt;
      &lt;price&gt;5.95&lt;/price&gt;
      &lt;publish_date&gt;2000-11-17&lt;/publish_date&gt;
      &lt;description&gt;After the collapse of a nanotechnology
      society in England, the young survivors lay the
      foundation for a new society.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk104"&gt;
      &lt;author&gt;Corets, Eva&lt;/author&gt;
      &lt;title&gt;Oberon's Legacy&lt;/title&gt;
      &lt;genre&gt;Fantasy&lt;/genre&gt;
      &lt;price&gt;5.95&lt;/price&gt;
      &lt;publish_date&gt;2001-03-10&lt;/publish_date&gt;
      &lt;description&gt;In post-apocalypse England, the mysterious
      agent known only as Oberon helps to create a new life
      for the inhabitants of London. Sequel to Maeve
      Ascendant.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk105"&gt;
      &lt;author&gt;Corets, Eva&lt;/author&gt;
      &lt;title&gt;The Sundered Grail&lt;/title&gt;
      &lt;genre&gt;Fantasy&lt;/genre&gt;
      &lt;price&gt;5.95&lt;/price&gt;
      &lt;publish_date&gt;2001-09-10&lt;/publish_date&gt;
      &lt;description&gt;The two daughters of Maeve, half-sisters,
      battle one another for control of England. Sequel to
      Oberon's Legacy.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk106"&gt;
      &lt;author&gt;Randall, Cynthia&lt;/author&gt;
      &lt;title&gt;Lover Birds&lt;/title&gt;
      &lt;genre&gt;Romance&lt;/genre&gt;
      &lt;price&gt;4.95&lt;/price&gt;
      &lt;publish_date&gt;2000-09-02&lt;/publish_date&gt;
      &lt;description&gt;When Carla meets Paul at an ornithology
      conference, tempers fly as feathers get ruffled.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk107"&gt;
      &lt;author&gt;Thurman, Paula&lt;/author&gt;
      &lt;title&gt;Splish Splash&lt;/title&gt;
      &lt;genre&gt;Romance&lt;/genre&gt;
      &lt;price&gt;4.95&lt;/price&gt;
      &lt;publish_date&gt;2000-11-02&lt;/publish_date&gt;
      &lt;description&gt;A deep sea diver finds true love twenty
      thousand leagues beneath the sea.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk108"&gt;
      &lt;author&gt;Knorr, Stefan&lt;/author&gt;
      &lt;title&gt;Creepy Crawlies&lt;/title&gt;
      &lt;genre&gt;Horror&lt;/genre&gt;
      &lt;price&gt;4.95&lt;/price&gt;
      &lt;publish_date&gt;2000-12-06&lt;/publish_date&gt;
      &lt;description&gt;An anthology of horror stories about roaches,
      centipedes, scorpions  and other insects.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk109"&gt;
      &lt;author&gt;Kress, Peter&lt;/author&gt;
      &lt;title&gt;Paradox Lost&lt;/title&gt;
      &lt;genre&gt;Science Fiction&lt;/genre&gt;
      &lt;price&gt;6.95&lt;/price&gt;
      &lt;publish_date&gt;2000-11-02&lt;/publish_date&gt;
      &lt;description&gt;After an inadvertant trip through a Heisenberg
      Uncertainty Device, James Salway discovers the problems
      of being quantum.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk110"&gt;
      &lt;author&gt;O'Brien, Tim&lt;/author&gt;
      &lt;title&gt;Microsoft .NET: The Programming Bible&lt;/title&gt;
      &lt;genre&gt;Computer&lt;/genre&gt;
      &lt;price&gt;36.95&lt;/price&gt;
      &lt;publish_date&gt;2000-12-09&lt;/publish_date&gt;
      &lt;description&gt;Microsoft's .NET initiative is explored in
      detail in this deep programmer's reference.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk111"&gt;
      &lt;author&gt;O'Brien, Tim&lt;/author&gt;
      &lt;title&gt;MSXML3: A Comprehensive Guide&lt;/title&gt;
      &lt;genre&gt;Computer&lt;/genre&gt;
      &lt;price&gt;36.95&lt;/price&gt;
      &lt;publish_date&gt;2000-12-01&lt;/publish_date&gt;
      &lt;description&gt;The Microsoft MSXML3 parser is covered in
      detail, with attention to XML DOM interfaces, XSLT processing,
      SAX and more.&lt;/description&gt;
   &lt;/book&gt;
   &lt;book id="bk112"&gt;
      &lt;author&gt;Galos, Mike&lt;/author&gt;
      &lt;title&gt;Visual Studio 7: A Comprehensive Guide&lt;/title&gt;
      &lt;genre&gt;Computer&lt;/genre&gt;
      &lt;price&gt;49.95&lt;/price&gt;
      &lt;publish_date&gt;2001-04-16&lt;/publish_date&gt;
      &lt;description&gt;Microsoft Visual Studio 7 is explored in depth,
      looking at how Visual Basic, Visual C++, C#, and ASP+ are
      integrated into a comprehensive development
      environment.&lt;/description&gt;
   &lt;/book&gt;
&lt;/catalog&gt;</pre>
</div><br/>
------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292913 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292913 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292913 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292914 data-node-publishdate=1110647940 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292914 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292914%23post292914" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292914#post292914" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292914%23post292914" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292914#post292914">#14</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T09:19:00>12 Mar 2005, 12:19 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								
<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' ExecuteStatemnent (VBScript)
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32Api.INC"
#Include "MSSCRIPT.INC"         ' Scripting wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local hr AS LONG
   Local strScript As String

   ' ==========================================================
   ' Create an instance of the Microsoft Script Control
   ' ==========================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ==========================================================

   ' ==========================================================
   ' Set the language
   ' ==========================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ==========================================================

   ' ==========================================================
   ' Allow to display user-interface elements
   ' ==========================================================
   IScriptControl_SetAllowUI lpSc, -1
   ' ==========================================================

   ' ==========================================================
   ' Make and execute the script
   ' ==========================================================
   strScript = _
   "Dim xmlDoc" & $CRLF & _
   "Set xmlDoc = CreateObject(""Msxml2.DOMDocument.4.0"")" & $CRLF & _
   "xmlDoc.async = False" & $CRLF & _
   "xmlDoc.Load (""books.xml"")" & $CRLF & _
   "If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then" & $CRLF & _
   "   Dim myErr" & $CRLF & _
   "   Set myErr = xmlDoc.parseError" & $CRLF & _
   "   MsgBox myErr.reason, VBOKOnly, ""Error""" & $CRLF & _
   "Else" & $CRLF & _
   "   MsgBox xmlDoc.xml" & $CRLF & _
   "End If"

   IScriptControl_ExecuteStatement lpSc, StrScript
   If ScriptingError Then
      MsgBox MSScriptControl_GetErrorInfo(lpSc, ScriptingResult)
   End If
   ' ==========================================================

   ' ==========================================================
   ' Release the ScriptControl
   ' ==========================================================
   If lpSc Then ScriptingRelease lpSc
   ' ==========================================================

End Function
' *************************************************************</pre>
</div><br/>
------------------<br/>

							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292914 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292914 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292914 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
								
									
									
								
								
									<!-- Conversation Replies or Comments -->
									
									
									
										
									

									
										





	
	















	




<li data-node-id=292915 data-node-publishdate=1110648000 class="b-post js-post js-comment-entry__parent h-restore--on-preview b-post--text  js-conversation-reply h-left h-clear js-slideshow__gallery-node js-poll__parent " itemscope itemtype="http://schema.org/Comment">

	
	
	
		<a id=post292915 class=anchor></a>
	

	
		

		
		

		

		
		
		<meta itemprop=url content="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions"/>
	


	<div class="l-row l-row__fixed--left">
		<div class="l-col__fixed-3 l-col--userinfo l-col__small--full h-hide--on-preview h-padding-right-l">
			



<div class="userinfo b-userinfo b-post__hide-when-deleted" itemprop=author itemscope itemtype="http://schema.org/Person">
	
		

		
		
			
			
		

		
			<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="b-avatar b-avatar--m b-avatar--thread h-margin-bottom-l"><img src="resources/image1.png" alt="José Roca" title="José Roca"/></a>
		
	
	<!-- responsive alteration: Added userinfo-details wrapper in order to
	support left floated avatar with all other information on the right. -->
	
	<div class=b-userinfo__details>
		
		<div class="author h-text-size--14">
			<strong>
			








	
	
		
	













	













<div class="b-namecard js-namecard-html h-hide-imp" data-userid=1464>
	<div class=b-namecard__top>
		<div class=b-namecard__column>
			
				








	




	
	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class="avatar medium h-left">
		<img src="resources/image.png" alt="José Roca" title="José Roca"/>
	</a>

			
		</div>
		<div class=b-namecard__column>
			

			<div class=b-namecard__username>
				José Roca
			</div>

			
				<div class=b-namecard__usertitle>
					Member
				</div>
			

			
				<div class=b-namecard__search-link>
					
					
					
					
					
					
					
					<a href="https://forum.powerbasic.com/search?searchJSON=%7B%22authorid%22%3A%5B%221464%22%5D%2C%22channel%22%3A%222%22%2C%22exclude_type%22%3A%5B%22vBForum_PrivateMessage%22%2C+%22vBForum_Channel%22%5D%7D">Find all posts</a>
				</div>
			

			
			
				<div class=b-namecard__profile-link>
					<a href="https://forum.powerbasic.com/member/1464-josé-roca">View Profile</a>
				</div>
			
		</div>
	</div>
	<div class=b-namecard__bottom>
		<div class="b-namecard__close h-hide">
			<button class="b-button b-button--secondary js-close-qtip">Close</button>
		</div>
	</div>
</div>

	<a href="https://forum.powerbasic.com/member/1464-josé-roca" class data-vbnamecard=1464>José Roca</a>

			</strong>
			


	





	




		</div>
		
		
			
			<div class=usertitle>Member</div>
		

		
			
			<div class="b-meter h-margin-top-m pos" title="pointless gray bars">
				
				
					<div class="b-meter__bar b-meter__bar--selected"></div>
					<div class="b-meter__bar b-meter__bar--selected"></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
					<div class=b-meter__bar></div>
					<div class=b-meter__bar></div>
				
			</div>
		
		
		<div class="b-userinfo__rank h-margin-top-s h-hide"></div>
		
		<ul class="b-userinfo__additional-info-block h-margin-top-xl">
			
				<li class=b-userinfo__additional-info><label>Join Date:</label> <span>Mar 2004</span></li>
				<li class=b-userinfo__additional-info><label>Posts:</label> <span>7887</span></li>
				
			
			
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
					
				
			
			
		</ul>
		<ul class="b-userinfo__icons h-margin-none">
			
				
			
			<li class="b-userinfo__icon h-left" title="José Roca is online now"><span class="b-icon b-icon__status--green"></span></li>

			
		</ul>
	</div>
</div>
			









	


<ul class="b-sharing-menu js-sharing-menu js-comp-menu-horizontal js-comp-menu--dropdown-on-small b-post__hide-when-deleted" data-dropdown-trigger-phrase=share data-dropdown-icon-classes="b-icon b-icon__share" data-dropdown-content-classes=b-sharing-menu--dropdown data-dropdown-menu-classes=b-sharing-menu--right-on-small>

	
		<li class=b-sharing-menu__item>
			
			<a class="js-fb-share-dialog b-sharing-menu__item-link b-sharing-menu__item-link--facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292915%23post292915" data-url-not-encoded="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292915#post292915" target=_blank>
				<svg class=b-sharing-menu__item-link-img xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" color="#ffffff">
					<path fill="#ffffff" fill-rule=evenodd d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path>
				</svg>
				Share
			</a>
		</li>
	

	
		<li class="b-sharing-menu__item b-sharing-menu__item--twitter">
			
			
			<a class="js-twitter-share b-sharing-menu__item-link b-sharing-menu__item-link--twitter" href="https://twitter.com/intent/tweet?text=&amp;url=https%3A%2F%2Fforum.powerbasic.com%2Fforum%2Fuser-to-user-discussions%2Fsource-code%2F25177-microsoft-script-control-wrapper-functions%3Fp%3D292915%23post292915" target=_blank>
				<img class=b-sharing-menu__item-link-img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E"/>
				Tweet
			</a>
		</li>
	

	

</ul>
		</div>

		<div class="js-post__content-wrapper l-col__flex-3 l-col--post__body l-col__small--full h-restore--on-preview">
			<div class="b-post__body h-restore--on-preview h-padding-horiz-xxl h-padding-top-xl h-padding-bottom-m h-clearfix">
				<div class="b-post__arrow b-post__hide-when-deleted"></div>

				

				<div class="b-post__content js-post__content">
					<hr class=b-divider--section />

					<div class="b-media h-hide--on-preview">
						<div class=b-media__img--rev>

							
								
							

							
							
							
							
							

							
								<a class="b-post__count js-show-post-link" href="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions?p=292915#post292915">#15</a>
							

							


						</div>
						<div class=b-media__body>
							


							
							
							<div class=b-post__timestamp><time itemprop=dateCreated datetime=2005-03-12T09:20:00>12 Mar 2005, 12:20 PM</time></div>

						</div>
					</div>


					<div class=b-post__hide-when-deleted>
					<div class="OLD__post-content h-padding-vert-xl">
						
							<div class="axd axd_last-post">
								
								
								
							</div>
						


						
						<div class="js-post__content-text restore h-wordwrap" itemprop=text>
							
								
								The same example converted in a function to return the result instead<br/>
of showing it in the script.<br/>

<div class=bbcode_container>
	<div class=bbcode_description>Code:</div>
	
	<pre class=bbcode_code style="max-height:calc(40 * 1.4rem + 12px + 20px);">' *************************************************************
' ExecuteStatemnent and Eval (VBScript)
' *************************************************************

#Compile Exe
#Dim All

#Include "Win32Api.INC"
#Include "MSSCRIPT.INC"         ' Scripting wrapper functions

' *************************************************************
' Main
' *************************************************************
Function PbMain

   Local hr AS LONG
   Local strScript As String
   Local vRes As Variant

   ' ==========================================================
   ' Create an instance of the Microsoft Script Control
   ' ==========================================================
   Local lpSc As Dword
   lpSc = ScriptingCreateObject("MSScriptControl.ScriptControl")
   If IsFalse lpSc Then
      MsgBox "Error creating an instance of the Microsoft Script Control"
      Exit Function
   End If
   ' ==========================================================

   ' ==========================================================
   ' Set the language
   ' ==========================================================
   IScriptControl_SetLanguage lpSc, "VBScript"
   ' ==========================================================

   ' ==========================================================
   ' Allow to display user-interface elements
   ' ==========================================================
   IScriptControl_SetAllowUI lpSc, -1
   ' ==========================================================

   ' ==========================================================
   ' Make and execute the script
   ' ==========================================================
   strScript = _
   "Function TestXml" & $CRLF & _
   "   Dim xmlDoc" & $CRLF & _
   "   Set xmlDoc = CreateObject(""Msxml2.DOMDocument.4.0"")" & $CRLF & _
   "   xmlDoc.async = False" & $CRLF & _
   "   xmlDoc.Load (""books.xml"")" & $CRLF & _
   "   If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then" & $CRLF & _
   "      Dim myErr" & $CRLF & _
   "      Set myErr = xmlDoc.parseError" & $CRLF & _
   "      MsgBox myErr.reason, VBOKOnly, ""Error""" & $CRLF & _
   "   Else" & $CRLF & _
   "      TestXml = xmlDoc.xml" & $CRLF & _
   "   End If" & $CRLF & _
   "End Function"

   IScriptControl_ExecuteStatement lpSc, StrScript
   If ScriptingError Then
      MsgBox MSScriptControl_GetErrorInfo(lpSc, ScriptingResult)
   End If
   IScriptControl_Eval lpSc, "TestXml", vRes
   If ScriptingError Then
      MsgBox MSScriptControl_GetErrorInfo(lpSc, ScriptingResult)
   Else
      MsgBox Variant$(vRes)
   End If
   ' ==========================================================

   ' ==========================================================
   ' Release the ScriptControl
   ' ==========================================================
   If lpSc Then ScriptingRelease lpSc
   ' ==========================================================

End Function
' *************************************************************</pre>
</div><br/>
------------------<br/>
<br/>
<br/>
[This message has been edited by José Roca (edited March 12, 2005).]
							
						</div>
					</div>



	
	
		
			<div class="post-signature restore"><span style=font-size:8px><span style=font-family:Verdana><b>Forum: </b><a href="http://www.jose.it-berater.org/smfforum/index.php" target=_blank rel=nofollow>http://www.jose.it-berater.org/smfforum/index.php</a></span></span></div>
		
	

	</div> 
  </div> 





	
	





		
			
				
				
				
				
				
				
			
			
<div class="b-post__footer h-hide--on-preview h-clear h-padding-bottom-m h-margin-horiz-xl">

	<div class=h-clearfix>
		

		
			<hr class="b-divider b-divider--post-controls"/>
		

		<ul class="h-left js-post-info">

			
			

			

			
		</ul>

		<ul class="h-margin-top-s h-right js-post-controls b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive" data-node-id=292915 data-dropdown-icon-classes="b-icon b-icon__ellipsis" data-dropdown-content-classes=b-comp-menu-dropdown__content--right>
			

			

			

			

				

					

				

			

			

			

			

			

			

			
				

			


			

		</ul>


	</div>
</div>


			<div class="b-comment-entry js-comment-entry h-padding-xxl h-padding-top-xl  comment-entry-box h-hide ">
				<h2 class=h-margin-bottom-xl>Comment</h2>
				<textarea class="b-comment-entry__textbox js-comment-entry__textbox autogrow" placeholder="Type your comment here"></textarea>

				<div class="b-button-group h-margin-top-xl">
					<button type=button id=btnPostComment-292915 class="b-button b-button--primary js-comment-entry__post">Post</button>
					<button type=button id=btnPostCommentCancel-292915 class="b-button js-comment-entry__cancel">Cancel</button>
				</div>
			</div>

			<div class=edit-conversation-container></div>

			





	














<div class="b-comments js-comments   h-margin-bottom-xl h-clearfix h-hide">

	

	
		<div class="b-comments__header js-comments__header b-media h-padding-vert-m h-padding-horiz-l h-hide">
			<div class="js-comments__total h-margin-left-l b-media__body">
				<span class="b-icon b-icon__speech-single h-margin-right-s"></span>
				<label class="js-comments__total-text h-align-top"></label>
			</div>
			<div class="b-media__img--rev js-comments__pagination h-hide">
				<label></label>
				<span class="b-comments__pagination--up js-comments__page--prev h-margin-left-s" title="See previous comments"><span class="b-icon b-icon__arrow-up-m"></span></span>
			</div>
		</div>
		<ul class="b-comments__comments js-comments__comments h-left"></ul>
		<div class="b-comments__footer js-comments__footer b-media h-padding-vert-m h-padding-horiz-l h-clear h-hide">
			<div class="b-media__img--rev js-comments__pagination">
				<label></label>
				<span class="b-comments__pagination--down js-comments__page--next h-margin-left-s" title="See next comments"><span class="b-icon b-icon__arrow-down-m"></span></span>
			</div>
		</div>
	
</div>

		


      </div>
    </div>  
  </div>    
</li><!-- /end .b-post -->
									
								
								

								
								
							
						</ul>
					</div>
				</div>
				
					


	



	


<div class="pagenav-container h-clearfix noselect h-hide">
	<div class="js-pagenav pagenav h-right js-shrink-event-parent" data-baseurl="https://forum.powerbasic.com/forum/user-to-user-discussions/source-code/25177-microsoft-script-control-wrapper-functions">

		

		
		
			<a class="js-pagenav-button js-pagenav-prev-button b-button b-button--secondary h-hide-imp js-shrink-event-child" data-page=0 tabindex=0>Previous</a>
		

		
		
		
		
		
		<a class="js-pagenav-button b-button b-button--narrow js-shrink-event-child b-button--secondary js-pagenav-button--template h-hide-imp" data-page=0 tabindex=0>template</a>

		
		
			<a class="js-pagenav-button js-pagenav-next-button b-button b-button--secondary h-hide-imp js-shrink-event-child" data-page=0 tabindex=0>Next</a>
		

	</div>
</div>
					
						<div class=h-margin-top-xl></div>
					
				

				
			</div>
		
		
	</div>
	





	<!-- *** END WIDGET widgetid:6, widgetinstanceid:20, template:widget_conversationdisplay *** -->


	

</div>

	

</div>

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	







<!-- section 3 -->



<div class="canvas-widget-list section-3 js-sectiontype-extra h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	

	

</div>

	

</div>

	

		
	



	



<!-- row -->
<div class="canvas-layout-row l-row no-columns h-clearfix">

	
	

	

		
		
		

		
	





	



	



	




	
	







<!-- section 201 -->



<div class="canvas-widget-list section-201 js-sectiontype-global_before_footer h-clearfix l-col__large-12 l-col__small--full l-wide-column">

	

	

	

</div>

	

</div>

	

</div>

</div>
	<div class=h-clear></div>
</main>

	<footer id=footer>
		
		
		<nav id=footer-tabbar class="h-clearfix js-shrink-event-parent">
			
			
			
			
			
				
			
			
			<ul class="h-left js-footer-chooser-list h-margin-left-xxl js-shrink-event-child">
				
				
					<li>

						<div class="b-comp-menu-dropdown js-comp-menu-dropdown b-comp-menu-dropdown--open-on-hover b-comp-menu-dropdown--direction-up js-languagechooser js-select-on-xsmall h-margin-right-l">
							<div class="b-comp-menu-dropdown__trigger js-comp-menu-dropdown__trigger b-comp-menu-dropdown__trigger--arrow">
								
									
								
									
										English (US)
									
								
									
								
									
								
							</div>
							<ul class="b-comp-menu-dropdown__content js-comp-menu-dropdown__content b-comp-menu-dropdown__content--left">
								
									<li class=b-comp-menu-dropdown__content-item>
										<a href="https://forum.powerbasic.com/#" data-languageid=3>Deutsch (Du)</a>
									</li>
								
									<li class="b-comp-menu-dropdown__content-item b-comp-menu-dropdown__content-item--current">
										<a href="https://forum.powerbasic.com/#" data-languageid=1>English (US)</a>
									</li>
								
									<li class=b-comp-menu-dropdown__content-item>
										<a href="https://forum.powerbasic.com/#" data-languageid=2>French</a>
									</li>
								
									<li class=b-comp-menu-dropdown__content-item>
										<a href="https://forum.powerbasic.com/#" data-languageid=4>Spanish</a>
									</li>
								
							</ul>
						</div>

					</li>
				
				
			</ul>

			<ul class="nav-list h-right js-footer-nav-list h-margin-right-xxl b-comp-menu-horizontal js-comp-menu-horizontal js-comp-menu--dropdown-on-xsmall b-comp-menu-dropdown--inactive js-shrink-event-child" data-dropdown-trigger-phrase=go_to_ellipsis data-dropdown-menu-classes="h-margin-vert-l b-comp-menu-dropdown--direction-up" data-dropdown-trigger-classes=b-comp-menu-dropdown__trigger--arrow>
				
				
					
					
					
					
					
					
					
					
					
					

					<li class>
						<a target=_blank href="http://www.powerbasic.com/">PowerBASIC Web Site</a>
					</li>

				
					
					
					
						
						
					
					
					
					
					
					
					
					

					<li class>
						<a rel=nofollow href="https://forum.powerbasic.com/help">Site Help</a>
					</li>

				
					
					
					
						
						
					
					
					
					
					
					
					
					

					<li class>
						<a rel=nofollow href="https://forum.powerbasic.com/contact-us">Contact Us</a>
					</li>

				
					
					
					
					
					
					
					
					
					
					

					<li class>
						<a href="https://forum.powerbasic.com/">Community Main Page</a>
					</li>

				
				<li><a href="https://forum.powerbasic.com/#" class=js-footer-go-to-top>Top of Page</a></li>
			</ul>
		</nav>
		
      
      
      
      

      
    

	</footer>
</div>
<div id=footer-copyright>
	<div id=footer-user-copyright>Copyright © 1998-2022 PowerBASIC Tools, LLC - All Rights Reserved.</div>
	<div id=footer-vb-copyright>Powered by <a href="https://www.vbulletin.com" id=vbulletinlink>vBulletin®</a> Version 5.6.6 <br/>Copyright © 2022 vBulletin Solutions, Inc. All rights reserved. </div>
	<div id=footer-current-datetime>All times are GMT-5. This page was generated at 11:59 AM.</div>
</div>
</div>

<div id=loading-indicator class="js-loading-indicator b-ajax-loading-indicator h-hide">
	<span>Working...</span>
</div>
<div class="js-flash-message b-ajax-loading-indicator b-ajax-loading-indicator--medium h-hide">
	<span class=js-flash-message-content></span>
</div>
<div id=confirm-dialog class=sb-dialog>
	<div class="dialog-content h-clearfix">
		<div class="icon h-left"></div>
		<div class=message></div>
	</div>
	<div class=b-button-group>
		<button id=btnConfirmDialogYes type=button class="b-button b-button--primary js-button">Yes</button>
		<button id=btnConfirmDialogNo type=button class="b-button b-button--secondary js-button">No</button>
	</div>
</div>
<div id=alert-dialog class=sb-dialog>
	<div class="dialog-content h-clearfix">
		<div class="icon h-left"></div>
		<div class=message></div>
	</div>
	<div class=b-button-group>
		<button id=btnAlertDialogOK type=button class="b-button b-button--primary js-button">OK</button>
	</div>
</div>
<div id=prompt-dialog class=sb-dialog>
	<div class="dialog-content table h-clearfix">
		<div class="message td"></div>
		<div class="input-box-container td">
			<input type=text class="input-box textbox"/>
			<textarea class="input-box textbox h-hide" rows=3></textarea>
		</div>
	</div>
	<div class="js-prompt-error h-hide"></div>
	<div class=b-button-group>
		<button id=btnPromptDialogOK type=button class="b-button b-button--primary js-button">OK</button>
		<button id=btnPromptDialogCancel type=button class="b-button b-button--secondary js-button">Cancel</button>
	</div>
</div>
<div id=slideshow-dialog class="sb-dialog slideshow">
	<div class="b-icon b-icon__x-square--gray close-btn">X</div>
	<div class=slideshow-wrapper></div>
	<div class=caption></div>
	<div class=thumbnails-wrapper>
		<div class=thumbnails></div>
	</div>

</div>

<div class=unsubscribe-overlay-container></div>

<div id=fb-root data-facebook-language=en_US></div>



















	<div class="b-modal-banner__banner js-privacy-consent-banner__banner h-hide-imp b-modal-banner__banner--center">
	
		<p class=b-modal-banner__paragraph>We process personal data about users of our site, through the use of cookies and other technologies, to deliver our services, and to analyze site activity. For additional details, refer to our <a href="https://www.powerbasic.com/privacy-notice" target=_blank class=b-modal-banner__clickable>Privacy Policy</a>.</p>

<p class=b-modal-banner__paragraph>By clicking "<b>I AGREE</b>" below, you agree to our <a href="https://www.powerbasic.com/privacy-notice" target=_blank class=b-modal-banner__clickable>Privacy Policy</a> and our personal data processing and cookie practices as described therein. You also acknowledge that this forum may be hosted outside your country and you consent to the collection, storage, and processing of your data in the country where this forum is hosted.</p>
		<p class=b-modal-banner__paragraph>
			<a href="https://forum.powerbasic.com/#" class="b-button b-button--primary b-modal-banner__clickable js-privacy-consent-banner__button">I Agree</a>
		</p>
	
</div>
<div class="b-modal-banner__overlay js-privacy-consent-banner__overlay h-hide-imp"></div>
	








</body>
<!--saved from url=(0024)http://www.bauerapps.com--></html>