<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Create a VB.NET COM DLL</title>
<meta name="generator" content="WYSIWYG Web Builder 17 - https://www.wysiwygwebbuilder.com">
<link href="font-awesome.min.css" rel="stylesheet">
<link href="JoeC4281.css" rel="stylesheet">
<link href="Create-a-.NET-COM-DLL.css" rel="stylesheet">
</head>
<body>
<div id="wb_IconFont1" style="position:absolute;left:2px;top:8px;width:113px;height:89px;text-align:center;z-index:0;">
<a href="./VB.NET.html"><div id="IconFont1"><i class="fa fa-backward"></i></div></a></div>
<div id="wb_Heading1" style="position:absolute;left:149px;top:12px;width:1075px;height:81px;z-index:1;">
<h1 id="Heading1">Create a VB.NET COM DLL for use with VBScript</h1></div>
<div id="wb_Text1" style="position:absolute;left:62px;top:120px;width:1052px;height:1909px;z-index:2;">
<span style="color:#000000;font-family:'Courier New';font-size:21px;"><strong>To create a COM object by using the COM class template</strong><br><br>From Visual Studio 2022,<br>open a new Windows Application project from the File menu by clicking New Project.<br><br>In the New Project dialog box under the Project Types field,<br>check that Windows is selected.<br><br>Select Class Library from the Templates list,<br>and then click OK. The new project is displayed.<br><br>Select Add New Item from the Project menu.<br>The Add New Item dialog box is displayed.<br><br>Select COM Class from the Templates list,<br>and then click Add.<br><br>Visual Basic adds a new class and configures the new project for COM interop.<br><br>Add code such as properties,<br>methods,<br>and events to the COM class.<br><br>Select Build ClassLibrary1 from the Build menu.<br><br>Visual Basic builds the assembly and registers the COM object with the operating system.<br><br>Ref: <a href="https://learn.microsoft.com/en-us/dotnet/visual-basic/programming-guide/com-interop/walkthrough-creating-com-objects#to-create-a-com-object-by-using-the-com-class-template">To create a COM object by using the COM class template</a><br>Archive.org <a href="https://web.archive.org/web/20221201180439/https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fdotnet%2Fvisual-basic%2Fprogramming-guide%2Fcom-interop%2Fwalkthrough-creating-com-objects">link to original</a><br><br><strong>NOTE: </strong>Not entirely true.<br>I had to use RegAsm.exe to create and register the type library afterwards.<br><br>R:\...\Release&gt;regasm test1.dll /tlb:Test1.tlb /codebase /verbose<br>Microsoft .NET Framework Assembly Registration Utility version 4.8.4084.0<br>for Microsoft .NET Framework version 4.8.4084.0<br>Copyright (C) Microsoft Corporation.&nbsp; All rights reserved.<br><br>RegAsm : warning RA0000 : Registering an unsigned assembly with /codebase can cause your assembly to interfere with other applications that may be installed on the same computer. The /codebase switch is intended to be used only with signed assemblies. Please give your assembly a strong name and re-register it.<br>Types registered successfully<br>Type 'Test1.Class1' exported.<br>Type 'Test1.ComClass1' exported.<br>Type 'Test1.ComClass1+_ComClass1' exported.<br>Assembly exported to 'R:\test\Test1\bin\x64\Release\Test1.tlb', and the type library was registered successfully<br><br>Now, I can use the .NET COM DLL from VBScript;<br><br>Dim jlc<br>Set jlc=CreateObject(&quot;Test1.ComClass1&quot;)<br>WScript.Echo ppp(11.00)<br>Set jlc=Nothing<br><br>Remember to un-register after testing;<br><br>R:\...\Release&gt;regasm test1.dll /tlb:Test1.tlb /codebase /verbose /unregister<br>Microsoft .NET Framework Assembly Registration Utility version 4.8.4084.0<br>for Microsoft .NET Framework version 4.8.4084.0<br>Copyright (C) Microsoft Corporation.&nbsp; All rights reserved.<br><br>Types un-registered successfully<br>Type library 'R:\test\Test1\bin\x64\Release\Test1.tlb' un-registered successfully<br><br>I use an alias called ClsID to see if a COM DLL is registered or not.<br><br>R:\...\Release&gt;alias clsid<br>echo %@regquery[HKEY_CLASSES_ROOT\%1\clsid\]<br><br>R:\...\Release&gt;clsid Test1.ComClass1<br>{5C89D5D8-3350-4E6E-83C1-1002AE8B9F15}<br><br>R:\...\Release&gt;clsid Test1.ComClass1<br>-1<br><br></span></div>
</body>
</html>