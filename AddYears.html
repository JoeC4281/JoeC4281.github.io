<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>dBASE - dUFLP - DATES1.PRG - AddYears</title>
<meta name="generator" content="WYSIWYG Web Builder 17 - https://www.wysiwygwebbuilder.com">
<link href="JoeC4281.css" rel="stylesheet">
<link href="AddYears.css" rel="stylesheet">
</head>
<body>
<div id="wb_Text1" style="position:absolute;left:14px;top:18px;width:942px;height:1039px;z-index:0;">
<span style="color:#000000;font-family:'Courier New';font-size:21px;">FUNCTION AddYears<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 04/22/1994<br>*-- Notes.......: Finds same day as given date N years ahead. <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Using this function dBASE IV will take care of<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; converting February 29 to March 1 if moving from a<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; leap to a non-leap year.&nbsp; However, it may not be used<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; backwards (negative value of nYears) since the date a<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; year before February 29, 1992 will be returned as<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; March 1, 1991, not February 28, 1991.&nbsp; If you must<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; move back, either check explicitly for February 29<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; as the original date or add code as in the AddMonths()<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; function to test for the date returned being of a<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; different month than the original and, if it is, to<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; subtract its day().<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/10/1991 - original function.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 11/14/1991 - Ken Mayer - expanded out to make it<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; easier to read, and see what's happening.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 04/22/1994 - Jay Parsons - made international<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: AddYears(&lt;dDate&gt;,&lt;nYears&gt;)<br>*-- Example.....: ?AddYears({01/01/91},1)<br>*-- Returns.....: Date<br>*-- Parameters..: dDate&nbsp; = Date being tested for ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dYears = Number of Years &quot;ahead&quot;<br>*-----------------------------------------------------------------------<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; parameters dDate, nYears<br>&nbsp;&nbsp; private cYear,cMonth,cDay,cDateSet,dReturn<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; m-&gt;cYear = str( year( dDate ) + nYears )<br>&nbsp;&nbsp; m-&gt;cMonth = right( str( month( dDate ) + 100 ), 2 )<br>&nbsp;&nbsp; m-&gt;cDay = right( str( day( dDate ) + 100 ), 2 )<br>&nbsp;&nbsp; m-&gt;cDateSet = set(&quot;DATE&quot;)<br>&nbsp;&nbsp; set date AMERICAN<br>&nbsp;&nbsp; m-&gt;dReturn = ctod( m-&gt;cMonth + &quot;/&quot; + m-&gt;cDay + &quot;/&quot; + m-&gt;cYear )<br>&nbsp;&nbsp; set date &amp;cDateSet.<br><br>RETURN m-&gt;dReturn<br>*-- EoF: AddYears()</span></div>
</body>
</html>