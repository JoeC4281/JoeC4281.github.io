<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>WeekNo</title>
<meta name="generator" content="WYSIWYG Web Builder 17 - https://www.wysiwygwebbuilder.com">
<link href="JoeC4281.css" rel="stylesheet">
<link href="WeekNo.css" rel="stylesheet">
</head>
<body>
<div id="wb_Text1" style="position:absolute;left:29px;top:17px;width:941px;height:1015px;z-index:0;">
<span style="color:#000000;font-family:'Courier New';font-size:21px;">FUNCTION WeekNo<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 70160,340)<br>*-- Date........: 05/26/1994<br>*-- Notes.......: Returns the week number of the year of a date (from<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; beginning of the year). By default, week #1 begins <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; on the first Sunday of the year. Days in the week <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; previous are assigned week #0.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; To use this function but start week # 1 on a different<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; day, use the second parameter to specify the first day<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; of the first week. 2 for Monday through 7 for <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Saturday.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/10/1991 - original function.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 11/14/1991 - Ken Mayer - expanded for readability ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 05/26/1994 - Frank A. Deviney, Jr. - added second <br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; parameter<br>*-- Calls.......: DoY()&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Function in DATES.PRG<br>*-- Called by...: Any<br>*-- Usage.......: WeekNo(&lt;dDate&gt;,&lt;nFDoW&gt;)<br>*-- Example.....: ?WeekNo({01/01/91})&nbsp;&nbsp; = 0<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ?Weekno({01/01/91},3) = 1<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ?Weekno({01/08/91})&nbsp;&nbsp; = 1<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ?Weekno({01/08/91},dow(FDoY({01/08/91))) = 2<br>*-- Returns.....: Numeric value of week number<br>*-- Parameters..: dDate&nbsp; = Date being tested for ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; nFDoW&nbsp; = first day of week [1..7]<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate, nFDoW<br>&nbsp;&nbsp; private dBaseDate,nReturn<br><br>&nbsp;&nbsp; if (pcount() &lt; 2)<br>&nbsp;&nbsp; &nbsp;&nbsp; m-&gt;nFDoW = 1<br>&nbsp;&nbsp; endif<br>&nbsp;&nbsp; m-&gt;dBaseDate = m-&gt;dDate - doy(m-&gt;dDate)<br>&nbsp;&nbsp; m-&gt;dBaseDate = m-&gt;dBaseDate - mod(dow(m-&gt;dBaseDate - m-&gt;nFDoW), 7)<br>&nbsp;&nbsp; m-&gt;nReturn = int((m-&gt;dDate - m-&gt;dBaseDate) / 7)<br><br>RETURN m-&gt;nReturn<br>*-- EoF: WeekNo()<br></span></div>
</body>
</html>