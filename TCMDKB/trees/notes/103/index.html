<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>DynamicWrapperX</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
  margin: 5px 5px 5px 5px;
  background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 10pt;
 font-family: 'Arial', 'Helvetica', sans-serif;
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
span.rvts1 /* Heading */
{
 font-weight: bold;
 color: #0000ff;
}
span.rvts2 /* Subheading */
{
 font-weight: bold;
 color: #000080;
}
span.rvts3 /* Keywords */
{
 font-style: italic;
 color: #800000;
}
a.rvts4, span.rvts4 /* Jump 1 */
{
 color: #008000;
 text-decoration: underline;
}
a.rvts5, span.rvts5 /* Jump 2 */
{
 color: #008000;
 text-decoration: underline;
}
span.rvts6
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
}
span.rvts7
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
 font-weight: bold;
}
span.rvts8
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
 font-weight: bold;
 color: #000000;
}
span.rvts9
{
}
span.rvts10
{
 font-family: 'Verdana', 'Geneva', sans-serif;
}
span.rvts11
{
 font-family: 'Tahoma', 'Geneva', sans-serif;
}
span.rvts12
{
 font-size: 8pt;
 font-family: 'Tahoma', 'Geneva', sans-serif;
}
span.rvts13
{
 font-size: 8pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
}
span.rvts14
{
 font-size: 8pt;
 font-family: 'Tahoma', 'Geneva', sans-serif;
 font-weight: bold;
}
a.rvts15, span.rvts15
{
 font-size: 8pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
 color: #0000ff;
 text-decoration: underline;
}
span.rvts16
{
 font-size: 12pt;
 font-family: 'Courier New', 'Courier', monospace;
 color: #000000;
}
span.rvts17
{
 font-size: 12pt;
 font-family: 'Courier New', 'Courier', monospace;
 font-style: italic;
 color: #000000;
}
span.rvts18
{
 font-size: 9pt;
 font-family: 'Courier New', 'Courier', monospace;
 color: #0000ff;
}
span.rvts19
{
 font-family: 'Verdana', 'Geneva', sans-serif;
 color: #000000;
}
span.rvts20
{
 font-size: 16pt;
 font-family: 'Verdana', 'Geneva', sans-serif;
 color: #000000;
}
span.rvts21
{
 font-size: 16pt;
 font-family: 'Courier New', 'Courier', monospace;
 color: #000000;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
.rvps2
{
 margin: 7px 0px 7px 0px;
}
/* ========== Lists ========== */
.list0 {text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: decimal;}
--></style>
</head>
<body>
<p><span class=rvts6>Note that you will need to download and install a 64-bit COM DLL for this tip.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Your anti-virus program will say that this is a virus/malware/destroyer of worlds, but it is not.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>I have tested this on my system;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>&nbsp; &nbsp; &nbsp;_x64: 1</span></p>
<p><span class=rvts6>&nbsp; &nbsp;_admin: 1</span></p>
<p><span class=rvts6>_elevated: 1</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>TCC &nbsp;27.00.18 x64 &nbsp; Windows 10 [Version 10.0.19042.746]</span></p>
<p><span class=rvts6><br></span></p>
<p class=rvps2><span class=rvts6>DynamicWrapperX allows you to call .DLLs from TCC (like @WINAPI and @CAPI), and you can also do low-level coding.</span></p>
<p class=rvps2><span class=rvts6>Here is an example of how I can use the DynamicWrapperX with the TCC SCRIPT command.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Save the following as test.js (or whatever.js), and then run it from the command line;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts7>script test.js</span></p>
<p><span class=rvts7><br></span></p>
<p><span class=rvts7>DX = new ActiveXObject("DynamicWrapperX");</span></p>
<p><span class=rvts7>DX.Register("kernel32", "GetCommandLine", "r=s"); &nbsp; &nbsp; &nbsp;// This function has no parameters.</span></p>
<p><span class=rvts7>CmdLine = DX.GetCommandLine(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // The command that started the process.</span></p>
<p><span class=rvts7>TakeCommand.tcommand("echo " + CmdLine);</span></p>
<p><span class=rvts7><br></span></p>
<p><span class=rvts6>You can even register a callback with the DynamicWrapperX.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>The DynamicWrapperX can also be used from PowerShell;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts8>PS E:\utils&gt; $dx = CreateObject('DynamicWrapperX')</span></p>
<p><span class=rvts8>PS E:\utils&gt; $dx.Register('kernel32', 'GetCommandLine', 'r=s')</span></p>
<p><span class=rvts8>2293006582496</span></p>
<p><span class=rvts8>PS E:\utils&gt; $dx.GetCommandLine()</span></p>
<p><span class=rvts8>Powershell.exe</span></p>
<p><span class=rvts8>PS E:\utils&gt;</span></p>
<p><span class=rvts8><br></span></p>
<p><span class=rvts6>However, as of TCC v27, it will not work with PSHELL;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts7>e:\utils&gt;pshell /s "$dx = New-Object -com DynamicWrapperX"</span></p>
<p><span class=rvts7><br></span></p>
<p><span class=rvts7>e:\utils&gt;pshell /s "$dx.Register('kernel32', 'GetCommandLine', 'r=s')"</span></p>
<p><span class=rvts7>PSHELL: System.Management.Automation.RuntimeException : Method invocation failed because [System.__ComObject]</span></p>
<p><span class=rvts7>doesn't contain a method named 'Register'.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>It will, however, work with TCC v26 PSHELL;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts7>e:\utils&gt;pshell /s "$dx = New-Object -com DynamicWrapperX"</span></p>
<p><span class=rvts7><br></span></p>
<p><span class=rvts7>e:\utils&gt;pshell /s "$dx.Register('kernel32', 'GetCommandLine', 'r=s')"</span></p>
<p><span class=rvts7>1969015197280</span></p>
<p><span class=rvts7><br></span></p>
<p><span class=rvts7>e:\utils&gt;pshell /s "$dx.GetCommandLine()"</span></p>
<p><span class=rvts7>"C:\Program Files\JPSoft\TCMD26\tcc.exe"</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Here is an example of how to do low-level coding;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts7>DWX = new ActiveXObject("DynamicWrapperX");</span></p>
<p><span class=rvts7>if (DWX.Bitness == 32) {</span></p>
<p><span class=rvts7>&nbsp; &nbsp; // The function multiplies its arguments and returns the result.</span></p>
<p><span class=rvts7>&nbsp; &nbsp; Code = "8B442404F76C2408C3"</span></p>
<p><span class=rvts7>}</span></p>
<p><span class=rvts7>else {</span></p>
<p><span class=rvts7>&nbsp; &nbsp; Code = "4889C8 48F7EA C3" // mov rax,rcx; imul rdx; ret</span></p>
<p><span class=rvts7>}</span></p>
<p><span class=rvts7>CodeAddr = DWX.RegisterCode(Code, "Multiply", "i=ll", "r=l");</span></p>
<p><span class=rvts7><br></span></p>
<p><span class=rvts7>TakeCommand.tcommand("echo " + DWX.Multiply(5, 4));</span></p>
<p><span class=rvts7><br></span></p>
<p><span class=rvts6>Save this as test.js, and then run it from the command line;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts7>script test.js</span></p>
<p><span class=rvts7><br></span></p>
<p><span class=rvts6>which returns;</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts7>e:\utils&gt;script dyn3.js</span></p>
<p><span class=rvts7>20</span></p>
<p><span class=rvts7><br></span></p>
<p><span class=rvts6>Link to DynamicWrapperX (Version 2)</span></p>
<p><span class=rvts6>Ref: https://dynwrapx.script-coding.com/dwx/pages/dynwrapx.php?lang=en</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Link to DynamicWrapperX (Version 1)</span></p>
<p><span class=rvts6>Ref: https://www.script-coding.com/dynwrapx_eng.html</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Posting this here for my future reference, but thought others might also be interested.</span></p>
<p><span class=rvts6><br></span></p>
<p><span class=rvts6>Joe</span></p>
<p class=rvps2><span class=rvts6><br></span></p>
</body></html>
