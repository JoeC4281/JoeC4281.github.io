<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Use C# code from TCC</title>
<meta name="generator" content="WYSIWYG Web Builder 17 - https://www.wysiwygwebbuilder.com">
<link href="font-awesome.min.css" rel="stylesheet">
<link href="JoeC4281.css" rel="stylesheet">
<link href="Use-C--code-from-TCC.css" rel="stylesheet">
</head>
<body>
<div id="wb_Heading1" style="position:absolute;left:126px;top:43px;width:549px;height:48px;z-index:0;">
<h1 id="Heading1">Use C# code from TCC</h1></div>
<div id="wb_IconFont1" style="position:absolute;left:27px;top:22px;width:74px;height:69px;text-align:center;z-index:1;">
<a href="./How-Do-I....html"><div id="IconFont1"><i class="fa fa-arrow-left"></i></div></a></div>
<div id="wb_Text1" style="position:absolute;left:117px;top:118px;width:1111px;height:1184px;z-index:2;">
<span style="color:#000000;font-family:'Courier New';font-size:21px;">Here's how I access functions written in C# from TCC, using the new PSHELL and @PSHELL in TCC 21.<br><br>First, create a file with your C# code, in this example, TCCPS1.cs;<br><br>public class MathClass<br>{<br>&nbsp;&nbsp; public static long Multiply(long x, long y)<br>&nbsp;&nbsp; {<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return x * y;<br>&nbsp;&nbsp; }<br><br>&nbsp;&nbsp; public static long Add(long i, long j)<br>&nbsp;&nbsp; {<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return i + j;<br>&nbsp;&nbsp; }<br>}<br><br>Next, load this class into memory;<br><br>pshell /s &quot;add-type -path e:\utils\tccps1.cs&quot;<br><br>Use one of the functions from the class; <br><br>pshell /s &quot;[MathClass]::Add(652,4)&quot;<br><br>With the class loaded into memory, you can also use the @PSHELL function;<br><br>[c:\utils]set MathAdd=%@pshell[[MathClass]::Add(652,4)]<br><br>[c:\utils]echo %MathAdd<br>656<br><br>You can also use VB Code from TCC, in this example, TCCPS1.vb;<br><br>Public Class MathClass<br>&nbsp; Public Shared Function Multiply(ByVal x As Long, ByVal y As Long) As Long<br>&nbsp;&nbsp;&nbsp; Return x * y<br>&nbsp; End Function<br><br>&nbsp; Public Shared Function Add(ByVal i As Long, ByVal j As Long) As Long<br>&nbsp;&nbsp;&nbsp; Return i + j<br>&nbsp; End Function<br><br>End Class<br><br>Ref: <a href="https://jpsoft.com/forums/threads/use-c-code-from-tcc.8426/" title="Use C# code from TCC">https://jpsoft.com/forums/threads/use-c-code-from-tcc.8426/</a><br><br></span></div>
<div id="wb_Line1" style="position:absolute;left:112px;top:226px;width:1091px;height:2px;z-index:3;">
<img src="images/img0002.png" id="Line1" alt="" width="1091" height="0"></div>
<hr id="Line2" style="position:absolute;left:117px;top:537px;width:1110px;z-index:4;">
</body>
</html>