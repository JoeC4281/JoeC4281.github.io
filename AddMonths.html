<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>AddMonths</title>
<meta name="generator" content="WYSIWYG Web Builder 17 - https://www.wysiwygwebbuilder.com">
<link href="JoeC4281.css" rel="stylesheet">
<link href="AddMonths.css" rel="stylesheet">
</head>
<body>
<div id="wb_Text1" style="position:absolute;left:14px;top:10px;width:970px;height:1184px;z-index:0;">
<span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;">FUNCTION AddMonths<br>*-----------------------------------------------------------------------<br>*-- Programmer..: Jay Parsons (CIS: 72662,1302)<br>*-- Date........: 06/07/1993<br>*-- Notes.......: Finds same day as given date N months ahead.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; This function will return the first day of the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; following month if there is no equal date in the month<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; otherwise returned and nMonths is positive, or the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; last day of the month if nMonths is negative.&nbsp; That<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; is, a call with {01/31/91} (January 31, 1991) and 1<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; would yield March 1, there being no February 31.<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Do not use this function successively to find first<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the date one month ahead, then the date one month<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; beyond that.&nbsp; Instead, to find the date two months<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ahead from the original date, call this function with<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the original date and nMonths = 2.&nbsp; Otherwise, in the<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; example, you'll get April 1 the second time rather<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; than the correct March 31.<br>*-- Written for.: dBASE IV, 1.1<br>*-- Rev. History: 11/10/1991 -- Original Release<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 06/07/1993 -- Lee Hite (CIS: 71213,2475).&nbsp; added ROUND<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; function in new date computation to prevent decimals<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; being returned in the date value.&nbsp; This insures that<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dBase relational operators will work correctly with<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the result, i.e., AddMonths({1/1/91},1)={2/1/91} will<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; return true, whereas before it would not, even though<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; the calculated date appeared correct when evaluated<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; as a character string.<br>*-- Calls.......: None<br>*-- Called by...: Any<br>*-- Usage.......: AddMonths(&lt;dDate&gt;,&lt;nMonths&gt;)<br>*-- Example.....: ?AddMonths({01/01/91},1)<br>*-- Returns.....: Date<br>*-- Parameters..: dDate&nbsp;&nbsp; = Date being tested for ...<br>*--&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dMonths = Number of months &quot;ahead&quot;<br>*-----------------------------------------------------------------------<br><br>&nbsp;&nbsp; parameters dDate, nMonths<br>&nbsp;&nbsp; private dNew, dTest,dReturn<br><br>&nbsp;&nbsp; m-&gt;dNew = dDate - day( dDate )+ 15 ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; + round( 30.436875 * nMonths, 0 ) &amp;&amp;middle of month<br>&nbsp;&nbsp; m-&gt;dTest = m-&gt;dNew - day( m-&gt;dNew ) + day( dDate )<br>&nbsp;&nbsp; m-&gt;dReturn = iif( month( m-&gt;dTest ) = month( m-&gt;dNew ), ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m-&gt;dTest, m-&gt;dTest - day( m-&gt;dTest ) ;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; + iif( nMonths &gt; 0, 1, 0 ) )<br><br>RETURN dReturn<br>*-- EoF: AddMonths()</span></div>
</body>
</html>