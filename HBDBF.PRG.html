<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>HBDBF.PRG</title>
<meta name="generator" content="WYSIWYG Web Builder 17 - https://www.wysiwygwebbuilder.com">
<link href="JoeC4281.css" rel="stylesheet">
<link href="HBDBF.PRG.css" rel="stylesheet">
</head>
<body>
<div id="wb_Text1" style="position:absolute;left:175px;top:44px;width:1075px;height:2803px;z-index:0;">
<span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;">/*<br> * Harbour Project source code:<br> *&nbsp;&nbsp;&nbsp; demonstration/test code for OLE server which works like<br> *&nbsp;&nbsp;&nbsp; xHarbour.com OLE servers described at<br> *&nbsp;&nbsp;&nbsp; http://xharbour.com/index.asp?page=add_on_oleserver&amp;show_sub=7&amp;show_i=1<br> *<br> * Copyright 2010 Przemyslaw Czerpak &lt;druzus / at / priv.onet.pl&gt;<br> * www - http://harbour-project.org<br> *<br> */<br><br>#define CLS_Name&nbsp; &quot;hbdbf&quot;<br>#define CLS_ID&nbsp;&nbsp;&nbsp; &quot;{466AC7B2-35D7-4509-B909-C3C2F8FDBD3C}&quot;<br><br>PROCEDURE DllMain()<br><br>&nbsp;&nbsp; PUBLIC Property1<br><br>&nbsp;&nbsp; M-&gt;Property1 := &quot;MyProperty&quot;<br><br>&nbsp;&nbsp; /* Initialize OLE server ID and name.<br>&nbsp;&nbsp;&nbsp; * win_oleServerInit() should be executed from DllMain()<br>&nbsp;&nbsp;&nbsp; */<br>&nbsp;&nbsp; win_oleServerInit( CLS_ID, CLS_Name )<br><br>&nbsp;&nbsp; RETURN<br><br><br>FUNCTION MyMethod( ... )<br>&nbsp;&nbsp; RETURN &quot;Hello from MyOleServer [&quot; + hb_ValToExp( { ... } ) + &quot;]&quot;<br><br>FUNCTION PPP( PPK )<br>&nbsp;&nbsp; RETURN PPK * .454<br><br>FUNCTION hbFCount( theDBF )<br><br>&nbsp;&nbsp; USE &amp;theDBF<br><br>&nbsp;&nbsp; RETURN FCount()<br><br>FUNCTION hbDBFName( theDBF )<br>&nbsp;&nbsp; Return &amp;theDBF<br><br>FUNCTION hbFieldDec( theDBF, fldNumb )<br><br>&nbsp;&nbsp; USE &amp;theDBF<br><br>&nbsp;&nbsp; RETURN FieldDec( fldNumb )<br><br>FUNCTION hbFieldGet( theDBF, fldNumb )<br><br>&nbsp;&nbsp; USE &amp;theDBF<br><br>&nbsp;&nbsp; RETURN FieldGet( fldNumb )<br><br>FUNCTION hbFieldLen( theDBF, fldNumb )<br><br>&nbsp;&nbsp; USE &amp;theDBF<br><br>&nbsp;&nbsp; RETURN FieldLen( fldNumb )<br><br>FUNCTION hbFieldName ( theDBF, fldNumb )<br><br>&nbsp;&nbsp; USE &amp;theDBF<br><br>&nbsp;&nbsp; RETURN PadR( FieldName( fldNumb ), 10 )<br><br>FUNCTION hbFieldNum ( theDBF, fldName )<br><br>&nbsp;&nbsp; USE &amp;theDBF<br><br>&nbsp;&nbsp; RETURN FieldPos( fldName )<br><br>FUNCTION hbFieldType ( theDBF, fldNumb )<br><br>&nbsp;&nbsp; USE &amp;theDBF<br><br>&nbsp;&nbsp; RETURN FieldType( fldNumb )<br><br>FUNCTION hbRecCount( theDBF )<br><br>&nbsp;&nbsp; USE &amp;theDBF<br><br>&nbsp;&nbsp; RETURN RecCount()<br><br>FUNCTION HBRecord( theDBF, recNumb )<br><br>&nbsp;&nbsp; LOCAL theRecord, theField<br><br>&nbsp;&nbsp; USE &amp;theDBF<br>&nbsp;&nbsp; GOTO recNumb<br>&nbsp;&nbsp; theRecord := &quot;&quot;<br>&nbsp;&nbsp; FOR theField := 1 TO FCount()<br>&nbsp;&nbsp; &nbsp;&nbsp; SWITCH ValType( FieldGet( theField ) )<br>&nbsp;&nbsp; &nbsp;&nbsp; CASE &quot;D&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; theRecord := theRecord + DToS( FieldGet( theField ) )<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; EXIT<br>&nbsp;&nbsp; &nbsp;&nbsp; CASE &quot;C&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; theRecord := theRecord + FieldGet( theField )<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; EXIT<br>&nbsp;&nbsp; &nbsp;&nbsp; CASE &quot;N&quot;<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; theRecord := theRecord + Str( FieldGet( theField ) )<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; EXIT<br>&nbsp;&nbsp; &nbsp;&nbsp; END<br>&nbsp;&nbsp; NEXT<br><br>&nbsp;&nbsp; RETURN theRecord<br><br>FUNCTION hbLUPDATE( theDBF )<br><br>&nbsp;&nbsp; USE &amp;theDBF<br><br>&nbsp;&nbsp; RETURN DToS( LUpdate() )<br><br>ANNOUNCE GT_SYS<br>REQUEST HB_GT_GUI_DEFAULT</span></div>
<div id="wb_IconFont1" style="position:absolute;left:29px;top:46px;width:106px;height:67px;text-align:center;z-index:1;">
<a href="./HBDBF.html"><div id="IconFont1"><i class="IconFont1"></i></div></a></div>
</body>
</html>