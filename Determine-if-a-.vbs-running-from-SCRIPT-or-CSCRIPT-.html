<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Is .vbs running from SCRIPT or CSCRIPT?</title>
<meta name="generator" content="WYSIWYG Web Builder 17 - https://www.wysiwygwebbuilder.com">
<link href="font-awesome.min.css" rel="stylesheet">
<link href="JoeC4281.css" rel="stylesheet">
<link href="Determine-if-a-.vbs-running-from-SCRIPT-or-CSCRIPT-.css" rel="stylesheet">
</head>
<body>
<div id="wb_Heading1" style="position:absolute;left:104px;top:8px;width:1070px;height:48px;z-index:0;">
<h1 id="Heading1">Determine if a .vbs is running from SCRIPT or CSCRIPT?</h1></div>
<div id="wb_IconFont1" style="position:absolute;left:7px;top:8px;width:74px;height:69px;text-align:center;z-index:1;">
<a href="./How-Do-I....html"><div id="IconFont1"><i class="fa fa-arrow-left"></i></div></a></div>
<div id="wb_Text1" style="position:absolute;left:104px;top:95px;width:988px;height:1063px;z-index:2;">
<span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"><strong><u>Method 1:</u></strong><br><br>' VbsEdit Toolkit is part of <a href="http:\\www.vbsedit.com" target="_blank">VBSEdit</a>.<br><br></span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">Set</span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"> tk = CreateObject( &quot;VbsEdit.Toolkit&quot; )<br><br>PID = tk.CurrentProcessID<br>PIDModule = tk.ModuleFilenameFromProcessId(PID)<br><br></span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">if</span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"> right(PIDModule,7) = &quot;tcc.exe&quot; </span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">then</span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"><br>&nbsp; </span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">with</span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"> TakeCommand<br>&nbsp;&nbsp;&nbsp; .tcommand(&quot;echo The .vbs is running from SCRIPT in tcc.exe&quot;)<br>&nbsp; </span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">end With</span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"><br></span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">else</span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"><br>&nbsp; </span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">with </span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;">WScript<br>&nbsp;&nbsp;&nbsp; .StdOut.WriteLine &quot;The .vbs is running from CSCRIPT.EXE&quot;<br>&nbsp; </span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">end With</span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"><br>end if<br><br></span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">Set</span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"> tk = </span><span style="background-color:#FFFFFF;color:#1E90FF;font-family:'Courier New';font-size:21px;">Nothing</span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;"><br><br><strong><u>Method 2:</u></strong><br><br>on error resume next<br>script&nbsp; = &quot;N&quot;<br>ws = WScript.FullName<br>if err.number = 424 then 'Object Required<br>&nbsp; script = &quot;Y&quot;<br>&nbsp; err.clear<br>end if<br>On</span><span style="background-color:#FFFFFF;color:#000000;font-family:Arial;font-size:21px;"> </span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;">Error</span><span style="background-color:#FFFFFF;color:#000000;font-family:Arial;font-size:21px;"> </span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;">GoTo</span><span style="background-color:#FFFFFF;color:#000000;font-family:Arial;font-size:21px;"> </span><span style="background-color:#FFFFFF;color:#000000;font-family:'Courier New';font-size:21px;">0<br><br>StdOut ws<br><br>Sub StdOut (argv)<br>&nbsp; If script = &quot;Y&quot; then<br>&nbsp;&nbsp;&nbsp; TakeCommand.tcommand(&quot;echo &quot; + argv)<br>&nbsp; Else<br>&nbsp;&nbsp;&nbsp; WScript.StdOut.WriteLine argv<br>&nbsp; End if<br>End Sub<br><br><br></span></div>
</body>
</html>